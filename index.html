<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="theme-color" content="#059669" />
    <link rel="icon" href="logo-1.png" type="image/x-icon" />
    <title>Smart Growa</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="manifest" href="manifest.json" />
    <link rel="apple-touch-icon" href="logo-1.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="#059669" />
    <meta name="apple-mobile-web-app-title" content="SmartGrowa" />

    <style>
      /* --- LOGIN SCREEN STYLE --- */
      #loginScreen {
        position: fixed;
        inset: 0;
        background: var(--bg-body);
        z-index: 9999;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 20px;
      }
      #userInfo {
        display: none;
        align-items: center;
        gap: 10px;
        margin-right: 15px;
      }
      #userPhoto {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        border: 2px solid var(--primary);
      }
      /* --- STYLE ASLI --- */
      :root {
        --primary: #059669;
        --primary-light: #d1fae5;
        --bg-body: #f8fafc;
        --bg-surface: #ffffff;
        --bg-card: #ffffff;
        --text-main: #0f172a;
        --text-muted: #64748b;
        --border: #e2e8f0;
        --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);
        --radius-md: 12px;
        --radius-lg: 16px;
        --danger: #ef4444;
        --danger-bg: #fef2f2;
        --danger-border: #fca5a5;
        --money-in: #10b981;
        --money-out: #f43f5e;
      }

      [data-theme="dark"] {
        --primary: #10b981;
        --primary-light: #064e3b;
        --bg-body: #0f172a;
        --bg-surface: #1e293b;
        --bg-card: #1e293b;
        --text-main: #f1f5f9;
        --text-muted: #94a3b8;
        --border: #334155;
        --shadow-sm: none;
        --shadow-md: none;
        --danger: #f87171;
        --danger-bg: #450a0a;
        --danger-border: #7f1d1d;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Plus Jakarta Sans", sans-serif;
        -webkit-tap-highlight-color: transparent;
      }

      body {
        background-color: var(--bg-body);
        color: var(--text-main);
        display: flex;
        height: 100vh;
        overflow: hidden;
        transition: background 0.3s;
      }

      .sidebar {
        width: 260px;
        background: var(--bg-surface);
        border-right: 1px solid var(--border);
        display: flex;
        flex-direction: column;
        padding: 1.5rem;
        z-index: 50;
        transition: 0.3s;
      }
      .brand {
        font-size: 1.4rem;
        font-weight: 800;
        color: var(--primary);
        margin-bottom: 2.5rem;
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .nav-link {
        padding: 0.9rem 1rem;
        margin-bottom: 0.5rem;
        border-radius: var(--radius-md);
        color: var(--text-muted);
        cursor: pointer;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 12px;
        font-weight: 600;
        font-size: 0.95rem;
      }
      .nav-link:hover {
        background: var(--bg-body);
        color: var(--primary);
      }
      .nav-link.active {
        background: var(--primary-light);
        color: var(--primary);
      }

      .main-content {
        flex: 1;
        overflow-y: auto;
        padding: 2rem;
        position: relative;
        scroll-behavior: smooth;
      }

      .header-row {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 2rem;
      }
      .header-title h1 {
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 5px;
      }
      .header-title p {
        color: var(--text-muted);
        font-size: 0.9rem;
      }

      .digital-clock {
        font-size: 2.5rem;
        font-weight: 800;
        color: var(--text-main);
        letter-spacing: -1px;
        line-height: 1;
      }
      .date-display {
        font-size: 0.9rem;
        color: var(--text-muted);
        font-weight: 500;
        margin-top: 5px;
      }

      .theme-toggle {
        background: var(--bg-surface);
        border: 1px solid var(--border);
        color: var(--text-muted);
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: grid;
        place-items: center;
        cursor: pointer;
        transition: 0.3s;
        margin-left: 10px;
      }
      .theme-toggle:hover {
        color: var(--text-main);
        border-color: var(--text-muted);
      }

      .weather-banner {
        background: linear-gradient(135deg, #059669 0%, #10b981 100%);
        border-radius: var(--radius-lg);
        padding: 1.5rem 2rem;
        color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        box-shadow: 0 10px 25px -5px rgba(16, 185, 129, 0.4);
        position: relative;
        overflow: hidden;
      }
      .weather-banner::before {
        content: "";
        position: absolute;
        right: -20px;
        top: -50px;
        width: 150px;
        height: 150px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
      }
      .weather-info h2 {
        font-size: 2rem;
        font-weight: 800;
      }
      .weather-info p {
        opacity: 0.9;
        margin-top: 5px;
        font-weight: 500;
      }
      .weather-icon {
        font-size: 3rem;
        opacity: 0.9;
      }

      .rain-delay-btn {
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.4);
        color: white;
        padding: 8px 16px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 0.85rem;
        margin-top: 10px;
        display: none;
        align-items: center;
        gap: 8px;
        transition: 0.3s;
      }
      .rain-delay-btn:hover {
        background: rgba(255, 255, 255, 0.3);
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .card {
        background: var(--bg-card);
        padding: 1.5rem;
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--border);
        transition: 0.3s;
      }
      .stat-card {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 100%;
      }
      .stat-card:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-md);
        border-color: var(--primary);
      }

      /* --- GROWTH TIMELINE --- */
      .growth-timeline-container {
        margin-bottom: 2rem;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 12px;
        padding: 15px;
        border: 1px solid var(--border);
      }
      .growth-timeline {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        position: relative;
        margin-top: 10px;
      }
      .growth-step {
        position: relative;
        flex: 1;
        text-align: center;
        z-index: 1;
      }
      .growth-step:not(:last-child)::after {
        content: "";
        position: absolute;
        top: 16px;
        left: 50%;
        width: 100%;
        height: 3px;
        background: #e2e8f0;
        z-index: -1;
      }
      .growth-step.completed:not(:last-child)::after {
        background: var(--primary);
      }
      .step-icon {
        width: 36px;
        height: 36px;
        background: var(--bg-surface);
        border: 2px solid #e2e8f0;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 8px;
        color: var(--text-muted);
        transition: 0.3s;
        font-size: 0.9rem;
      }
      .growth-step.active .step-icon {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
        box-shadow: 0 0 0 4px var(--primary-light);
      }
      .growth-step.completed .step-icon {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
      }
      .step-label {
        font-size: 0.75rem;
        font-weight: 700;
        color: var(--text-muted);
        line-height: 1.2;
        margin-bottom: 2px;
      }
      .growth-step.active .step-label {
        color: var(--primary);
      }
      .step-days {
        font-size: 0.7rem;
        color: var(--text-muted);
        opacity: 0.8;
      }

      .stat-head {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
      }
      .stat-icon {
        width: 40px;
        height: 40px;
        border-radius: 10px;
        display: grid;
        place-items: center;
        font-size: 1.2rem;
      }
      .stat-value {
        font-size: 2rem;
        font-weight: 800;
        color: var(--text-main);
      }
      .stat-label {
        color: var(--text-muted);
        font-size: 0.85rem;
        font-weight: 600;
      }

      .action-bar {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
      }
      .search-wrapper {
        position: relative;
        flex: 1;
        min-width: 250px;
      }
      .search-icon {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-muted);
      }
      .search-input {
        width: 100%;
        padding: 0.8rem 1rem 0.8rem 2.8rem;
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        outline: none;
        background: var(--bg-surface);
        color: var(--text-main);
        transition: 0.3s;
        box-sizing: border-box;
      }
      .search-input:focus {
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      #sortSelect {
        padding-left: 1rem;
        min-width: 180px;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Cpath d='M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 1rem center;
        background-size: 1em;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
      }

      .btn {
        padding: 0.8rem 1.5rem;
        border: none;
        border-radius: var(--radius-md);
        font-weight: 600;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: 0.2s;
        font-size: 0.9rem;
        justify-content: center;
      }
      .btn-primary {
        background: var(--primary);
        color: white;
      }
      .btn-primary:hover {
        background: #047857;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }
      .btn-secondary {
        background: var(--bg-surface);
        border: 1px solid var(--border);
        color: var(--text-main);
      }
      .btn-secondary:hover {
        background: var(--bg-body);
        border-color: #cbd5e1;
      }
      .btn-danger {
        background: #fee2e2;
        color: #dc2626;
      }
      .btn-danger:hover {
        background: #fecaca;
      }
      .btn-sm {
        padding: 0.4rem 0.8rem;
        font-size: 0.8rem;
      }

      .plant-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
        gap: 1.5rem;
      }

      .plant-card {
        background: var(--bg-card);
        border-radius: var(--radius-lg);
        overflow: hidden;
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--border);
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        position: relative;
      }
      .plant-card:hover {
        transform: translateY(-6px);
        box-shadow: var(--shadow-lg);
      }

      .plant-card.is-sick {
        border: 2px solid var(--danger);
        background-color: var(--danger-bg);
      }
      .plant-card.is-sick .status-pill {
        background: white;
        border-color: var(--danger-border);
        color: var(--danger);
      }

      .plant-img-wrapper {
        height: 180px;
        position: relative;
        overflow: hidden;
        background: #e2e8f0;
      }
      .plant-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: 0.5s;
      }
      .plant-card:hover .plant-img {
        transform: scale(1.08);
      }

      .card-body {
        padding: 1.25rem;
      }
      .badge {
        font-size: 0.7rem;
        padding: 4px 10px;
        border-radius: 20px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        display: inline-block;
        margin-bottom: 8px;
      }

      .status-pill {
        margin-top: 12px;
        padding: 8px 12px;
        border-radius: 8px;
        font-size: 0.8rem;
        font-weight: 600;
        background: var(--bg-body);
        color: var(--text-muted);
        border: 1px solid var(--border);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
      }
      .status-pill.urgent {
        background: #fef2f2;
        color: #dc2626;
        border-color: #fecaca;
        animation: pulse 2s infinite;
      }
      .status-pill.today {
        background: #eff6ff;
        color: #3b82f6;
        border-color: #bfdbfe;
      }

      .health-badge {
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 10;
        padding: 4px 10px;
        border-radius: 12px;
        font-weight: 700;
        font-size: 0.75rem;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }
      .health-badge.sick {
        background: var(--danger);
        color: white;
      }

      .alert-banner {
        background: var(--danger-bg);
        border: 1px solid var(--danger-border);
        color: var(--danger);
        padding: 1rem;
        border-radius: var(--radius-md);
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        animation: fadeIn 0.5s;
      }

      .finance-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        border-bottom: 1px solid var(--border);
        transition: 0.2s;
        border-radius: 8px;
        margin-bottom: 5px;
      }
      .finance-row:last-child {
        border-bottom: none;
        margin-bottom: 0;
      }
      .finance-row:hover {
        background-color: var(--bg-body);
        transform: translateX(5px);
      }
      .finance-actions {
        opacity: 0;
        transition: 0.2s;
        display: flex;
        gap: 8px;
      }
      .finance-row:hover .finance-actions {
        opacity: 1;
      }
      .amount-in {
        color: var(--money-in);
        font-weight: 700;
      }
      .amount-out {
        color: var(--money-out);
        font-weight: 700;
      }

      .chart-container-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(4px);
        z-index: 100;
        display: none;
        place-items: center;
        opacity: 0;
        transition: 0.3s;
      }
      .modal-overlay.active {
        display: grid;
        opacity: 1;
      }

      .modal-box {
        background: var(--bg-card);
        width: 90%;
        max-width: 550px;
        max-height: 90vh;
        border-radius: var(--radius-lg);
        overflow-y: auto;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        transform: scale(0.9);
        transition: 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        border: 1px solid var(--border);
      }
      .modal-overlay.active .modal-box {
        transform: scale(1);
      }

      .form-group {
        margin-bottom: 1.2rem;
      }
      .form-label {
        display: block;
        font-weight: 600;
        margin-bottom: 0.5rem;
        font-size: 0.9rem;
        color: var(--text-main);
      }
      .smart-suggestion {
        font-size: 0.8rem;
        color: var(--primary);
        margin-top: 4px;
        display: none;
        align-items: center;
        gap: 5px;
        cursor: pointer;
      }

      .day-selector-container {
        display: flex;
        gap: 8px;
        justify-content: space-between;
        margin-bottom: 8px;
      }
      .day-check {
        flex: 1;
        height: 40px;
        border: 1px solid var(--border);
        border-radius: 8px;
        display: grid;
        place-items: center;
        cursor: pointer;
        font-size: 0.8rem;
        font-weight: 700;
        color: var(--text-muted);
        background: var(--bg-body);
        transition: 0.2s;
        user-select: none;
      }
      .day-check.active {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
      }
      .day-check.fert-active {
        background: #f59e0b;
        color: white;
        border-color: #f59e0b;
      }
      .day-check:hover:not(.active):not(.fert-active) {
        border-color: var(--primary);
        color: var(--primary);
      }

      .img-preview-container {
        width: 100%;
        height: 150px;
        background: #f1f5f9;
        border-radius: 8px;
        margin-top: 10px;
        display: none;
        overflow: hidden;
        border: 1px solid var(--border);
      }
      .img-preview-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .sensor-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 15px;
      }
      .sensor-input-group {
        position: relative;
      }
      .sensor-unit {
        position: absolute;
        right: 12px;
        top: 38px;
        font-size: 0.8rem;
        color: var(--text-muted);
        pointer-events: none;
      }
      .analysis-result-card {
        padding: 1.5rem;
        border-radius: var(--radius-md);
        margin-top: 1.5rem;
        display: none;
        border: 1px solid transparent;
        animation: fadeIn 0.4s;
      }
      .analysis-optimal {
        background: #ecfdf5;
        border-color: #a7f3d0;
        color: #065f46;
      }
      .analysis-warning {
        background: #fffbeb;
        border-color: #fcd34d;
        color: #92400e;
      }
      .analysis-critical {
        background: #fef2f2;
        border-color: #fca5a5;
        color: #991b1b;
      }

      .health-parameter-row {
        display: flex;
        justify-content: space-between;
        padding: 6px 0;
        border-bottom: 1px dashed rgba(0, 0, 0, 0.1);
        font-size: 0.9rem;
      }
      .param-status {
        font-weight: 700;
        font-size: 0.8rem;
        text-transform: uppercase;
      }
      .status-ok {
        color: var(--primary);
      }
      .status-bad {
        color: var(--danger);
      }

      /* --- FOOTER STYLE --- */
      .app-footer {
        margin-top: 4rem;
        padding-top: 2rem;
        border-top: 1px solid var(--border);
        color: var(--text-muted);
        font-size: 0.9rem;
        width: 100%;
      }

      .footer-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 1.5rem;
        text-align: center;
      }

      .footer-brand {
        font-weight: 700;
        color: var(--text-main);
        display: flex;
        align-items: center;
        gap: 8px;
        opacity: 0.8;
      }

      .footer-links {
        display: flex;
        gap: 1.5rem;
        font-size: 0.85rem;
      }

      .footer-links a {
        color: var(--text-muted);
        text-decoration: none;
        transition: color 0.2s;
        font-weight: 500;
      }

      .footer-links a:hover {
        color: var(--primary);
      }

      .footer-copyright {
        font-size: 0.8rem;
        opacity: 0.6;
      }

      /* Desktop specific adjustment for footer */
      @media (min-width: 769px) {
        .footer-content {
          flex-direction: row;
          justify-content: space-between;
          text-align: left;
        }
      }

      @media (max-width: 768px) {
        body {
          flex-direction: column;
        }
        .sidebar {
          width: 100%;
          height: auto;
          flex-direction: row;
          justify-content: space-around;
          padding: 12px;
          border-top: 1px solid var(--border);
          border-right: none;
          position: fixed;
          bottom: 0;
          order: 2;
          background: var(--bg-surface);
          box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.03);
        }
        .brand {
          display: none;
        }
        .nav-link {
          flex-direction: column;
          gap: 4px;
          font-size: 0.7rem;
          padding: 0.5rem;
          margin: 0;
          border-radius: 8px;
        }
        .nav-link i {
          font-size: 1.2rem;
        }
        .main-content {
          order: 1;
          padding: 1.5rem;
          padding-bottom: 100px;
        }
        .header-title h1 {
          font-size: 1.5rem;
        }
        .weather-banner {
          flex-direction: column;
          text-align: center;
          gap: 1rem;
        }
        .weather-banner::before {
          display: none;
        }
        .header-row {
          flex-direction: column;
          gap: 1rem;
        }
        .digital-clock {
          font-size: 2rem;
        }
      }

      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
        100% {
          opacity: 1;
        }
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .toast {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%) translateY(-100px);
        background: #1e293b;
        color: white;
        padding: 12px 24px;
        border-radius: 50px;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        z-index: 2000;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }
      .toast.show {
        transform: translateX(-50%) translateY(0);
      }

      /* --- TAMBAHAN STYLE UNTUK HIDROPONIK --- */
      .method-switch {
        display: flex;
        background: var(--bg-body);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 4px;
        margin-bottom: 1.2rem;
      }
      .method-opt {
        flex: 1;
        padding: 8px;
        text-align: center;
        cursor: pointer;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.9rem;
        transition: 0.3s;
        color: var(--text-muted);
      }
      .method-opt.active {
        background: white;
        color: var(--primary);
        box-shadow: var(--shadow-sm);
      }
      .method-opt.active-hydro {
        background: #0ea5e9;
        color: white;
      }

      .badge.hydro {
        background: #e0f2fe;
        color: #0284c7;
        border: 1px solid #bae6fd;
      }
      .hydro-section {
        display: none;
        animation: fadeIn 0.3s;
      }

      /* Indikator Flush/Kuras */
      .day-check.flush-active {
        background: #0ea5e9;
        color: white;
        border-color: #0ea5e9;
      }
      .day-check:hover:not(.active):not(.fert-active):not(.flush-active) {
        border-color: var(--primary);
        color: var(--primary);
      }
      @media print {
        body * {
          visibility: hidden;
        }
        #printableArea,
        #printableArea * {
          visibility: visible;
        }
        #qrModal .btn {
          display: none !important;
        }
      }
    </style>
  </head>
  <body>
    <div id="loginScreen">
      <img
        src="logo-2.png"
        alt="SmartGrowa"
        style="height: 20rem; margin-bottom: 1rem"
      />
      <p style="color: var(--text-muted); margin-bottom: 2rem">
        Masuk untuk mengakses kebun virtual Anda.
      </p>

      <button class="btn btn-primary" onclick="app.loginGoogle()">
        <i class="fa-brands fa-google"></i> Masuk dengan Google
      </button>
    </div>
    <nav class="sidebar">
      <div class="brand">
        <img
          src="logo-1.png"
          alt="SmartGrowa"
          style="height: 2.2em; vertical-align: middle; margin-right: 0.4em"
        />
        SmartGrowa
      </div>
      <div class="nav-link active" onclick="app.switchTab('dashboard')">
        <i class="fa-solid fa-chart-pie"></i> <span>Beranda</span>
      </div>
      <div class="nav-link" onclick="app.switchTab('garden')">
        <i class="fa-solid fa-seedling"></i> <span>Tanaman</span>
      </div>
      <div class="nav-link" onclick="app.switchTab('calculator')">
        <i class="fa-solid fa-calculator"></i> <span>Kalkulator</span>
      </div>
      <div class="nav-link" onclick="app.switchTab('finance')">
        <i class="fa-solid fa-wallet"></i> <span>Keuangan</span>
      </div>
      <div class="nav-link" onclick="app.switchTab('settings')">
        <i class="fa-solid fa-sliders"></i> <span>Pengaturan</span>
      </div>
    </nav>

    <main class="main-content">
      <section id="dashboard" class="view-section">
        <div class="header-row">
          <div class="header-title">
            <h1 id="greeting">Selamat Pagi</h1>
            <div id="userInfo" style="margin-top: 5px">
              <img id="userPhoto" src="" alt="" />
              <span id="userName" style="font-size: 0.9rem; font-weight: 600"
                >User</span
              >
              <button
                class="btn btn-sm btn-danger"
                onclick="app.logout()"
                style="margin-left: 10px; padding: 4px 8px"
              >
                <i class="fa-solid fa-right-from-bracket"></i>
              </button>
            </div>
          </div>

          <div style="text-align: right">
            <div id="clockDisplay" class="digital-clock">00:00:00</div>
            <div
              id="dateDisplay"
              style="
                font-size: 0.9rem;
                color: var(--text-muted);
                margin-top: 4px;
              "
            >
              -- / -- / ----
            </div>
          </div>
        </div>

        <div id="sickAlertContainer"></div>

        <div class="weather-banner">
          <div class="weather-info">
            <h2 id="weatherTemp">--°C</h2>
            <p id="weatherDesc">Memuat Cuaca...</p>
            <div
              style="
                margin-top: 10px;
                font-size: 0.9rem;
                background: rgba(255, 255, 255, 0.2);
                padding: 5px 12px;
                border-radius: 20px;
                display: inline-block;
              "
            >
              <i class="fa-solid fa-droplet"></i> Tips: Cuaca panas, cek
              kelembaban tanah.
            </div>
            <button
              id="rainDelayBtn"
              class="rain-delay-btn"
              onclick="app.applyRainDelay()"
            >
              <i class="fa-solid fa-clock"></i> Lewati Jadwal Hari Ini (Hujan)
            </button>
          </div>
          <div class="weather-icon">
            <i class="fa-solid fa-cloud"></i>
          </div>
        </div>

        <div class="stats-grid">
          <div class="card stat-card">
            <div class="stat-head">
              <span class="stat-label">TOTAL TANAMAN</span>
              <div
                class="stat-icon"
                style="background: #ecfdf5; color: #10b981"
              >
                <i class="fa-solid fa-tree"></i>
              </div>
            </div>
            <div class="stat-value" id="totalCount">0</div>
          </div>
          <div class="card stat-card">
            <div class="stat-head">
              <span class="stat-label">SIRAM HARI INI</span>
              <div
                class="stat-icon"
                style="background: #eff6ff; color: #3b82f6"
              >
                <i class="fa-solid fa-droplet"></i>
              </div>
            </div>
            <div class="stat-value" id="waterCount">0</div>
            <button
              id="bulkWaterBtn"
              class="btn btn-primary btn-sm"
              style="margin-top: 5px; display: none"
              onclick="app.waterAllDue()"
            >
              <i class="fa-solid fa-check-double"></i> Siram Semua (Cepat)
            </button>
          </div>
          <div class="card stat-card">
            <div class="stat-head">
              <span class="stat-label">SKOR PERAWATAN</span>
              <div
                class="stat-icon"
                style="background: #fdf4ff; color: #d946ef"
              >
                <i class="fa-solid fa-heart-pulse"></i>
              </div>
            </div>
            <div class="stat-value" id="careScore">0%</div>
            <small style="color: var(--text-muted); font-size: 0.75rem"
              >Keberhasilan Rutinitas</small
            >
          </div>
          <div class="card stat-card">
            <div class="stat-head">
              <span class="stat-label">SALDO KEBUN</span>
              <div
                class="stat-icon"
                style="background: #ecfdf5; color: #059669"
              >
                <i class="fa-solid fa-money-bill-wave"></i>
              </div>
            </div>
            <div class="stat-value" id="dashBalance" style="font-size: 1.5rem">
              Rp 0
            </div>
          </div>
        </div>

        <div class="chart-container-row">
          <div class="card">
            <h3 style="margin-bottom: 1.5rem">Sebaran Ekosistem</h3>
            <div style="height: 250px">
              <canvas id="plantChart"></canvas>
            </div>
          </div>
          <div class="card">
            <h3 style="margin-bottom: 1.5rem">Keuangan: Masuk vs Keluar</h3>
            <div style="height: 250px">
              <canvas id="financeChart"></canvas>
            </div>
          </div>
        </div>

        <div class="card">
          <h3 style="margin-bottom: 1rem">Aktivitas Jurnal (Pertumbuhan)</h3>
          <div style="height: 200px">
            <canvas id="growthChart"></canvas>
          </div>
        </div>
      </section>

      <section id="finance" class="view-section" style="display: none">
        <div class="header-row">
          <div class="header-title">
            <h1>Manajemen Keuangan</h1>
            <p>Catat pengeluaran (pupuk, bibit) dan pemasukan (panen).</p>
          </div>
        </div>

        <div class="stats-grid">
          <div class="card stat-card">
            <span class="stat-label">PEMASUKAN</span>
            <div
              class="stat-value"
              id="totalIncome"
              style="color: var(--money-in)"
            >
              Rp 0
            </div>
          </div>
          <div class="card stat-card">
            <span class="stat-label">PENGELUARAN</span>
            <div
              class="stat-value"
              id="totalExpense"
              style="color: var(--money-out)"
            >
              Rp 0
            </div>
          </div>
          <div class="card stat-card">
            <span class="stat-label">SALDO AKHIR</span>
            <div class="stat-value" id="netBalance">Rp 0</div>
          </div>
        </div>

        <div class="card" style="margin-bottom: 2rem">
          <h3 style="margin-bottom: 1.5rem">Analisis Hasil Panen (Kg)</h3>
          <div style="height: 250px">
            <canvas id="harvestChart"></canvas>
          </div>
        </div>

        <div class="card">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 1.5rem;
            "
          >
            <h3>Riwayat Transaksi</h3>
            <button
              class="btn btn-primary btn-sm"
              onclick="app.openFinanceModal()"
            >
              <i class="fa-solid fa-plus"></i> Catat Transaksi
            </button>
          </div>
          <div id="transactionList" style="max-height: 400px; overflow-y: auto">
            <div
              style="
                text-align: center;
                padding: 2rem;
                color: var(--text-muted);
              "
            >
              Belum ada transaksi.
            </div>
          </div>
        </div>
      </section>

      <section id="garden" class="view-section" style="display: none">
        <div class="header-row">
          <div class="header-title">
            <h1>Koleksi Tanaman</h1>
            <p>Kelola jadwal perawatan berbasis hari mingguan.</p>
          </div>
        </div>

        <div class="action-bar">
          <div class="search-wrapper">
            <i class="fa-solid fa-magnifying-glass search-icon"></i>
            <input
              type="text"
              class="search-input"
              placeholder="Cari tanaman..."
              id="plantSearch"
              onkeyup="app.renderGrid()"
            />
          </div>
          <select
            class="search-input"
            style="width: auto; flex: 0 0 auto"
            id="sortSelect"
            onchange="app.renderGrid()"
          >
            <option value="urgency">Urutkan: Jadwal Terdekat</option>
            <option value="az">Urutkan: A-Z</option>
            <option value="newest">Urutkan: Terbaru</option>
          </select>

          <button class="btn btn-primary" onclick="app.openFormModal()">
            <i class="fa-solid fa-plus"></i> <span>Tambah Baru</span>
          </button>
        </div>

        <div class="plant-grid" id="plantGrid"></div>
      </section>

      <section id="calculator" class="view-section" style="display: none">
        <div class="header-row">
          <div class="header-title">
            <h1>Kalkulator Nutrisi</h1>
            <p>Hitung dosis AB Mix presisi berdasarkan kalibrasi PPM.</p>
            <ol
              style="
                margin-top: 0.75rem;
                padding-left: 1.2rem;
                font-size: 0.9rem;
                color: var(--text-muted);
                line-height: 1.5;
              "
            >
              <li>
                <strong>Langkah A (Sekali saja / ganti merek):</strong>
                <ul style="margin: 0.25rem 0 0.5rem 1rem; list-style: disc">
                  <li>
                    Siapkan 1 L air bersih, tambahkan 5 ml Nutrisi A & B, lalu
                    ukur PPM-nya.
                  </li>
                  <li>
                    Masukkan hasil ke <em>Bagian 01 Kalibrasi</em> lalu klik
                    “Simpan Data Kalibrasi”.
                  </li>
                </ul>
              </li>
              <li>
                <strong>Langkah B (Rutin):</strong>
                <ul style="margin: 0.25rem 0 0 1rem; list-style: disc">
                  <li>
                    Cek PPM tandon → buka <em>Bagian 02 Hitung Takaran</em>.
                  </li>
                  <li>
                    Isi volume tandon, PPM saat ini & target, lalu klik “Hitung
                    Sekarang”.
                  </li>
                  <li>Tuang dosis yang tertera langsung ke tandon utama.</li>
                </ul>
              </li>
            </ol>
          </div>
        </div>

        <div
          class="grid-layout"
          style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
          "
        >
          <div class="card">
            <h3
              style="
                margin-bottom: 1rem;
                color: var(--primary);
                display: flex;
                align-items: center;
                gap: 10px;
              "
            >
              <span>01</span> Kalibrasi Kepekatan
            </h3>
            <p
              style="
                color: var(--text-muted);
                font-size: 0.9rem;
                margin-bottom: 1.5rem;
              "
            >
              Lakukan ini sekali saja untuk setiap merek nutrisi baru. Siapkan 1
              Liter air baku.
            </p>

            <div class="form-group">
              <label class="form-label">Volume Air Uji (Liter)</label>
              <input
                type="number"
                id="cal_vol_air"
                class="search-input"
                placeholder="Contoh: 1"
                step="0.1"
              />
            </div>
            <div class="form-group">
              <label class="form-label">Dosis Pekatan (ml)</label>
              <input
                type="number"
                id="cal_dosis"
                class="search-input"
                placeholder="Contoh: 5"
              />
            </div>
            <div class="form-group">
              <label class="form-label">PPM Air Baku (Awal)</label>
              <input
                type="number"
                id="cal_ppm_awal"
                class="search-input"
                placeholder="0"
              />
            </div>
            <div class="form-group">
              <label class="form-label">PPM Hasil Campuran (Akhir)</label>
              <input
                type="number"
                id="cal_ppm_akhir"
                class="search-input"
                placeholder="0"
              />
            </div>

            <button
              class="btn btn-primary"
              style="width: 100%; margin-top: 10px"
              onclick="app.runCalibration()"
            >
              Simpan Data Kalibrasi
            </button>

            <div
              id="calibrationStatus"
              class="status-pill error"
              style="margin-top: 15px; width: fit-content"
            >
              ⚠️ Belum Kalibrasi
            </div>
          </div>

          <div class="card">
            <h3
              style="
                margin-bottom: 1rem;
                color: var(--primary);
                display: flex;
                align-items: center;
                gap: 10px;
              "
            >
              <span>02</span> Hitung Takaran Tandon
            </h3>
            <p
              style="
                color: var(--text-muted);
                font-size: 0.9rem;
                margin-bottom: 1.5rem;
              "
            >
              Hitung berapa ml nutrisi yang dibutuhkan untuk tandon utama.
            </p>

            <div class="form-group">
              <label class="form-label">Volume Total Tandon (Liter)</label>
              <input
                type="number"
                id="main_vol_tandon"
                class="search-input"
                placeholder="Contoh: 100"
              />
            </div>
            <div
              style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px"
            >
              <div class="form-group">
                <label class="form-label">PPM Saat Ini</label>
                <input
                  type="number"
                  id="main_ppm_awal"
                  class="search-input"
                  placeholder="0"
                />
              </div>
              <div class="form-group">
                <label class="form-label">Target PPM</label>
                <input
                  type="number"
                  id="main_ppm_target"
                  class="search-input"
                  placeholder="1200"
                />
              </div>
            </div>

            <button
              class="btn btn-primary"
              style="width: 100%; margin-top: 10px"
              onclick="app.calculateNutrient()"
            >
              <i class="fa-solid fa-flask"></i> Hitung Sekarang
            </button>

            <div
              id="calcResultBox"
              style="
                background: var(--primary-light);
                border: 1px solid var(--primary);
                border-radius: 12px;
                padding: 20px;
                margin-top: 20px;
                text-align: center;
                display: none;
              "
            >
              <p
                style="
                  font-size: 0.9rem;
                  font-weight: 600;
                  color: var(--primary-dark);
                "
              >
                Tambahkan Dosis (A & B):
              </p>
              <div
                id="calcResultVal"
                style="
                  font-size: 2.5rem;
                  font-weight: 800;
                  color: var(--primary);
                  margin: 5px 0;
                "
              >
                0 ml
              </div>
              <p
                id="calcResultDetail"
                style="font-size: 0.8rem; color: var(--text-muted)"
              ></p>
            </div>

            <button
              class="btn btn-secondary"
              style="
                width: 100%;
                margin-top: 20px;
                color: var(--danger);
                border-color: var(--danger-border);
              "
              onclick="app.resetCalibration()"
            >
              Reset Kalibrasi
            </button>
          </div>
        </div>
      </section>

      <section id="settings" class="view-section" style="display: none">
        <div class="header-row">
          <div class="header-title">
            <h1>Pengaturan</h1>
          </div>
        </div>

        <div class="card" style="max-width: 600px">
          <h3 style="margin-bottom: 1rem">Manajemen Data</h3>
          <p
            style="
              color: var(--text-muted);
              margin-bottom: 1.5rem;
              line-height: 1.6;
            "
          >
            Ekspor data Anda secara berkala dalam format JSON agar aman, atau
            unduh laporan CSV untuk Excel.
          </p>

          <div
            style="
              display: flex;
              gap: 10px;
              margin-bottom: 20px;
              flex-wrap: wrap;
            "
          >
            <button class="btn btn-primary" onclick="app.exportData()">
              <i class="fa-solid fa-download"></i> Backup JSON
            </button>
            <button class="btn btn-secondary" onclick="app.exportCSV()">
              <i class="fa-solid fa-file-csv"></i> Laporan Excel
            </button>
            <button
              class="btn btn-secondary"
              onclick="document.getElementById('importFile').click()"
            >
              <i class="fa-solid fa-upload"></i> Restore
            </button>
            <input
              type="file"
              id="importFile"
              style="display: none"
              onchange="app.importData(this)"
            />
          </div>

          <div
            style="
              padding: 15px;
              background: var(--bg-body);
              border-radius: 8px;
              font-size: 0.9rem;
            "
          >
            <i class="fa-solid fa-database" style="color: var(--primary)"></i>
            Storage terpakai: <span id="storageUsed">0</span> KB
          </div>

          <div
            style="
              margin-top: 20px;
              border-top: 1px solid var(--border);
              padding-top: 20px;
            "
          >
            <h3 style="margin-bottom: 1rem">Notifikasi</h3>
            <p
              style="
                color: var(--text-muted);
                margin-bottom: 1.5rem;
                font-size: 0.9rem;
              "
            >
              Aktifkan notifikasi browser untuk mendapatkan pengingat penyiraman
              sesuai hari.
            </p>
            <button
              class="btn btn-secondary"
              onclick="app.requestNotification()"
            >
              <i class="fa-solid fa-bell"></i> Minta Izin Notifikasi
            </button>
          </div>
        </div>
      </section>

      <footer class="app-footer">
        <div class="footer-content">
          <div class="footer-left">
            <div class="footer-brand">
              <img
                src="logo-1.png"
                alt="leaf"
                style="height: 2em; vertical-align: middle; margin-right: 0.3em"
              />
              Smart Growa
            </div>
            <p class="footer-copyright" style="margin-top: 5px">
              &copy;
              <script>
                document.write(new Date().getFullYear());
              </script>
              MADNN Smart Farming Assistant.
            </p>
          </div>

          <div class="footer-links">
            <a
              href="https://www.tiktok.com/@keutiwaw"
              onclick="alert('DM @keutiwaw untuk bantuan dan masukan')"
              >Bantuan & Masukan</a
            >
            <a href="#" onclick="app.toggleTheme()">Ubah Tema</a>
          </div>
        </div>
      </footer>
    </main>

    <div class="modal-overlay" id="financeModal">
      <div class="modal-box">
        <div style="padding: 2rem">
          <h2 style="margin-bottom: 1.5rem">Catat Transaksi</h2>
          <form id="financeForm">
            <div class="form-group">
              <label class="form-label">Jenis</label>
              <select
                id="fType"
                class="search-input"
                onchange="app.toggleFinanceCat()"
              >
                <option value="in">Pemasukan (Panen/Jual)</option>
                <option value="out">Pengeluaran (Beli/Rawat)</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Nominal (Rp)</label>
              <input
                type="number"
                id="fAmount"
                class="search-input"
                placeholder="0"
                required
              />
            </div>
            <div class="form-group">
              <label class="form-label">Keterangan</label>
              <input
                type="text"
                id="fDesc"
                class="search-input"
                placeholder="Contoh: Jual Cabai 1kg"
                required
              />
            </div>
            <div class="form-group">
              <label class="form-label">Tanggal</label>
              <input type="date" id="fDate" class="search-input" required />
            </div>
            <div style="display: flex; gap: 10px; margin-top: 2rem">
              <button
                type="button"
                class="btn btn-secondary"
                style="flex: 1"
                onclick="app.closeModal('financeModal')"
              >
                Batal
              </button>
              <button type="submit" class="btn btn-primary" style="flex: 1">
                Simpan
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div class="modal-overlay" id="formModal">
      <div class="modal-box">
        <div style="padding: 2rem">
          <h2 style="margin-bottom: 0.5rem" id="formTitle">Tambah Tanaman</h2>

          <form id="plantForm">
            <input type="hidden" id="pId" />

            <div class="form-group">
              <label class="form-label">Metode Tanam</label>
              <div class="method-switch">
                <div
                  class="method-opt active"
                  id="optSoil"
                  onclick="app.setMethod('soil')"
                >
                  <i class="fa-solid fa-mound"></i> Media Tanah
                </div>
                <div
                  class="method-opt"
                  id="optHydro"
                  onclick="app.setMethod('hydro')"
                >
                  <i class="fa-solid fa-water"></i> Hidroponik
                </div>
              </div>
              <input type="hidden" id="pMethod" value="soil" />
            </div>

            <div class="form-group">
              <label class="form-label">Nama Tanaman (Latin / Indonesia)</label>
              <input
                type="text"
                id="pName"
                class="search-input"
                placeholder="Contoh: capsicum annuum"
                required
                onkeyup="app.checkPresets(this.value)"
              />
              <div
                id="presetHint"
                class="smart-suggestion"
                onclick="app.applyPreset()"
              >
                <i class="fa-solid fa-wand-magic-sparkles"></i> Jadwal otomatis
                tersedia! Klik untuk isi.
              </div>
            </div>

            <div
              style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px"
            >
              <div class="form-group">
                <label class="form-label">Kategori</label>
                <select id="pType" class="search-input">
                  <option value="Sayur">Sayur</option>
                  <option value="Bunga">Bunga</option>
                  <option value="Buah">Buah</option>
                  <option value="Hias">Hias</option>
                  <option value="Herbal">Herbal</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Tgl Tanam</label>
                <input type="date" id="pDate" class="search-input" required />
              </div>
            </div>

            <div
              style="
                background: var(--bg-body);
                padding: 1rem;
                border-radius: var(--radius-md);
                border: 1px dashed var(--primary);
                margin-bottom: 1rem;
              "
            >
              <div class="form-group" style="margin-bottom: 0.5rem">
                <label
                  class="form-label"
                  style="color: var(--primary)"
                  id="lblWaterAction"
                >
                  <i class="fa-solid fa-droplet"></i> Jadwal Siram Mingguan
                </label>
                <div class="day-selector-container" id="waterDayContainer">
                  <div
                    class="day-check"
                    data-day="1"
                    onclick="app.toggleDay(this, 'water')"
                  >
                    Sen
                  </div>
                  <div
                    class="day-check"
                    data-day="2"
                    onclick="app.toggleDay(this, 'water')"
                  >
                    Sel
                  </div>
                  <div
                    class="day-check"
                    data-day="3"
                    onclick="app.toggleDay(this, 'water')"
                  >
                    Rab
                  </div>
                  <div
                    class="day-check"
                    data-day="4"
                    onclick="app.toggleDay(this, 'water')"
                  >
                    Kam
                  </div>
                  <div
                    class="day-check"
                    data-day="5"
                    onclick="app.toggleDay(this, 'water')"
                  >
                    Jum
                  </div>
                  <div
                    class="day-check"
                    data-day="6"
                    onclick="app.toggleDay(this, 'water')"
                  >
                    Sab
                  </div>
                  <div
                    class="day-check"
                    data-day="0"
                    onclick="app.toggleDay(this, 'water')"
                  >
                    Min
                  </div>
                </div>
              </div>
            </div>

            <div
              id="hydroFlushSection"
              class="hydro-section"
              style="
                background: #e0f2fe;
                padding: 1rem;
                border-radius: var(--radius-md);
                border: 1px dashed #0284c7;
                margin-bottom: 1rem;
              "
            >
              <div class="form-group" style="margin-bottom: 0.5rem">
                <label class="form-label" style="color: #0284c7">
                  <i class="fa-solid fa-rotate"></i> Jadwal Kuras & Ganti
                  Nutrisi
                </label>
                <div style="display: flex; align-items: center; gap: 10px">
                  <span style="font-size: 0.9rem">Setiap</span>
                  <input
                    type="number"
                    id="hydroFlushFreq"
                    class="search-input"
                    style="
                      width: 70px;
                      text-align: center;
                      padding-left: 0.5rem;
                    "
                    min="1"
                    step="1"
                    inputmode="numeric"
                    placeholder="7"
                  />
                  <span style="font-size: 0.9rem">hari sekali</span>
                </div>
                <div
                  style="
                    font-size: 0.75rem;
                    color: #0369a1;
                    margin-top: 5px;
                    opacity: 0.8;
                  "
                >
                  *Gabungan jadwal kuras bak dan penggantian nutrisi AB Mix
                  baru.
                </div>
              </div>
            </div>

            <div
              id="commonFertSection"
              style="
                background: #fffbeb;
                padding: 1rem;
                border-radius: var(--radius-md);
                border: 1px dashed #f59e0b;
                margin-bottom: 1.2rem;
              "
            >
              <div class="form-group" style="margin-bottom: 0.5rem">
                <label class="form-label" style="color: #b45309"
                  ><i class="fa-solid fa-flask"></i> Jadwal Pupuk
                  Mingguan</label
                >
                <div class="day-selector-container" id="fertDayContainer">
                  <div
                    class="day-check"
                    data-day="1"
                    onclick="app.toggleDay(this, 'fert')"
                  >
                    Sen
                  </div>
                  <div
                    class="day-check"
                    data-day="2"
                    onclick="app.toggleDay(this, 'fert')"
                  >
                    Sel
                  </div>
                  <div
                    class="day-check"
                    data-day="3"
                    onclick="app.toggleDay(this, 'fert')"
                  >
                    Rab
                  </div>
                  <div
                    class="day-check"
                    data-day="4"
                    onclick="app.toggleDay(this, 'fert')"
                  >
                    Kam
                  </div>
                  <div
                    class="day-check"
                    data-day="5"
                    onclick="app.toggleDay(this, 'fert')"
                  >
                    Jum
                  </div>
                  <div
                    class="day-check"
                    data-day="6"
                    onclick="app.toggleDay(this, 'fert')"
                  >
                    Sab
                  </div>
                  <div
                    class="day-check"
                    data-day="0"
                    onclick="app.toggleDay(this, 'fert')"
                  >
                    Min
                  </div>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Foto</label>
              <input
                type="file"
                id="pImageInput"
                accept="image/*"
                class="search-input"
              />
              <div id="imgPreviewBox" class="img-preview-container">
                <img id="imgPreviewTag" src="" />
              </div>
              <div style="margin-top: 6px">
                <label
                  style="
                    font-size: 0.85rem;
                    display: inline-flex;
                    align-items: center;
                    gap: 8px;
                    color: var(--text-muted);
                  "
                >
                  <input
                    type="checkbox"
                    id="pImageRemove"
                    style="width: auto"
                  />
                  Hapus foto saat simpan
                </label>
              </div>
              <small
                style="
                  color: var(--text-muted);
                  font-size: 0.8rem;
                  margin-top: 5px;
                  display: block;
                "
              >
                *Kosongkan jika ingin gambar otomatis.
              </small>
            </div>

            <div style="display: flex; gap: 10px; margin-top: 2rem">
              <button
                type="button"
                class="btn btn-secondary"
                style="flex: 1"
                onclick="app.closeModal('formModal')"
              >
                Batal
              </button>
              <button type="submit" class="btn btn-primary" style="flex: 1">
                Simpan
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div class="modal-overlay" id="detailModal">
      <div class="modal-box" style="max-width: 600px">
        <div style="position: relative">
          <div style="height: 250px; width: 100%">
            <img
              id="dImage"
              src=""
              style="width: 100%; height: 100%; object-fit: cover"
            />
            <div
              style="
                position: absolute;
                inset: 0;
                background: linear-gradient(
                  to bottom,
                  transparent 60%,
                  rgba(0, 0, 0, 0.8)
                );
              "
            ></div>
          </div>
          <button
            onclick="app.closeModal('detailModal')"
            style="
              position: absolute;
              top: 15px;
              right: 15px;
              background: rgba(255, 255, 255, 0.9);
              border: none;
              width: 36px;
              height: 36px;
              border-radius: 50%;
              cursor: pointer;
              display: flex;
              align-items: center;
              justify-content: center;
              z-index: 10;
            "
          >
            <i class="fa-solid fa-times" style="color: #0f172a"></i>
          </button>
          <button
            onclick="app.openEditForm()"
            style="
              position: absolute;
              top: 15px;
              right: 60px;
              background: rgba(255, 255, 255, 0.9);
              border: none;
              width: 36px;
              height: 36px;
              border-radius: 50%;
              cursor: pointer;
              display: flex;
              align-items: center;
              justify-content: center;
              z-index: 10;
            "
          >
            <i class="fa-solid fa-pencil" style="color: #0f172a"></i>
          </button>

          <div
            style="position: absolute; bottom: 20px; left: 20px; color: white"
          >
            <span
              id="dType"
              class="badge"
              style="
                background: white;
                color: var(--primary);
                margin-bottom: 5px;
              "
              >Tipe</span
            >
            <span
              id="dHealthStatus"
              class="badge"
              style="
                background: var(--primary);
                color: white;
                margin-bottom: 5px;
                margin-left: 5px;
              "
              >Sehat</span
            >
            <h2 id="dName" style="margin: 0; font-size: 1.8rem">
              Nama Tanaman
            </h2>
            <p
              id="dScheduleInfo"
              style="font-size: 0.85rem; opacity: 0.9; margin-top: 4px"
            >
              Jadwal Siram: -
            </p>
            <p id="dFertInfo" style="font-size: 0.85rem; opacity: 0.9">
              Jadwal Pupuk: -
            </p>
          </div>
        </div>

        <div style="padding: 1.5rem">
          <div
            id="actionBtnContainer"
            style="
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
              gap: 10px;
              margin-bottom: 1rem;
            "
          ></div>

          <h4
            style="
              margin-bottom: 1rem;
              border-bottom: 1px solid var(--border);
              padding-bottom: 8px;
            "
          >
            Riwayat Aktivitas
          </h4>
          <div id="dTimeline" style="max-height: 200px; overflow-y: auto"></div>
        </div>
      </div>
    </div>

    <div class="modal-overlay" id="qrModal">
      <div class="modal-box" style="max-width: 400px; text-align: center">
        <div style="padding: 2rem">
          <h3 style="margin-bottom: 1rem">ID Card Tanaman</h3>
          <div
            id="printableArea"
            class="id-card-container"
            style="display: block"
          >
            <div class="id-card-header">SmartGrowa</div>
            <img
              id="qrImage"
              src=""
              style="width: 150px; height: 150px; margin: 10px 0"
            />
            <h2 id="qrName" style="margin: 5px 0">Nama</h2>
            <p id="qrType" style="color: #666; font-size: 0.9rem">Tipe</p>
            <div style="font-size: 0.7rem; color: #999; margin-top: 10px">
              ID: <span id="qrId"></span>
            </div>
          </div>
          <div style="display: flex; gap: 10px">
            <button
              class="btn btn-secondary"
              style="flex: 1"
              onclick="app.closeModal('qrModal')"
            >
              Tutup
            </button>
            <button
              class="btn btn-primary"
              style="flex: 1"
              onclick="window.print()"
            >
              <i class="fa-solid fa-print"></i> Cetak
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-overlay" id="clinicModal">
      <div class="modal-box">
        <div style="padding: 2rem">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 1.5rem;
            "
          >
            <h2 style="margin: 0; color: var(--danger)">
              <i class="fa-solid fa-notes-medical"></i> Klinik Tanaman
            </h2>
            <span
              style="
                font-size: 0.8rem;
                background: var(--bg-body);
                padding: 4px 8px;
                border-radius: 8px;
                color: var(--text-muted);
              "
              >Diagnosa & Penanganan</span
            >
          </div>

          <div class="form-group">
            <label class="form-label">Status Kesehatan</label>
            <div
              style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px"
            >
              <select
                id="cStatus"
                class="search-input"
                onchange="app.checkClinicStatus()"
              >
                <option value="healthy">Sehat (Sembuh)</option>
                <option value="sick">Sakit / Karantina</option>
              </select>
              <select id="cSeverity" class="search-input" disabled>
                <option value="">- Tingkat -</option>
                <option value="Ringan">Ringan</option>
                <option value="Sedang">Sedang</option>
                <option value="Berat">Berat</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Masalah (Hama/Penyakit)</label>
            <input
              type="text"
              id="cIssue"
              class="search-input"
              list="issueList"
              placeholder="Ketik atau pilih masalah..."
              oninput="app.checkClinicSuggestion()"
            />
            <datalist id="issueList"> </datalist>
          </div>

          <div
            id="cSuggestion"
            style="
              display: none;
              background: var(--primary-light);
              color: var(--primary-dark);
              padding: 10px;
              border-radius: 8px;
              margin-bottom: 1rem;
              font-size: 0.9rem;
              border: 1px solid var(--primary);
            "
          >
            <i class="fa-solid fa-lightbulb"></i> <b>Saran:</b>
            <span id="cSuggestionText"></span>
          </div>

          <div class="form-group">
            <label class="form-label">Solusi / Tindakan</label>
            <textarea
              id="cSolution"
              class="search-input"
              rows="3"
              placeholder="Tindakan yang dilakukan..."
            ></textarea>
          </div>

          <div style="display: flex; gap: 10px; margin-top: 2rem">
            <button
              type="button"
              class="btn btn-secondary"
              style="flex: 1"
              onclick="app.closeModal('clinicModal')"
            >
              Batal
            </button>
            <button
              type="button"
              class="btn btn-danger"
              style="flex: 1"
              onclick="app.saveClinicLog()"
            >
              <i class="fa-solid fa-save"></i> Simpan Catatan
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-overlay" id="sensorModal">
      <div class="modal-box">
        <div style="padding: 2rem">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 1.5rem;
            "
          >
            <h2 style="margin: 0">
              <i class="fa-solid fa-microchip"></i> Analisis Sensor
            </h2>
          </div>

          <div class="method-switch" style="margin-bottom: 15px">
            <div
              id="sensorTabSoil"
              class="method-opt active"
              onclick="app.switchSensorTab('soil')"
            >
              Media Tanam
            </div>
            <div
              id="sensorTabHydro"
              class="method-opt"
              onclick="app.switchSensorTab('hydro')"
            >
              Hidroponik
            </div>
          </div>

          <form id="sensorForm">
            <!-- Parameter Media Section -->
            <div style="margin-bottom: 1rem">
              <h4
                style="
                  font-size: 0.85rem;
                  color: var(--text-muted);
                  margin-bottom: 0.8rem;
                  text-transform: uppercase;
                  letter-spacing: 0.5px;
                  font-weight: 700;
                "
              >
                Parameter Media
              </h4>

              <div id="soilInputs">
                <div class="sensor-grid">
                  <div class="sensor-input-group">
                    <label class="form-label">Kelembaban Tanah</label>
                    <input
                      type="number"
                      id="sMoisture"
                      class="search-input"
                      placeholder="0-100"
                      step="1"
                    />
                    <span class="sensor-unit">%</span>
                  </div>
                  <div class="sensor-input-group">
                    <label class="form-label">pH Tanah</label>
                    <input
                      type="number"
                      id="sPh"
                      class="search-input"
                      placeholder="0-14"
                      step="0.1"
                    />
                    <span class="sensor-unit">pH</span>
                  </div>
                  <div class="sensor-input-group" style="grid-column: span 2">
                    <label class="form-label">Nutrisi (EC)</label>
                    <input
                      type="number"
                      id="sEcSoil"
                      class="search-input"
                      placeholder="0-3000"
                      step="10"
                    />
                    <span class="sensor-unit">μS/cm</span>
                  </div>
                </div>
              </div>

              <div id="hydroInputs" style="display: none">
                <div class="sensor-grid">
                  <div class="sensor-input-group">
                    <label class="form-label">Nutrisi (EC)</label>
                    <input
                      type="number"
                      id="sEc"
                      class="search-input"
                      placeholder="0-3000"
                      step="10"
                    />
                    <span class="sensor-unit">μS/cm</span>
                  </div>
                  <div class="sensor-input-group">
                    <label class="form-label">pH Air</label>
                    <input
                      type="number"
                      id="sPhHydro"
                      class="search-input"
                      placeholder="0-14"
                      step="0.1"
                    />
                    <span class="sensor-unit">pH</span>
                  </div>
                  <div class="sensor-input-group" style="grid-column: span 2">
                    <label class="form-label">Suhu Air</label>
                    <input
                      type="number"
                      id="sTempWater"
                      class="search-input"
                      placeholder="0-50"
                      step="0.1"
                    />
                    <span class="sensor-unit">°C</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Parameter Lingkungan Section -->
            <div
              style="
                margin-bottom: 1.5rem;
                border-top: 1px dashed var(--border);
                padding-top: 1rem;
              "
            >
              <h4
                style="
                  font-size: 0.85rem;
                  color: var(--text-muted);
                  margin-bottom: 0.8rem;
                  text-transform: uppercase;
                  letter-spacing: 0.5px;
                  font-weight: 700;
                "
              >
                Parameter Lingkungan
              </h4>
              <div class="sensor-grid">
                <div class="sensor-input-group">
                  <label class="form-label">Suhu Udara</label>
                  <input
                    type="number"
                    id="sTemp"
                    class="search-input"
                    placeholder="0-50"
                    step="0.1"
                  />
                  <span class="sensor-unit">°C</span>
                </div>
                <div class="sensor-input-group">
                  <label class="form-label">Kelembaban Udara</label>
                  <input
                    type="number"
                    id="sHum"
                    class="search-input"
                    placeholder="0-100"
                    step="1"
                  />
                  <span class="sensor-unit">%</span>
                </div>
                <div class="sensor-input-group" style="grid-column: span 2">
                  <label class="form-label">Cahaya (Lux)</label>
                  <input
                    type="number"
                    id="sLux"
                    class="search-input"
                    placeholder="0-100k"
                    step="100"
                  />
                  <span class="sensor-unit">Lux</span>
                </div>
              </div>
            </div>

            <div style="display: flex; gap: 10px; margin-top: 1rem">
              <button
                type="button"
                class="btn btn-secondary"
                style="flex: 1"
                onclick="app.closeModal('sensorModal')"
              >
                Batal
              </button>
              <button
                type="button"
                class="btn btn-primary"
                style="flex: 2"
                onclick="app.runAnalysis()"
              >
                <i class="fa-solid fa-calculator"></i> Jalankan Analisis
              </button>
            </div>
          </form>

          <div id="analysisResult" class="analysis-result-card">
            <div
              style="
                display: flex;
                align-items: center;
                gap: 10px;
                margin-bottom: 1rem;
              "
            >
              <i
                id="anIcon"
                class="fa-solid fa-check-circle"
                style="font-size: 1.5rem"
              ></i>
              <h3 id="anTitle" style="margin: 0">Kondisi Optimal</h3>
            </div>

            <div
              id="anAdvice"
              style="margin-bottom: 1rem; font-weight: 600; line-height: 1.4"
            >
              Semua parameter terlihat bagus. Lanjutkan perawatan rutin.
            </div>

            <div
              style="
                background: rgba(255, 255, 255, 0.5);
                padding: 10px;
                border-radius: 8px;
              "
            >
              <h4 style="font-size: 0.85rem; margin-bottom: 5px; opacity: 0.8">
                DETAIL PARAMETER:
              </h4>
              <div id="anDetails"></div>
            </div>

            <div style="display: flex; gap: 10px; margin-top: 1.5rem">
              <button
                class="btn btn-secondary"
                style="flex: 1"
                onclick="app.closeModal('sensorModal')"
              >
                Tutup
              </button>
              <button
                class="btn btn-primary"
                style="flex: 1"
                onclick="app.saveAnalysisLog()"
              >
                <i class="fa-solid fa-save"></i> Simpan ke Log
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="toast" class="toast">
      <i class="fa-solid fa-check-circle" style="color: #4ade80"></i>
      <span id="toastMsg">Berhasil!</span>
    </div>

    <script>
      let PLANT_KNOWLEDGE = {};
      let OPTIMAL_CONDITIONS = {};

      const DEFAULT_CONDITIONS = {
        moisture: [60, 80],
        ph: [6.0, 7.0],
        ec: [1000, 2000],
        temp: [20, 30],
        lux: [10000, 30000],
        hum: [50, 70],
      };

      const CLINIC_KNOWLEDGE = {
        "Kutu Putih":
          "Semprot air sabun cair + minyak goreng (1 sdt/liter) atau Neem Oil.",
        "Daun Kuning":
          "Cek kelembaban tanah (kurang/lebih air). Beri pupuk Nitrogen jika tanah bagus.",
        "Busuk Akar":
          "Kurangi siram. Bongkar media, potong akar busuk, ganti media baru yang porous.",
        "Bercak Daun":
          "Jamur/Bakteri. Pangkas daun sakit, hindari siram daun, gunakan fungisida.",
        Ulat: "Ambil manual. Semprot pestisida nabati (bawang putih/cabai).",
        Layu: "Jika tanah basah tapi layu = Busuk Akar/Bakteri. Jika kering = Kurang Air.",
        "Tungau/Mite":
          "Daun bintik kuning/perak. Semprot air deras atau akarisida.",
        Jamur:
          "Lapisan putih/hitam. Kurangi kelembaban, sirkulasi udara diperbaiki, fungisida.",
      };

      const DEFAULT_IMG =
        "https://images.unsplash.com/photo-1466692476868-aef1dfb1e735?auto=format&fit=crop&w=600&q=80";
      const DAYS_MAP = ["Min", "Sen", "Sel", "Rab", "Kam", "Jum", "Sab"];

      const app = {
        user: null,
        data: [],
        financeData: [],
        currentId: null,
        editingId: null,
        financeEditingId: null,
        chart: null,
        financeChart: null,
        growthChart: null,
        harvestChart: null,
        activePreset: null,
        currentAnalysis: null,
        ppmConstant: 0,
        wikiCache: {},
        deepLinkHandled: false,

        // --- FITUR CALCULATOR NUTRISI ---
        initCalculator() {
          const savedConstant = localStorage.getItem("abmix_constant");
          if (savedConstant) {
            this.ppmConstant = parseFloat(savedConstant);
            this.updateCalibrationUI(true, this.ppmConstant);
          } else {
            this.updateCalibrationUI(false, 0);
          }
        },

        updateCalibrationUI(isCalibrated, val) {
          const el = document.getElementById("calibrationStatus");
          if (!el) return;
          if (isCalibrated) {
            el.className = "status-pill";
            el.style.background = "var(--primary-light)";
            el.style.color = "var(--primary)";
            el.style.borderColor = "var(--primary)";
            el.innerHTML = `<i class="fa-solid fa-check"></i> Konfigurasi Aktif: ${parseFloat(
              val
            ).toFixed(1)} PPM (ml/L)`;
          } else {
            el.className = "status-pill urgent"; // Memakai style urgent yang sudah ada (merah)
            el.innerHTML = `<i class="fa-solid fa-triangle-exclamation"></i> Alat belum terkalibrasi`;
          }
        },

        runCalibration() {
          const volAir = parseFloat(
            document.getElementById("cal_vol_air").value
          );
          const dosis = parseFloat(document.getElementById("cal_dosis").value);
          const ppmAwal = parseFloat(
            document.getElementById("cal_ppm_awal").value
          );
          const ppmAkhir = parseFloat(
            document.getElementById("cal_ppm_akhir").value
          );

          if (!volAir || !dosis || isNaN(ppmAwal) || !ppmAkhir) {
            alert("Semua kolom kalibrasi wajib diisi.");
            return;
          }

          if (ppmAkhir <= ppmAwal) {
            alert("PPM Akhir harus lebih tinggi dari PPM Baku.");
            return;
          }

          const kenaikanPPM = ppmAkhir - ppmAwal;
          const constant = (kenaikanPPM * volAir) / dosis;

          this.ppmConstant = constant;
          localStorage.setItem("abmix_constant", constant);
          this.updateCalibrationUI(true, constant);

          this.showToast(
            `Kalibrasi Berhasil! Konstanta: ${constant.toFixed(1)}`
          );
        },

        calculateNutrient() {
          if (this.ppmConstant <= 0) {
            alert("Lakukan kalibrasi pada Langkah 01 terlebih dahulu.");
            return;
          }

          const volTandon = parseFloat(
            document.getElementById("main_vol_tandon").value
          );
          const ppmAwal = parseFloat(
            document.getElementById("main_ppm_awal").value
          );
          const ppmTarget = parseFloat(
            document.getElementById("main_ppm_target").value
          );

          if (!volTandon || isNaN(ppmAwal) || !ppmTarget) {
            alert("Isi volume tandon dan target PPM Anda.");
            return;
          }

          if (ppmTarget <= ppmAwal) {
            alert("PPM saat ini sudah melebihi atau sama dengan target.");
            document.getElementById("calcResultBox").style.display = "none";
            return;
          }

          const ppmNeeded = ppmTarget - ppmAwal;
          const mlNeeded = (ppmNeeded / this.ppmConstant) * volTandon;

          document.getElementById("calcResultVal").innerText =
            mlNeeded.toLocaleString("id-ID", { maximumFractionDigits: 1 }) +
            " ml";
          document.getElementById(
            "calcResultDetail"
          ).innerText = `Untuk menaikkan ${ppmNeeded} PPM pada ${volTandon} Liter air.`;
          document.getElementById("calcResultBox").style.display = "block";
        },

        resetCalibration() {
          if (
            confirm(
              "Hapus data kalibrasi? Anda harus kalibrasi ulang jika ganti merek nutrisi."
            )
          ) {
            localStorage.removeItem("abmix_constant");
            this.ppmConstant = 0;
            document.getElementById("calcResultBox").style.display = "none";
            this.updateCalibrationUI(false, 0);

            // Reset inputs
            [
              "cal_vol_air",
              "cal_dosis",
              "cal_ppm_awal",
              "cal_ppm_akhir",
            ].forEach((id) => (document.getElementById(id).value = ""));
            this.showToast("Kalibrasi dihapus.");
          }
        },

        loginGoogle() {
          if (!window.authOps) {
            alert(
              "Sistem Login belum siap. Pastikan Konfigurasi Firebase sudah diisi di bagian bawah kode (baris ~2756)."
            );
            return;
          }
          const provider = new window.authOps.GoogleAuthProvider();
          window.authOps
            .signInWithPopup(window.auth, provider)
            .then((result) => {
              // Login berhasil, onAuthStateChanged akan menangani sisanya
              console.log("Login Berhasil:", result.user.email);
            })
            .catch((error) => {
              alert("Gagal Login: " + error.message);
            });
        },

        logout() {
          if (confirm("Keluar dari akun?")) {
            window.authOps.signOut(window.auth).then(() => {
              location.reload(); // Refresh halaman
            });
          }
        },

        // --- FEATURE: METHOD SWITCH (SOIL vs HYDRO) ---
        switchSensorTab(type) {
          if (type === "soil") {
            document.getElementById("soilInputs").style.display = "block";
            document.getElementById("hydroInputs").style.display = "none";
            document.getElementById("sensorTabSoil").className =
              "method-opt active";
            document.getElementById("sensorTabHydro").className = "method-opt";
          } else {
            document.getElementById("soilInputs").style.display = "none";
            document.getElementById("hydroInputs").style.display = "block";
            document.getElementById("sensorTabSoil").className = "method-opt";
            document.getElementById("sensorTabHydro").className =
              "method-opt active";
          }
        },

        setMethod(type) {
          document.getElementById("pMethod").value = type;
          const lblWater = document.getElementById("lblWaterAction");
          const hydroSec = document.getElementById("hydroFlushSection");
          const fertSec = document.getElementById("commonFertSection");

          // UI Toggles
          if (type === "hydro") {
            document.getElementById("optSoil").className = "method-opt";
            document.getElementById("optHydro").className =
              "method-opt active-hydro";
            lblWater.innerHTML =
              '<i class="fa-solid fa-faucet-drip"></i> Cek Air & Nutrisi (Top-up)';
            hydroSec.style.display = "block";
            if (fertSec) fertSec.style.display = "none"; // Hide fertilizer section in hydro (merged into flush/nutrients)
          } else {
            document.getElementById("optSoil").className = "method-opt active";
            document.getElementById("optHydro").className = "method-opt";
            lblWater.innerHTML =
              '<i class="fa-solid fa-droplet"></i> Jadwal Siram Mingguan';
            hydroSec.style.display = "none";
            if (fertSec) fertSec.style.display = "block";
          }
        },

        async waterAllDue() {
          const today = new Date().setHours(0, 0, 0, 0);
          let plantsToUpdate = [];

          this.data.forEach((p) => {
            const nextWater = this.getNextDate(p.waterSchedule, p.lastWater);
            if (nextWater.getTime() <= today) {
              p.lastWater = new Date().toISOString();
              p.logs.push({
                date: new Date().toISOString(),
                type: "siram",
                action: "Disiram (Otomatis)",
              });
              plantsToUpdate.push(p);
            }
          });

          if (plantsToUpdate.length > 0) {
            await this.batchUpdatePlants(plantsToUpdate);
            this.updateUI();
            this.showToast(
              `${plantsToUpdate.length} tanaman berhasil disiram!`
            );
          }
        },

        openSensorModal() {
          document.getElementById("sensorForm").reset();
          document.getElementById("analysisResult").style.display = "none";
          this.currentAnalysis = null;

          const p = this.data.find((x) => x.id === this.currentId);
          if (p && p.method === "hydro") {
            this.switchSensorTab("hydro");
          } else {
            this.switchSensorTab("soil");
          }

          this.openModal("sensorModal");
        },

        simulateSensor() {
          // Simulation removed as per user request
        },

        runAnalysis() {
          const p = this.data.find((x) => x.id === this.currentId);
          const resolved = this.resolveIdealRange(p);
          const range = resolved.range || OPTIMAL_CONDITIONS["Default"];
          const isHydro = document
            .getElementById("sensorTabHydro")
            .classList.contains("active");

          // Base inputs (common)
          const inputs = {
            temp: parseFloat(document.getElementById("sTemp").value),
            lux: parseFloat(document.getElementById("sLux").value),
            hum: parseFloat(document.getElementById("sHum").value),
          };

          // Method specific inputs
          if (isHydro) {
            inputs.ec = parseFloat(document.getElementById("sEc").value);
            inputs.ph = parseFloat(document.getElementById("sPhHydro").value);
            inputs.tempWater = parseFloat(
              document.getElementById("sTempWater").value
            );
          } else {
            inputs.moisture = parseFloat(
              document.getElementById("sMoisture").value
            );
            inputs.ph = parseFloat(document.getElementById("sPh").value);
            inputs.ec = parseFloat(document.getElementById("sEcSoil").value);
          }

          // Validation
          if (isNaN(inputs.temp) || isNaN(inputs.lux) || isNaN(inputs.hum)) {
            alert("Data lingkungan tidak lengkap");
            return;
          }
          if (isHydro) {
            if (
              isNaN(inputs.ec) ||
              isNaN(inputs.ph) ||
              isNaN(inputs.tempWater)
            ) {
              alert("Data sensor hidroponik tidak lengkap");
              return;
            }
          } else {
            if (
              isNaN(inputs.moisture) ||
              isNaN(inputs.ph) ||
              isNaN(inputs.ec)
            ) {
              alert("Data sensor tanah tidak lengkap");
              return;
            }
          }

          let issues = [];
          let score = 0;
          let htmlDetails = "";

          const check = (val, min, max, name, unit, lowMsg, highMsg) => {
            let status = "OK";
            let colorClass = "status-ok";
            if (val < min) {
              status = "LOW";
              colorClass = "status-bad";
              issues.push(lowMsg);
            } else if (val > max) {
              status = "HIGH";
              colorClass = "status-bad";
              issues.push(highMsg);
            } else {
              score++;
            }
            htmlDetails += `
                        <div class="health-parameter-row">
                            <span>${name} (${val} ${unit})</span>
                            <span class="param-status ${colorClass}">${status}</span>
                        </div>`;
          };

          // Apply checks based on method
          if (isHydro) {
            check(
              inputs.ec,
              range.ec[0],
              range.ec[1],
              "Nutrisi (EC)",
              "μS",
              "Kurang nutrisi: <b>Tambah dosis pupuk</b>.",
              "Overdosis pupuk: <b>Flushing dengan air murni</b>."
            );
            check(
              inputs.ph,
              range.ph[0],
              range.ph[1],
              "pH Air",
              "",
              "pH Asam: <b>Tambahkan pH Up/Basa</b>.",
              "pH Basa: <b>Tambahkan pH Down/Asam</b>."
            );
            check(
              inputs.tempWater,
              18,
              28,
              "Suhu Air",
              "°C",
              "Air terlalu dingin: <b>Gunakan heater/pemanas</b>.",
              "Air terlalu panas: <b>Tambahkan es batu/chiller</b>."
            );
          } else {
            check(
              inputs.moisture,
              range.moisture[0],
              range.moisture[1],
              "Kelembaban",
              "%",
              "Tanah terlalu kering: <b>Segera siram</b>.",
              "Tanah terlalu basah: <b>Hentikan penyiraman</b>."
            );
            check(
              inputs.ph,
              range.ph[0],
              range.ph[1],
              "pH Tanah",
              "",
              "pH Asam: <b>Tambahkan Dolomit/Kapur</b>.",
              "pH Basa: <b>Tambahkan Sulfur/Belerang</b>."
            );
            check(
              inputs.ec,
              range.ec[0],
              range.ec[1],
              "Nutrisi (EC)",
              "μS",
              "Tanah kurang subur: <b>Beri pupuk susulan</b>.",
              "Tanah terlalu asin: <b>Flushing/siram air banyak</b>."
            );
          }

          check(
            inputs.temp,
            range.temp[0],
            range.temp[1],
            "Suhu Udara",
            "°C",
            "Suhu terlalu dingin: <b>Pasang lampu pemanas/greenhouse</b>.",
            "Suhu panas: <b>Beri naungan/sprinkler</b>."
          );
          check(
            inputs.lux,
            range.lux[0],
            range.lux[1],
            "Cahaya",
            "Lux",
            "Kurang cahaya: <b>Pindah ke tempat terang/Grow light</b>.",
            "Terbakar matahari: <b>Beri naungan (paranet)</b>."
          );
          check(
            inputs.hum,
            range.hum[0],
            range.hum[1],
            "Udara",
            "%",
            "Udara kering: <b>Semprot daun (misting)</b>.",
            "Udara lembab: <b>Perbaiki sirkulasi udara/kipas</b>."
          );

          const card = document.getElementById("analysisResult");
          const title = document.getElementById("anTitle");
          const advice = document.getElementById("anAdvice");
          const icon = document.getElementById("anIcon");

          card.classList.remove(
            "analysis-optimal",
            "analysis-warning",
            "analysis-critical"
          );

          let statusText = "",
            finalAction = "";
          const totalParams = 6;

          if (score === totalParams) {
            card.classList.add("analysis-optimal");
            title.innerText = "Kondisi Tanaman Optimal";
            advice.innerHTML =
              "Lingkungan tumbuh sempurna. Pertahankan rutinitas saat ini.";
            icon.className = "fa-solid fa-check-circle";
            statusText = "Optimal";
            finalAction = "Cek Sensor: Sehat";
          } else if (score >= totalParams - 2) {
            card.classList.add("analysis-warning");
            title.innerText = "Cek Sensor: Perlu Tindakan";
            advice.innerHTML = `<div style="margin-bottom:5px;">Lakukan tindakan berikut:</div><ul style="padding-left:20px; margin:0;">${issues
              .map((i) => `<li style="margin-bottom:4px;">${i}</li>`)
              .join("")}</ul>`;
            icon.className = "fa-solid fa-triangle-exclamation";
            statusText = "Warning";
            finalAction = "Cek Sensor: Perlu Tindakan";
          } else {
            card.classList.add("analysis-critical");
            title.innerText = "Cek Sensor: Perlu Tindakan Segera";
            advice.innerHTML = `<div style="margin-bottom:5px; font-weight:bold; color:var(--danger);">Tindakan Kritis Diperlukan:</div><ul style="padding-left:20px; margin:0;">${issues
              .map((i) => `<li style="margin-bottom:4px;">${i}</li>`)
              .join("")}</ul>`;
            icon.className = "fa-solid fa-skull-crossbones";
            statusText = "Critical";
            finalAction = "Cek Sensor: KRITIS";
          }

          document.getElementById("anDetails").innerHTML = htmlDetails;
          card.style.display = "block";

          this.currentAnalysis = {
            status: statusText,
            actionTitle: finalAction,
            adviceRaw: issues.join(", ") || "Semua parameter optimal",
            inputs: inputs,
            issues: issues,
          };
        },

        saveAnalysisLog() {
          if (!this.currentAnalysis) return;
          const idx = this.data.findIndex((p) => p.id === this.currentId);

          const logData = {
            date: new Date().toISOString(),
            type: "clinic",
            action: this.currentAnalysis.actionTitle,
            desc: `Diagnosa: ${this.currentAnalysis.status}.`,
            sensorData: this.currentAnalysis.inputs,
            status: this.currentAnalysis.status, // "Optimal", "Warning", "Critical"
            issues: this.currentAnalysis.issues, // Array of instruction strings
          };

          this.data[idx].logs.push(logData);

          if (this.currentAnalysis.status === "Critical") {
            this.data[idx].healthStatus = "sick";
            this.showToast("Status tanaman diubah menjadi SAKIT");
          }

          this.savePlant(this.data[idx]);
          this.closeModal("sensorModal");
          this.renderTimeline(this.data[idx]);
          this.openDetail(this.currentId);
          this.showToast("Data sensor disimpan!");
        },

        showInstruction(encodedIssues) {
          const issues = JSON.parse(decodeURIComponent(encodedIssues));
          const list = document.getElementById("instructionList");
          list.innerHTML = issues
            .map(
              (i) =>
                `<li style="margin-bottom:8px; padding-bottom:8px; border-bottom:1px solid #e2e8f0;">${i}</li>`
            )
            .join("");
          this.openModal("instructionModal");
        },

        async loadStaticData() {
          try {
            const [pkRes, ocRes] = await Promise.all([
              fetch("plant_knowledge.json"),
              fetch("optimal_conditions.json"),
            ]);

            if (!pkRes.ok) throw new Error("Gagal memuat plant_knowledge.json");
            if (!ocRes.ok)
              throw new Error("Gagal memuat optimal_conditions.json");

            PLANT_KNOWLEDGE = await pkRes.json();

            // Fix: Flatten nested structure of optimal_conditions.json
            const rawOC = await ocRes.json();
            const rootOC = rawOC.optimal_conditions || rawOC;
            const flatOC = {};
            for (const key in rootOC) {
              const val = rootOC[key];
              if (val.moisture || val.ph) {
                flatOC[key] = val;
              } else {
                Object.assign(flatOC, val);
              }
            }
            OPTIMAL_CONDITIONS = flatOC;
            console.log("Static data loaded");
          } catch (e) {
            console.error("Failed to load static data:", e);
            this.showToast(
              "Gagal memuat data referensi tanaman. Pastikan file JSON tersedia."
            );
          }
        },

        async init() {
          await this.loadStaticData();
          // Setup dasar UI
          const theme = localStorage.getItem("sg_theme") || "light";
          document.documentElement.setAttribute("data-theme", theme);
          this.startClock();
          this.fetchWeather();

          // CEK STATUS LOGIN
          window.authOps.onAuthStateChanged(window.auth, async (user) => {
            if (user) {
              // --- JIKA USER SUDAH LOGIN ---
              this.user = user;

              // 1. Sembunyikan layar login
              document.getElementById("loginScreen").style.display = "none";

              // 2. Tampilkan info user
              const uInfo = document.getElementById("userInfo");
              if (uInfo) uInfo.style.display = "inline-flex";

              const uName = document.getElementById("userName");
              if (uName) uName.innerText = user.displayName;

              const uPhoto = document.getElementById("userPhoto");
              if (uPhoto) uPhoto.src = user.photoURL;

              // 3. AMBIL DATA DARI FOLDER KHUSUS USER (users/{uid}/plants)
              await this.loadUserData();
            } else {
              // --- JIKA BELUM LOGIN ---
              document.getElementById("loginScreen").style.display = "flex";
              document.getElementById("userInfo").style.display = "none";
            }
          });

          // Timer cek notifikasi
          setInterval(() => {
            this.checkReminders();
          }, 3600000);
        },

        // Fungsi baru untuk mengambil data spesifik user
        async loadUserData() {
          if (!this.user) return;
          const uid = this.user.uid; // ID Unik Pengguna

          // Ambil Data Tanaman: path-nya sekarang 'users' -> uid -> 'plants'
          const plantsRef = window.fbOps.collection(
            window.db,
            "users",
            uid,
            "plants"
          );
          const pSnap = await window.fbOps.getDocs(plantsRef);
          this.data = pSnap.docs.map((doc) => doc.data());

          // Ambil Data Keuangan: path-nya sekarang 'users' -> uid -> 'finance'
          const finRef = window.fbOps.collection(
            window.db,
            "users",
            uid,
            "finance"
          );
          const fSnap = await window.fbOps.getDocs(finRef);
          this.financeData = fSnap.docs.map((doc) => doc.data());

          // Update UI setelah data diambil
          this.updateUI();
          this.updateStorageInfo();
          this.checkReminders();
          this.handleDeepLink();
        },

        // OPTIMIZED SAVE: Only save one plant
        async savePlant(plant) {
          if (!this.user) return;
          const uid = this.user.uid;
          try {
            const docRef = window.fbOps.doc(
              window.db,
              "users",
              uid,
              "plants",
              plant.id.toString()
            );
            await window.fbOps.setDoc(docRef, plant);
          } catch (e) {
            console.error("Error saving plant:", e);
          }
          this.updateStorageInfo();
        },

        // OPTIMIZED SAVE: Only save one finance record
        async saveFinanceItem(item) {
          if (!this.user) return;
          const uid = this.user.uid;
          try {
            const docRef = window.fbOps.doc(
              window.db,
              "users",
              uid,
              "finance",
              item.id.toString()
            );
            await window.fbOps.setDoc(docRef, item);
          } catch (e) {
            console.error("Error saving finance:", e);
          }
        },

        // BATCH UPDATE: For waterAllDue and RainDelay
        async batchUpdatePlants(plantsToUpdate) {
          if (!this.user || plantsToUpdate.length === 0) return;
          const uid = this.user.uid;
          const batch = window.fbOps.writeBatch(window.db);

          plantsToUpdate.forEach((p) => {
            const docRef = window.fbOps.doc(
              window.db,
              "users",
              uid,
              "plants",
              p.id.toString()
            );
            batch.set(docRef, p);
          });

          try {
            await batch.commit();
            console.log("Batch update success");
          } catch (e) {
            console.error("Batch update failed:", e);
          }
          this.updateStorageInfo();
        },

        async batchUpdateFinance(itemsToUpdate) {
          if (!this.user || itemsToUpdate.length === 0) return;
          const uid = this.user.uid;

          const chunkSize = 400;
          for (let i = 0; i < itemsToUpdate.length; i += chunkSize) {
            const chunk = itemsToUpdate.slice(i, i + chunkSize);
            const batch = window.fbOps.writeBatch(window.db);

            chunk.forEach((item) => {
              const docRef = window.fbOps.doc(
                window.db,
                "users",
                uid,
                "finance",
                item.id.toString()
              );
              batch.set(docRef, item);
            });

            try {
              await batch.commit();
              console.log(
                `Batch finance update success (chunk ${i / chunkSize + 1})`
              );
            } catch (e) {
              console.error("Batch finance update failed:", e);
            }
          }
        },

        async save() {
          // DEPRECATED: Use savePlant or batchUpdatePlants instead for better performance.
          // Kept for backward compatibility if needed, but should be avoided.
          if (!this.user) return;
          const uid = this.user.uid;

          // Loop dan simpan ke: users/{uid}/plants/{plantId}
          this.data.forEach(async (plant) => {
            try {
              // Perhatikan path-nya: users -> uid -> plants -> id
              const docRef = window.fbOps.doc(
                window.db,
                "users",
                uid,
                "plants",
                plant.id.toString()
              );
              await window.fbOps.setDoc(docRef, plant);
            } catch (e) {
              console.error(e);
            }
          });

          this.updateUI();
          this.updateStorageInfo();
        },

        async saveFinance() {
          // DEPRECATED: Use saveFinanceItem or batchUpdateFinance
          if (!this.user) return;
          await this.batchUpdateFinance(this.financeData);
          this.updateUI();
        },

        startClock() {
          const updateTime = () => {
            const now = new Date();
            const clockEl = document.getElementById("clockDisplay");
            if (clockEl)
              clockEl.innerText = now.toLocaleTimeString("id-ID", {
                hour12: false,
              });

            const hours = now.getHours();
            let greet =
              hours < 11
                ? "Selamat Pagi"
                : hours < 15
                ? "Selamat Siang"
                : hours < 18
                ? "Selamat Sore"
                : "Selamat Malam";
            const greetEl = document.getElementById("greeting");
            if (greetEl) greetEl.innerText = `${greet},`;

            const dateEl = document.getElementById("dateDisplay");
            if (dateEl)
              dateEl.innerText = now.toLocaleDateString("id-ID", {
                weekday: "long",
                day: "numeric",
                month: "long",
                year: "numeric",
              });
          };
          updateTime();
          setInterval(updateTime, 1000);
        },

        updateStorageInfo() {
          const str =
            JSON.stringify(this.data) + JSON.stringify(this.financeData);
          document.getElementById("storageUsed").innerText = (
            str.length / 1024
          ).toFixed(2);
        },

        updateUI() {
          this.renderDashboard();
          this.renderGrid();
          this.renderFinance();
          this.checkHealthAlerts();
          this.handleDeepLink();
        },

        handleDeepLink() {
          if (this.deepLinkHandled) return;
          const params = new URLSearchParams(window.location.search);
          const pid = params.get("plantId");
          if (!pid) return;
          const target =
            this.data.find((p) => p.id.toString() === pid) ||
            this.data.find((p) => p.id === parseInt(pid));
          if (target) {
            this.openDetail(target.id);
            this.deepLinkHandled = true;
          }
        },

        checkHealthAlerts() {
          const sickPlants = this.data.filter((p) => p.healthStatus === "sick");
          const alertContainer = document.getElementById("sickAlertContainer");
          if (!alertContainer) return;

          if (sickPlants.length > 0) {
            alertContainer.innerHTML = `
                        <div class="alert-banner">
                            <div>
                                <h3 style="margin-bottom:2px;"><i class="fa-solid fa-triangle-exclamation"></i> Perhatian Diperlukan</h3>
                                <p style="font-size:0.9rem;">Ada <b>${sickPlants.length}</b> tanaman yang terdeteksi sakit.</p>
                            </div>
                            <button class="btn btn-sm" style="background:white; color:var(--danger); border:none;" onclick="app.filterSickPlants()">Lihat</button>
                        </div>
                    `;
          } else {
            alertContainer.innerHTML = "";
          }
        },

        filterSickPlants() {
          this.switchTab("garden");
          document.getElementById("plantSearch").value = "";
          document.getElementById("plantGrid").scrollIntoView();
        },

        getNextDate(scheduleArr, lastDateStr) {
          if (!scheduleArr || scheduleArr.length === 0) return new Date();
          const today = new Date();
          today.setHours(0, 0, 0, 0);
          const currentDay = today.getDay();
          const schedule = scheduleArr.sort((a, b) => a - b);

          if (schedule.includes(currentDay)) {
            const lastAction = new Date(lastDateStr).setHours(0, 0, 0, 0);
            if (lastAction < today.getTime()) {
              return today;
            }
          }
          let nextDay = schedule.find((d) => d > currentDay);
          if (nextDay === undefined) {
            nextDay = schedule[0];
          }
          let daysUntil = (nextDay + 7 - currentDay) % 7;
          if (daysUntil === 0) daysUntil = 7;
          const nextDate = new Date(today);
          nextDate.setDate(today.getDate() + daysUntil);
          return nextDate;
        },

        getNextFlushDate(frequency, lastDateStr, plantedDateStr) {
          if (!frequency || frequency < 1) return null;
          let baseDate;
          if (lastDateStr) {
            baseDate = new Date(lastDateStr);
          } else if (plantedDateStr) {
            baseDate = new Date(plantedDateStr);
          } else {
            baseDate = new Date();
          }
          baseDate.setHours(0, 0, 0, 0);
          const nextDate = new Date(baseDate);
          nextDate.setDate(baseDate.getDate() + parseInt(frequency));
          return nextDate;
        },

        renderDashboard() {
          document.getElementById("totalCount").innerText = this.data.length;
          const today = new Date().setHours(0, 0, 0, 0);
          let actionNeededCount = 0;
          let routineActions = 0;
          let interventionActions = 0;

          this.data.forEach((p) => {
            let isDue = false;
            const nextWater = this.getNextDate(p.waterSchedule, p.lastWater);
            if (nextWater.getTime() <= today) isDue = true;

            // Flush schedule is displayed in Grid but excluded from Bulk Action count
            // to prevent accidental auto-update of maintenance tasks.

            if (isDue) actionNeededCount++;

            p.logs.forEach((l) => {
              if (
                l.type === "siram" ||
                l.type === "pupuk" ||
                l.type === "topup" ||
                l.type === "kuras"
              )
                routineActions++;
              if (l.type === "clinic" && l.action.includes("Sakit"))
                interventionActions++;
            });
          });

          document.getElementById("waterCount").innerText = actionNeededCount;

          const bulkBtn = document.getElementById("bulkWaterBtn");
          if (actionNeededCount > 0) {
            bulkBtn.style.display = "inline-flex";
            bulkBtn.innerHTML = `<i class="fa-solid fa-check-double"></i> Cek ${actionNeededCount} Tanaman`;
          } else {
            bulkBtn.style.display = "none";
          }

          const totalActs = routineActions + interventionActions;
          const score =
            totalActs === 0
              ? 100
              : Math.round((routineActions / totalActs) * 100);
          document.getElementById("careScore").innerText = `${score}%`;

          const typeCounts = {};
          this.data.forEach(
            (p) => (typeCounts[p.type] = (typeCounts[p.type] || 0) + 1)
          );

          if (this.chart) this.chart.destroy();
          this.chart = new Chart(
            document.getElementById("plantChart").getContext("2d"),
            {
              type: "doughnut",
              data: {
                labels: Object.keys(typeCounts),
                datasets: [
                  {
                    data: Object.values(typeCounts),
                    backgroundColor: [
                      "#10b981",
                      "#f59e0b",
                      "#3b82f6",
                      "#ec4899",
                      "#8b5cf6",
                    ],
                    borderWidth: 0,
                  },
                ],
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: "70%",
                plugins: { legend: { position: "right" } },
              },
            }
          );

          const income = this.financeData
            .filter((f) => f.type === "in")
            .reduce((sum, f) => sum + f.amount, 0);
          const expense = this.financeData
            .filter((f) => f.type === "out")
            .reduce((sum, f) => sum + f.amount, 0);
          document.getElementById("dashBalance").innerText = `Rp ${(
            income - expense
          ).toLocaleString()}`;

          if (this.financeChart) this.financeChart.destroy();
          this.financeChart = new Chart(
            document.getElementById("financeChart").getContext("2d"),
            {
              type: "bar",
              data: {
                labels: ["Pemasukan", "Pengeluaran"],
                datasets: [
                  {
                    label: "Rupiah",
                    data: [income, expense],
                    backgroundColor: ["#10b981", "#f43f5e"],
                    borderRadius: 8,
                  },
                ],
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { y: { beginAtZero: true } },
              },
            }
          );

          const months = [
            "Jan",
            "Feb",
            "Mar",
            "Apr",
            "Mei",
            "Jun",
            "Jul",
            "Agu",
            "Sep",
            "Okt",
            "Nov",
            "Des",
          ];
          const activityData = new Array(12).fill(0);
          this.data.forEach((p) => {
            p.logs.forEach((l) => {
              const m = new Date(l.date).getMonth();
              activityData[m]++;
            });
          });

          if (this.growthChart) this.growthChart.destroy();
          this.growthChart = new Chart(
            document.getElementById("growthChart").getContext("2d"),
            {
              type: "line",
              data: {
                labels: months,
                datasets: [
                  {
                    label: "Frekuensi Perawatan",
                    data: activityData,
                    borderColor: "#3b82f6",
                    backgroundColor: "rgba(59, 130, 246, 0.1)",
                    fill: true,
                    tension: 0.4,
                  },
                ],
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: { y: { beginAtZero: true } },
              },
            }
          );
        },

        renderFinance() {
          const list = document.getElementById("transactionList");
          list.innerHTML = "";
          let inc = 0,
            exp = 0;

          const sorted = [...this.financeData].sort(
            (a, b) => new Date(b.date) - new Date(a.date)
          );

          if (sorted.length === 0) {
            list.innerHTML = `<div style="text-align:center; padding:2rem; color:var(--text-muted);">Belum ada transaksi.</div>`;
          } else {
            sorted.forEach((t) => {
              if (t.type === "in") inc += t.amount;
              else exp += t.amount;
              const color =
                t.type === "in" ? "var(--money-in)" : "var(--money-out)";
              const sign = t.type === "in" ? "+" : "-";
              const icon =
                t.type === "in" ? "fa-arrow-trend-up" : "fa-arrow-trend-down";

              list.innerHTML += `
                            <div class="finance-row">
                                <div style="display:flex; align-items:center; gap:12px;">
                                    <div style="width:40px; height:40px; border-radius:50%; background:${
                                      t.type === "in" ? "#ecfdf5" : "#fff1f2"
                                    }; display:grid; place-items:center; color:${color}; font-size:1.1rem;">
                                        <i class="fa-solid ${icon}"></i>
                                    </div>
                                    <div>
                                        <div style="font-weight:600; color:var(--text-main);">${
                                          t.desc
                                        }</div>
                                        <div style="font-size:0.8rem; color:var(--text-muted);">${new Date(
                                          t.date
                                        ).toLocaleDateString("id-ID", {
                                          day: "numeric",
                                          month: "short",
                                          year: "numeric",
                                        })}</div>
                                    </div>
                                </div>
                                <div style="text-align:right;">
                                    <div style="font-weight:700; color:${color}; font-size:1.05rem;">
                                        ${sign} Rp ${t.amount.toLocaleString()}
                                    </div>
                                    <div class="finance-actions" style="justify-content:flex-end; margin-top:4px;">
                                        <button class="btn btn-sm btn-secondary" style="padding:4px 8px;" onclick="app.editFinanceLog(${
                                          t.id
                                        })"><i class="fa-solid fa-pencil"></i></button>
                                        <button class="btn btn-sm btn-danger" style="padding:4px 8px; background:#fee2e2; color:#ef4444; border:none;" onclick="app.deleteFinanceLog(${
                                          t.id
                                        })"><i class="fa-solid fa-trash"></i></button>
                                    </div>
                                </div>
                            </div>
                        `;
            });
          }

          document.getElementById(
            "totalIncome"
          ).innerText = `Rp ${inc.toLocaleString()}`;
          document.getElementById(
            "totalExpense"
          ).innerText = `Rp ${exp.toLocaleString()}`;
          const net = inc - exp;
          const elNet = document.getElementById("netBalance");
          elNet.innerText = `Rp ${net.toLocaleString()}`;
          elNet.style.color = net >= 0 ? "var(--money-in)" : "var(--money-out)";

          const harvestData = {};
          this.data.forEach((p) => {
            let totalYield = 0;
            p.logs.forEach((l) => {
              if (l.type === "harvest" && l.amount) totalYield += l.amount;
            });
            if (totalYield > 0) harvestData[p.name] = totalYield;
          });

          if (this.harvestChart) this.harvestChart.destroy();
          const harvestLabels = Object.keys(harvestData);
          const harvestValues = Object.values(harvestData);

          if (harvestLabels.length > 0) {
            this.harvestChart = new Chart(
              document.getElementById("harvestChart").getContext("2d"),
              {
                type: "bar",
                data: {
                  labels: harvestLabels,
                  datasets: [
                    {
                      label: "Hasil Panen (Kg)",
                      data: harvestValues,
                      backgroundColor: "#f97316",
                      borderRadius: 6,
                    },
                  ],
                },
                options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  indexAxis: "y",
                  scales: { x: { beginAtZero: true } },
                },
              }
            );
          } else {
            this.harvestChart = new Chart(
              document.getElementById("harvestChart").getContext("2d"),
              {
                type: "bar",
                data: {
                  labels: ["Belum Ada Data"],
                  datasets: [{ data: [0], label: "Kosong" }],
                },
                options: { responsive: true, maintainAspectRatio: false },
              }
            );
          }
        },

        editFinanceLog(id) {
          const t = this.financeData.find((x) => x.id === id);
          if (!t) return;
          this.financeEditingId = id;
          document.getElementById("fType").value = t.type;
          document.getElementById("fAmount").value = t.amount;
          document.getElementById("fDesc").value = t.desc;
          document.getElementById("fDate").value = t.date;
          document.querySelector("#financeModal h2").innerText =
            "Edit Transaksi";
          this.openModal("financeModal");
        },

        async deleteFinanceLog(id) {
          if (confirm("Hapus permanen?")) {
            if (!this.user) return;
            const idToDelete = id;
            const uid = this.user.uid;

            // Hapus dari memory lokal
            this.financeData = this.financeData.filter(
              (x) => x.id !== idToDelete
            );

            // Hapus dari Firebase
            try {
              const docRef = window.fbOps.doc(
                window.db,
                "users",
                uid,
                "finance",
                idToDelete.toString()
              );
              await window.fbOps.deleteDoc(docRef);
              this.showToast("Data dihapus dari Cloud");
            } catch (e) {
              console.error("Gagal hapus di cloud", e);
            }

            this.updateUI();
          }
        },

        openFinanceModal() {
          document.getElementById("financeForm").reset();
          document.getElementById("fDate").valueAsDate = new Date();
          this.financeEditingId = null;
          document.querySelector("#financeModal h2").innerText =
            "Catat Transaksi";
          this.openModal("financeModal");
        },

        toggleFinanceCat() {},

        renderGrid() {
          const container = document.getElementById("plantGrid");
          const filter = document.getElementById("plantSearch").value || "";
          const sortMode =
            document.getElementById("sortSelect").value || "urgency";
          container.innerHTML = "";

          const getNextAction = (p) => {
            const nextWater = this.getNextDate(p.waterSchedule, p.lastWater);
            let nextAction = nextWater;
            let type = "water";

            if (p.method === "hydro" && p.flushFrequency) {
              const nextFlush = this.getNextFlushDate(
                p.flushFrequency,
                p.lastFlush,
                p.date
              );
              // Prioritize flush if it's due sooner OR on the same day (<=)
              if (nextFlush && nextFlush <= nextWater) {
                nextAction = nextFlush;
                type = "flush";
              }
            }
            return { date: nextAction, type };
          };

          let filtered = this.data.filter((p) =>
            p.name.toLowerCase().includes(filter.toLowerCase())
          );

          filtered.sort((a, b) => {
            const nextA = getNextAction(a).date.getTime();
            const nextB = getNextAction(b).date.getTime();
            if (sortMode === "urgency") return nextA - nextB;
            if (sortMode === "az") return a.name.localeCompare(b.name);
            if (sortMode === "newest") return b.id - a.id;
            return 0;
          });

          if (filtered.length === 0) {
            container.innerHTML = `<div style="grid-column:1/-1; text-align:center; padding:3rem; opacity:0.5;"><p>Data tidak ditemukan.</p></div>`;
            return;
          }

          filtered.forEach((p) => {
            const today = new Date().setHours(0, 0, 0, 0);
            const actionInfo = getNextAction(p);
            const nextDate = actionInfo.date;
            const actionType = actionInfo.type;

            const diffTime = nextDate.getTime() - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            let statusClass = "";
            let statusText = "";
            let icon = "fa-droplet";
            const isSick = p.healthStatus === "sick";
            const cardClass = isSick ? "plant-card is-sick" : "plant-card";
            const sickBadge = isSick
              ? `<span class="health-badge sick"><i class="fa-solid fa-virus"></i> SAKIT</span>`
              : "";

            if (actionType === "flush") {
              icon = "fa-rotate";
              if (diffDays <= 0) {
                statusClass = "urgent";
                statusText = "Kuras & Nutrisi Hari Ini!";
              } else if (diffDays === 1) {
                statusClass = "today";
                statusText = "Kuras & Nutrisi Besok";
              } else {
                statusText = `Kuras & Nutrisi: ${diffDays} hari lagi`;
              }
            } else {
              if (diffDays <= 0) {
                statusClass = "urgent";
                statusText =
                  p.method === "hydro"
                    ? "Cek Air Hari Ini!"
                    : "Siram Hari Ini!";
                icon = p.method === "hydro" ? "fa-faucet-drip" : "fa-droplet";
                if (diffDays < 0) statusText = "Terlewat: Cek Segera!";
              } else if (diffDays === 1) {
                statusClass = "today";
                statusText =
                  p.method === "hydro" ? "Cek Air Besok" : "Siram Besok";
              } else {
                statusText = `${p.method === "hydro" ? "Cek" : "Siram"}: ${
                  DAYS_MAP[nextDate.getDay()]
                }`;
              }
            }

            const img = p.image || DEFAULT_IMG;

            const isHydro = p.method === "hydro";
            const methodBadge = isHydro
              ? `<span class="badge hydro" style="margin-left:5px;"><i class="fa-solid fa-water"></i> Hydro</span>`
              : "";
            const hydroOverlay = isHydro
              ? '<div style="position:absolute; bottom:5px; right:5px; background:#0ea5e9; color:white; padding:2px 6px; border-radius:4px; font-size:0.7rem;"><i class="fa-solid fa-faucet"></i></div>'
              : "";

            const html = `
                        <div class="${cardClass}" data-id="${p.id}">
                            ${sickBadge}
                            <div class="plant-img-wrapper">
                                <img src="${img}" class="plant-img" loading="lazy">
                                ${hydroOverlay}
                            </div>
                            <div class="card-body">
                                <span class="badge" style="background:var(--primary-light); color:var(--primary)">${p.type}</span>
                                ${methodBadge}
                                <h3 style="font-size:1.1rem; margin-bottom:5px; margin-top:5px; color:var(--text-main)">${p.name}</h3>
                                <div class="status-pill ${statusClass}">
                                    <i class="fa-solid ${icon}"></i>
                                    ${statusText}
                                </div>
                                <div style="margin-top:8px;">
                                    <button class="btn btn-danger btn-sm" style="width:100%;" onclick="event.stopPropagation(); app.deletePlantById(${p.id})">
                                        <i class="fa-solid fa-trash"></i> Hapus
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
            container.innerHTML += html;
          });
        },

        toggleDay(el, type) {
          if (type === "fert") {
            el.classList.toggle("fert-active");
          } else if (type === "flush") {
            el.classList.toggle("flush-active");
          } else {
            el.classList.toggle("active");
          }
        },

        getSelectedDays(containerId, activeClass) {
          const container = document.getElementById(containerId);
          const actives = container.querySelectorAll(`.${activeClass}`);
          return Array.from(actives).map((el) =>
            parseInt(el.getAttribute("data-day"))
          );
        },

        setDays(daysArray, containerId, activeClass) {
          const container = document.getElementById(containerId);
          container
            .querySelectorAll(".day-check")
            .forEach((el) => el.classList.remove(activeClass));
          if (daysArray) {
            daysArray.forEach((d) => {
              const el = container.querySelector(`.day-check[data-day="${d}"]`);
              if (el) el.classList.add(activeClass);
            });
          }
        },

        openDetail(id) {
          const p = this.data.find((x) => String(x.id) === String(id));
          if (!p) return;
          this.currentId = p.id;
          const isHydro = p.method === "hydro";

          document.getElementById("dName").innerText = p.name;
          document.getElementById("dType").innerText = p.type;
          document.getElementById("dImage").src = p.image || DEFAULT_IMG;

          const healthBadge = document.getElementById("dHealthStatus");
          if (p.healthStatus === "sick") {
            healthBadge.innerText = "SAKIT / KARANTINA";
            healthBadge.style.background = "var(--danger)";
          } else {
            healthBadge.innerText = "SEHAT";
            healthBadge.style.background = "var(--primary)";
          }

          // --- DYNAMIC LABELS ---
          const waterNames = (p.waterSchedule || [])
            .sort()
            .map((d) => DAYS_MAP[d])
            .join(", ");
          const waterLabel = isHydro ? "Jadwal Cek Air" : "Jadwal Siram";
          document.getElementById(
            "dScheduleInfo"
          ).innerText = `${waterLabel}: ${waterNames}`;

          if (isHydro) {
            const freq = p.flushFrequency || "-";
            document.getElementById(
              "dFertInfo"
            ).innerText = `Jadwal Kuras & Nutrisi: Setiap ${freq} hari`;
          } else {
            const fertNames = (p.fertSchedule || [])
              .sort()
              .map((d) => DAYS_MAP[d])
              .join(", ");
            document.getElementById(
              "dFertInfo"
            ).innerText = `Jadwal Pupuk: ${fertNames}`;
          }

          // --- DYNAMIC BUTTONS ---
          const btnContainer = document.getElementById("actionBtnContainer");

          let mainActionBtn = "";
          let secActionBtn = "";

          if (isHydro) {
            mainActionBtn = `
                        <button class="btn btn-primary btn-sm" style="flex-direction:column; padding:0.6rem; font-size:0.75rem; background:#0ea5e9;" onclick="app.handleAction('topup')">
                            <i class="fa-solid fa-faucet-drip" style="font-size:1.2rem;"></i> Top-up Air
                        </button>`;
            secActionBtn = `
                         <button class="btn btn-secondary btn-sm" style="flex-direction:column; padding:0.6rem; font-size:0.75rem; color:#0369a1; border-color:#0369a1;" onclick="app.handleAction('kuras')">
                            <i class="fa-solid fa-rotate" style="font-size:1.2rem;"></i> Kuras & Nutrisi
                        </button>`;
          } else {
            mainActionBtn = `
                        <button class="btn btn-primary btn-sm" style="flex-direction:column; padding:0.6rem; font-size:0.75rem;" onclick="app.handleAction('siram')">
                            <i class="fa-solid fa-droplet" style="font-size:1.2rem;"></i> Siram
                        </button>`;
            secActionBtn = `
                        <button class="btn btn-secondary btn-sm" style="flex-direction:column; padding:0.6rem; font-size:0.75rem;" onclick="app.handleAction('pupuk')">
                            <i class="fa-solid fa-flask" style="font-size:1.2rem;"></i> Pupuk
                        </button>`;
          }

          btnContainer.innerHTML = `
                    ${mainActionBtn}
                    ${secActionBtn}
                    <button class="btn btn-secondary btn-sm" style="flex-direction:column; padding:0.6rem; font-size:0.75rem; border-color:#f97316; color:#f97316;" onclick="app.logHarvest()">
                        <i class="fa-solid fa-basket-shopping" style="font-size:1.2rem;"></i> Panen
                    </button>
                    <button class="btn btn-secondary btn-sm" style="flex-direction:column; padding:0.6rem; font-size:0.75rem; border-color:var(--danger); color:var(--danger);" onclick="app.openClinicForm()">
                        <i class="fa-solid fa-suitcase-medical" style="font-size:1.2rem;"></i> Klinik
                    </button>
                    <button class="btn btn-secondary btn-sm" style="flex-direction:column; padding:0.6rem; font-size:0.75rem; border-color:#0ea5e9; color:#0ea5e9;" onclick="app.openSensorModal()">
                        <i class="fa-solid fa-microchip" style="font-size:1.2rem;"></i> Sensor
                    </button>
                    <button class="btn btn-secondary btn-sm" style="flex-direction:column; padding:0.6rem; font-size:0.75rem; border-color:#10b981; color:#10b981;" onclick="app.showQR()">
                        <i class="fa-solid fa-id-card" style="font-size:1.2rem;"></i> ID
                    </button>
                `;

          this.renderTimeline(p);
          this.openModal("detailModal");
        },

        openFormModal() {
          document.getElementById("formTitle").innerText = "Tambah Tanaman";
          document.getElementById("plantForm").reset();
          document.getElementById("pId").value = "";
          this.editingId = null;
          document.getElementById("imgPreviewBox").style.display = "none";

          app.setMethod("soil"); // Default
          this.setDays([], "waterDayContainer", "active");
          this.setDays([], "fertDayContainer", "fert-active");
          // this.setDays([], 'flushDayContainer', 'flush-active'); // Removed as we use frequency now
          document.getElementById("hydroFlushFreq").value = "";

          this.openModal("formModal");
        },

        openEditForm() {
          const p = this.data.find((x) => x.id === this.currentId);
          if (!p) return;
          this.editingId = p.id;
          document.getElementById("formTitle").innerText = "Edit Tanaman";
          document.getElementById("pId").value = p.id;
          document.getElementById("pName").value = p.name;
          document.getElementById("pType").value = p.type;
          document.getElementById("pDate").value = p.date;

          // Load Method
          const method = p.method || "soil";
          app.setMethod(method);

          this.setDays(p.waterSchedule || [], "waterDayContainer", "active");
          this.setDays(p.fertSchedule || [], "fertDayContainer", "fert-active");
          // this.setDays(p.flushSchedule || [], 'flushDayContainer', 'flush-active');
          document.getElementById("hydroFlushFreq").value =
            p.flushFrequency || "";

          if (p.image) {
            document.getElementById("imgPreviewBox").style.display = "block";
            document.getElementById("imgPreviewTag").src = p.image;
          } else {
            document.getElementById("imgPreviewBox").style.display = "none";
          }
          const rm = document.getElementById("pImageRemove");
          if (rm) rm.checked = false;
          this.closeModal("detailModal");
          this.openModal("formModal");
        },

        generateGrowthTimeline(p) {
          const resolved = this.resolveIdealRange(p);
          const hss = resolved.hss;
          const key = this.resolveOptimalKey(p);
          const entry =
            OPTIMAL_CONDITIONS[key] ||
            OPTIMAL_CONDITIONS["Default"] ||
            DEFAULT_CONDITIONS;

          const phases = this.parsePhases(entry);
          if (!phases || phases.length === 0) return "";

          let html = `<div class="growth-timeline-container">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                 <h4 style="font-size:0.85rem; opacity:0.8; margin:0; font-weight:700;">TIMELINE PERTUMBUHAN</h4>
                 <span style="font-size:0.75rem; font-weight:700; color:var(--primary); background:var(--primary-light); padding:2px 8px; border-radius:10px;">HSS: ${hss} Hari</span>
            </div>
            <div class="growth-timeline">`;

          phases.forEach((phase, index) => {
            let status = "";
            let icon = "fa-circle";

            // Determine status
            if (hss > phase.end) {
              status = "completed";
              icon = "fa-check";
            } else if (hss >= phase.start && hss <= phase.end) {
              status = "active";
              icon = "fa-seedling";
              if (phase.name && phase.name.toLowerCase().includes("panen"))
                icon = "fa-basket-shopping";
              if (phase.name && phase.name.toLowerCase().includes("bunga"))
                icon = "fa-fan";
            } else if (hss >= phase.start && phase.end > 1000) {
              // Open ended active
              status = "active";
              icon = "fa-repeat";
            } else {
              status = ""; // future
              icon = "fa-circle-dot";
            }

            const durationLabel =
              phase.end > 1000 ? "∞" : `${phase.start}-${phase.end}`;

            html += `
                <div class="growth-step ${status}">
                    <div class="step-icon"><i class="fa-solid ${icon}"></i></div>
                    <div class="step-label">${
                      phase.name || "Fase " + (index + 1)
                    }</div>
                    <div class="step-days">${durationLabel} Hari</div>
                </div>
              `;
          });

          html += `</div></div>`;
          return html;
        },

        renderTimeline(p) {
          const tl = document.getElementById("dTimeline");
          tl.innerHTML = "";

          // --- ADD GROWTH TIMELINE ---
          tl.innerHTML += this.generateGrowthTimeline(p);

          const resolved = this.resolveIdealRange(p);
          const range =
            resolved.range ||
            OPTIMAL_CONDITIONS["Default"] ||
            DEFAULT_CONDITIONS;
          const isHydro = p.method === "hydro";

          let idealHtml = `<div style="background:rgba(255,255,255,0.5); padding:10px; border-radius:8px; margin-bottom:1rem;">
                    <h4 style="font-size:0.85rem; margin-bottom:5px; opacity:0.8;">PARAMETER IDEAL:</h4>`;

          if (isHydro) {
            idealHtml += `
                        <div class="health-parameter-row">
                            <span>Nutrisi (EC)</span><span>${range.ec[0]}–${range.ec[1]} μS</span>
                        </div>
                        <div class="health-parameter-row">
                            <span>pH Air</span><span>${range.ph[0]}–${range.ph[1]}</span>
                        </div>
                        <div class="health-parameter-row">
                            <span>Suhu Air</span><span>18–28 °C</span>
                        </div>`;
          } else {
            idealHtml += `
                        <div class="health-parameter-row">
                            <span>Kelembaban</span><span>${range.moisture[0]}–${range.moisture[1]} %</span>
                        </div>
                        <div class="health-parameter-row">
                            <span>pH Tanah</span><span>${range.ph[0]}–${range.ph[1]}</span>
                        </div>
                        <div class="health-parameter-row">
                            <span>Nutrisi (EC)</span><span>${range.ec[0]}–${range.ec[1]} μS</span>
                        </div>`;
          }

          idealHtml += `
                    <div class="health-parameter-row">
                        <span>Suhu Udara</span><span>${range.temp[0]}–${range.temp[1]} °C</span>
                    </div>
                    <div class="health-parameter-row">
                        <span>Cahaya</span><span>${range.lux[0]}–${range.lux[1]} Lux</span>
                    </div>
                    <div class="health-parameter-row">
                        <span>Kelembaban Udara</span><span>${range.hum[0]}–${range.hum[1]} %</span>
                    </div>
                </div>`;

          tl.innerHTML += idealHtml;

          const sortedLogs = (Array.isArray(p.logs) ? [...p.logs] : []).sort(
            (a, b) => new Date(b.date) - new Date(a.date)
          );

          sortedLogs.forEach((l) => {
            const dateObj = new Date(l.date);
            const d = dateObj.toLocaleDateString("id-ID", {
              day: "numeric",
              month: "short",
            });
            const t = dateObj.toLocaleTimeString("id-ID", {
              hour: "2-digit",
              minute: "2-digit",
            });

            let icon = "fa-seedling";
            let color = "var(--primary)";
            if (l.type === "siram") {
              icon = "fa-droplet";
              color = "#3b82f6";
            } else if (l.type === "pupuk") {
              icon = "fa-flask";
              color = "#f59e0b";
            } else if (l.type === "topup") {
              icon = "fa-faucet-drip";
              color = "#0ea5e9";
            } else if (l.type === "kuras") {
              icon = "fa-rotate";
              color = "#0284c7";
            } else if (l.type === "harvest") {
              icon = "fa-basket-shopping";
              color = "#f97316";
            } else if (l.type === "clinic" && l.sensorData) {
              icon = "fa-microchip";
              color = "#0ea5e9";
            } else if (l.type === "clinic") {
              icon = "fa-suitcase-medical";
              color = "#ef4444";
            }

            let content = "";
            if (l.sensorData) {
              const s = l.sensorData;
              const parts = [];
              if (s.moisture) parts.push(`Moist: ${s.moisture}%`);
              if (s.ph) parts.push(`pH: ${s.ph}`);
              if (s.ec) parts.push(`EC: ${s.ec}`);
              if (s.tempWater) parts.push(`Water: ${s.tempWater}°C`);
              if (s.temp) parts.push(`Air: ${s.temp}°C`);
              if (s.hum) parts.push(`Hum: ${s.hum}%`);
              if (s.lux) parts.push(`Lux: ${s.lux}`);
              content = `<div style="font-size:0.8rem; color:var(--text-muted); margin-top:2px; font-family:monospace;">${parts.join(
                " | "
              )}</div>`;
            } else {
              content = l.desc
                ? `<div style="font-size:0.8rem; color:var(--text-muted); margin-top:2px;">${l.desc}</div>`
                : "";
            }

            let statusBadge = "";
            if (
              l.status &&
              (l.status === "Warning" || l.status === "Critical") &&
              l.issues &&
              l.issues.length > 0
            ) {
              const badgeColor =
                l.status === "Critical" ? "#ef4444" : "#f59e0b";
              const badgeText =
                l.status === "Critical" ? "SAKIT" : "PERLU TINDAKAN";
              const issuesJson = encodeURIComponent(JSON.stringify(l.issues));
              statusBadge = `<div style="margin-top:8px;">
                            <button onclick="app.showInstruction('${issuesJson}')" style="background:${badgeColor}; color:white; border:none; border-radius:6px; padding:6px 12px; font-size:0.8rem; font-weight:600; cursor:pointer; display:inline-flex; align-items:center; gap:6px; box-shadow:0 2px 4px rgba(0,0,0,0.1);">
                                <i class="fa-solid fa-circle-exclamation"></i> ${badgeText} (Klik untuk Instruksi)
                            </button>
                        </div>`;
            }

            tl.innerHTML += `
                        <div style="display:flex; gap:15px; margin-bottom:15px; align-items:start;">
                            <div style="min-width:60px; text-align:right; padding-top:2px;">
                                <div style="font-size:0.85rem; font-weight:700; color:var(--text-main);">${d}</div>
                                <div style="font-size:0.75rem; color:var(--text-muted);">${t}</div>
                            </div>
                            <div style="flex:1; border-left: 2px solid ${color}; padding-left:12px;">
                                <div style="font-weight:600; font-size:0.95rem; color:${color}">
                                    <i class="fa-solid ${icon}" style="margin-right:5px;"></i> ${l.action}
                                </div>
                                ${content}
                                ${statusBadge}
                                <div style="margin-top:8px; display:flex; gap:8px;">
                                  <button class="btn btn-sm btn-danger" style="padding:4px 8px; background:#fee2e2; color:#ef4444; border:none;" onclick="app.deleteActivityLog('${l.date}')">
                                    <i class="fa-solid fa-trash"></i> Hapus
                                  </button>
                                </div>
                            </div>
                        </div>
                    `;
          });
        },

        deleteActivityLog(dateStr) {
          const idx = this.data.findIndex((p) => p.id === this.currentId);
          if (idx < 0) return;
          if (!confirm("Hapus catatan aktivitas ini?")) return;
          const before = this.data[idx].logs.length;
          this.data[idx].logs = (this.data[idx].logs || []).filter(
            (x) => x.date !== dateStr
          );
          const after = this.data[idx].logs.length;
          if (after < before) {
            this.savePlant(this.data[idx]);
            this.renderTimeline(this.data[idx]);
            this.showToast("Aktivitas dihapus.");
            this.renderDashboard?.();
            this.renderGrid?.();
          }
        },

        async handleAction(type) {
          const idx = this.data.findIndex((p) => p.id === this.currentId);
          const now = new Date();
          let actionText = "";

          if (type === "siram") {
            this.data[idx].lastWater = now.toISOString();
            actionText = "Disiram";
          } else if (type === "pupuk") {
            this.data[idx].lastFert = now.toISOString();
            actionText = "Diberi Pupuk";
          } else if (type === "topup") {
            this.data[idx].lastWater = now.toISOString();
            actionText = "Top-up Nutrisi & Air";
          } else if (type === "kuras") {
            this.data[idx].lastFlush = now.toISOString();
            this.data[idx].lastWater = now.toISOString(); // Kuras implies refilling water
            actionText = "Kuras & Ganti Nutrisi";
          }

          this.data[idx].logs.push({
            date: now.toISOString(),
            type,
            action: actionText,
          });

          await this.savePlant(this.data[idx]);
          this.renderTimeline(this.data[idx]);
          this.showToast(`${actionText} berhasil!`);
          this.renderDashboard();
        },

        logHarvest() {
          const amount = prompt("Berapa kg hasil panen?");
          if (amount) {
            const idx = this.data.findIndex((p) => p.id === this.currentId);
            this.data[idx].logs.push({
              date: new Date().toISOString(),
              type: "harvest",
              action: `Panen ${amount}kg`,
              amount: parseFloat(amount),
            });

            if (confirm("Catat panen ini sebagai Pemasukan di Keuangan?")) {
              this.openFinanceModal();
              document.getElementById("fType").value = "in";
              document.getElementById(
                "fDesc"
              ).value = `Jual Panen ${this.data[idx].name} ${amount}kg`;
            }

            this.savePlant(this.data[idx]);
            this.renderTimeline(this.data[idx]);
            this.showToast("Panen tercatat!");
          }
        },

        openClinicForm() {
          const p = this.data.find((x) => x.id === this.currentId);
          if (!p) return;
          document.getElementById("cStatus").value =
            p.healthStatus || "healthy";
          document.getElementById("cIssue").value = "";
          document.getElementById("cSolution").value = "";
          document.getElementById("cSeverity").value = "";
          document.getElementById("cSuggestion").style.display = "none";

          const dl = document.getElementById("issueList");
          if (dl)
            dl.innerHTML = Object.keys(CLINIC_KNOWLEDGE)
              .map((k) => `<option value="${k}">`)
              .join("");

          this.checkClinicStatus();
          this.openModal("clinicModal");
        },

        checkClinicStatus() {
          const status = document.getElementById("cStatus").value;
          const sev = document.getElementById("cSeverity");
          if (status === "sick") {
            sev.disabled = false;
          } else {
            sev.disabled = true;
            sev.value = "";
          }
        },

        showQR() {
          const p = this.data.find((x) => x.id === this.currentId);
          if (!p) return;
          let baseUrl = "https://smartgrowa.github.io/index.html";
          try {
            const origin = window.location.origin || "";
            const path = window.location.pathname || "/index.html";
            const isLocal =
              !origin ||
              origin.indexOf("localhost") > -1 ||
              origin.indexOf("127.0.0.1") > -1 ||
              origin.indexOf("file://") === 0;
            if (!isLocal) baseUrl = `${origin}${path}`;
          } catch (_) {}
          const url = `${baseUrl}?plantId=${encodeURIComponent(p.id)}`;
          const img = document.getElementById("qrImage");
          const nameEl = document.getElementById("qrName");
          const typeEl = document.getElementById("qrType");
          const idEl = document.getElementById("qrId");
          const data = encodeURIComponent(url);
          const prov = [
            `https://quickchart.io/qr?text=${data}&size=150`,
            `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${data}`,
            `https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl=${data}&choe=UTF-8`,
            `https://goqr.me/api/img?size=150x150&data=${data}`,
          ];
          if (img) {
            img.crossOrigin = "anonymous";
            img.referrerPolicy = "no-referrer";
            let i = 0;
            const tryNext = () => {
              if (i >= prov.length) return;
              img.onerror = () => {
                i++;
                tryNext();
              };
              img.src = prov[i];
            };
            tryNext();
          }
          if (nameEl) nameEl.innerText = p.name || "-";
          if (typeEl) typeEl.innerText = p.type || "-";
          if (idEl) idEl.innerText = p.id;
          this.openModal("qrModal");
        },

        checkClinicSuggestion() {
          const val = document.getElementById("cIssue").value;
          const box = document.getElementById("cSuggestion");
          const txt = document.getElementById("cSuggestionText");
          const key = Object.keys(CLINIC_KNOWLEDGE).find(
            (k) => k.toLowerCase() === val.toLowerCase()
          );
          if (key) {
            txt.innerText = CLINIC_KNOWLEDGE[key];
            box.style.display = "block";
          } else {
            box.style.display = "none";
          }
        },

        saveClinicLog() {
          const status = document.getElementById("cStatus").value;
          const issue = document.getElementById("cIssue").value;
          const solution = document.getElementById("cSolution").value;
          const severity = document.getElementById("cSeverity").value;

          if (!issue && status === "sick") {
            alert("Mohon isi masalah/penyakitnya.");
            return;
          }

          const idx = this.data.findIndex((p) => p.id === this.currentId);
          const prevStatus = this.data[idx].healthStatus;
          this.data[idx].healthStatus = status;

          let actionText = "Laporan Klinik";
          let descText = "";

          if (status === "sick") {
            const sevText = severity ? `[${severity}]` : "";
            actionText = `Sakit: ${issue} ${sevText}`;
            descText = `Solusi: ${solution || "-"}`;
          } else if (prevStatus === "sick" && status === "healthy") {
            actionText = "Tanaman Sembuh";
            descText = `Catatan: ${solution || "Kondisi membaik"}`;
          } else {
            actionText = `Cek Kesehatan: ${issue || "Rutin"}`;
            descText = `Tindakan: ${solution || "-"}`;
          }

          this.data[idx].logs.push({
            date: new Date().toISOString(),
            type: "clinic",
            action: actionText,
            desc: descText,
          });

          this.savePlant(this.data[idx]);
          this.closeModal("clinicModal");

          const healthBadge = document.getElementById("dHealthStatus");
          if (healthBadge) {
            if (status === "sick") {
              healthBadge.innerText = "SAKIT / KARANTINA";
              healthBadge.style.background = "var(--danger)";
            } else {
              healthBadge.innerText = "SEHAT";
              healthBadge.style.background = "var(--primary)";
            }
          }

          this.renderTimeline(this.data[idx]);
          this.renderGrid();
          this.showToast("Data klinik disimpan!");
        },

        async deletePlant() {
          if (confirm("Hapus permanen?")) {
            if (!this.user) return;
            const idToDelete = this.currentId;
            const uid = this.user.uid;

            // Hapus dari memory
            this.data = this.data.filter((p) => p.id !== idToDelete);

            // Hapus dari Firebase (Path user)
            try {
              const docRef = window.fbOps.doc(
                window.db,
                "users",
                uid,
                "plants",
                idToDelete.toString()
              );
              await window.fbOps.deleteDoc(docRef);
              this.showToast("Data dihapus dari Cloud");
            } catch (e) {
              console.error(e);
            }

            this.closeModal("detailModal");
            this.updateUI(); // Tidak perlu panggil save() lagi karena deleteDoc sudah menghapus di cloud
          }
        },

        deletePlantById(id) {
          this.currentId = id;
          this.deletePlant();
        },

        // --- HELPER: Resolve Plant Name ---
        getPlantKey(name) {
          if (!name) return null;
          const lower = name.toLowerCase();
          // 1. Cek Exact/Partial Match di Keys (Latin)
          let foundKey = Object.keys(PLANT_KNOWLEDGE).find((k) =>
            lower.includes(k.toLowerCase())
          );
          if (foundKey) return foundKey;

          // 2. Cek Match di name_id (Indonesia) atau aliases
          foundKey = Object.keys(PLANT_KNOWLEDGE).find((k) => {
            const entry = PLANT_KNOWLEDGE[k];
            const idMatch =
              entry.name_id && lower.includes(entry.name_id.toLowerCase());
            const aliasMatch =
              entry.aliases &&
              entry.aliases.some((a) => lower.includes(a.toLowerCase()));
            return idMatch || aliasMatch;
          });
          return foundKey;
        },

        computeHSS(dateStr, p) {
          try {
            const start = new Date(dateStr).setHours(0, 0, 0, 0);
            const today = new Date().setHours(0, 0, 0, 0);
            const diff = Math.floor((today - start) / (1000 * 60 * 60 * 24));
            const hasHarvest =
              p &&
              Array.isArray(p.logs) &&
              p.logs.some((l) => l.type === "harvest");
            return hasHarvest ? diff : Math.max(0, diff);
          } catch (_) {
            return 0;
          }
        },

        parsePhases(entry) {
          if (!entry) return null;
          const phases = entry.phases;
          if (!phases) return null;
          if (Array.isArray(phases)) {
            return phases
              .map((ph) => {
                const start =
                  ph.start_hss ?? ph.start ?? ph.from ?? ph.hss_start ?? 0;
                const end = ph.end_hss ?? ph.end ?? ph.to ?? ph.hss_end ?? 0;
                const range = ph.range ?? ph.params ?? ph.conditions ?? ph;
                const name = ph.name ?? ph.label ?? null;
                return { start, end, range, name };
              })
              .filter((x) => x.range && typeof x.start === "number");
          }
          if (typeof phases === "object") {
            const out = [];
            Object.keys(phases).forEach((k) => {
              const m = k.match(/(\d+)\s*-\s*(\d+)/);
              if (m) {
                out.push({
                  start: parseInt(m[1], 10),
                  end: parseInt(m[2], 10),
                  range: phases[k],
                  name: phases[k].name || null,
                });
              } else if (k.toLowerCase().includes("panen")) {
                out.push({
                  start: Number.MAX_SAFE_INTEGER,
                  end: Number.MAX_SAFE_INTEGER,
                  range: phases[k],
                  name: phases[k].name || "Panen",
                });
              }
            });
            return out;
          }
          return null;
        },

        resolveOptimalKey(p) {
          const nameKey = this.getPlantKey(p.name);
          const key =
            nameKey && OPTIMAL_CONDITIONS[nameKey]
              ? nameKey
              : p.type || "Default";
          return key;
        },

        resolveIdealRange(p) {
          const key = this.resolveOptimalKey(p);
          const entry =
            OPTIMAL_CONDITIONS[key] ||
            OPTIMAL_CONDITIONS["Default"] ||
            DEFAULT_CONDITIONS;
          const hss = this.computeHSS(p.date, p);
          const phases = this.parsePhases(entry);
          let phaseLabel = null;
          if (phases && phases.length > 0) {
            const match =
              phases.find((ph) => hss >= ph.start && hss <= ph.end) ||
              phases.find(
                (ph) =>
                  ph.start === Number.MAX_SAFE_INTEGER &&
                  ph.end === Number.MAX_SAFE_INTEGER
              );
            if (match && match.range) {
              const base = entry;
              const r = {
                moisture: match.range.moisture ?? base.moisture,
                ph: match.range.ph ?? base.ph,
                ec: match.range.ec ?? base.ec,
                temp: match.range.temp ?? base.temp,
                lux: match.range.lux ?? base.lux,
                hum: match.range.hum ?? base.hum,
              };
              phaseLabel = match.name || `${match.start}-${match.end} HSS`;
              return { range: r, phaseLabel, hss };
            }
          }
          const harvested =
            Array.isArray(p.logs) && p.logs.some((l) => l.type === "harvest");
          return {
            range: entry,
            phaseLabel: harvested ? "Panen" : null,
            hss,
          };
        },

        checkPresets(val) {
          if (this.editingId) return;
          const hint = document.getElementById("presetHint");
          const matchKey = this.getPlantKey(val);

          if (matchKey) {
            this.activePreset = PLANT_KNOWLEDGE[matchKey];
            const displayName = this.activePreset.name_id
              ? `${this.activePreset.name_id} (${matchKey})`
              : matchKey;
            hint.innerHTML = `<i class="fa-solid fa-wand-magic-sparkles"></i> Jadwal otomatis: <b>${displayName}</b>. Klik untuk isi.`;
            hint.style.display = "flex";
          } else {
            hint.style.display = "none";
            this.activePreset = null;
          }
        },

        applyPreset() {
          if (this.activePreset) {
            // Cari Key Latin dari PLANT_KNOWLEDGE
            const latinKey = Object.keys(PLANT_KNOWLEDGE).find(
              (key) => PLANT_KNOWLEDGE[key] === this.activePreset
            );

            if (latinKey) {
              const displayName = this.activePreset.name_id
                ? `${latinKey} (${this.activePreset.name_id})`
                : latinKey;
              document.getElementById("pName").value = displayName;
            }

            document.getElementById("pType").value = this.activePreset.type;
            this.setDays(
              this.activePreset.schedule,
              "waterDayContainer",
              "active"
            );
            this.setDays(
              this.activePreset.fert,
              "fertDayContainer",
              "fert-active"
            );
            document.getElementById("presetHint").style.display = "none";
            this.showToast("Jadwal otomatis terisi!");
          }
        },

        async getAutoImage(name) {
          const matchKey = this.getPlantKey(name);
          const fromWiki = await this.resolveWikipediaImage(name, matchKey);
          if (fromWiki) return fromWiki;
          if (
            matchKey &&
            PLANT_KNOWLEDGE[matchKey] &&
            PLANT_KNOWLEDGE[matchKey].img
          )
            return PLANT_KNOWLEDGE[matchKey].img;
          return DEFAULT_IMG;
        },

        normalizeTitle(str) {
          if (!str) return "";
          const base = str.split("(")[0].trim();
          return base
            .replace(/\s+/g, " ")
            .split(" ")
            .map((w) => w.charAt(0).toUpperCase() + w.slice(1).toLowerCase())
            .join(" ");
        },

        async fetchWikiThumb(title, lang) {
          try {
            const t = encodeURIComponent(title.replace(/\s+/g, "_"));
            const rest = await fetch(
              `https://${lang}.wikipedia.org/api/rest_v1/page/summary/${t}`
            );
            if (rest.ok) {
              const data = await rest.json();
              if (data && data.thumbnail && data.thumbnail.url)
                return data.thumbnail.url;
            }
          } catch (e) {}
          try {
            const api = await fetch(
              `https://${lang}.wikipedia.org/w/api.php?action=query&prop=pageimages&titles=${encodeURIComponent(
                title
              )}&pithumbsize=600&format=json&origin=*`
            );
            if (api.ok) {
              const j = await api.json();
              const pages =
                j && j.query && j.query.pages ? j.query.pages : null;
              if (pages) {
                const first = Object.values(pages)[0];
                if (first && first.thumbnail && first.thumbnail.source)
                  return first.thumbnail.source;
              }
            }
          } catch (e) {}
          return null;
        },

        async resolveWikipediaImage(name, matchKey) {
          const candidates = [];
          const normName = this.normalizeTitle(name);
          if (matchKey) candidates.push(matchKey);
          if (normName) candidates.push(normName);
          if (matchKey && PLANT_KNOWLEDGE[matchKey]) {
            const entry = PLANT_KNOWLEDGE[matchKey];
            if (entry.name_id)
              candidates.push(this.normalizeTitle(entry.name_id));
            if (entry.aliases && Array.isArray(entry.aliases)) {
              entry.aliases.forEach((a) =>
                candidates.push(this.normalizeTitle(a))
              );
            }
          }
          const uniq = Array.from(new Set(candidates.filter(Boolean)));
          for (let i = 0; i < uniq.length; i++) {
            const key = uniq[i];
            if (this.wikiCache[key]) return this.wikiCache[key];
            let url = await this.fetchWikiThumb(key, "en");
            if (!url) url = await this.fetchWikiThumb(key, "id");
            if (url) {
              this.wikiCache[key] = url;
              return url;
            }
          }
          return null;
        },

        fetchWeather() {
          if ("geolocation" in navigator) {
            navigator.geolocation.getCurrentPosition(async (position) => {
              const lat = position.coords.latitude;
              const lon = position.coords.longitude;
              try {
                const res = await fetch(
                  `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&forecast_days=1`
                );
                const data = await res.json();
                const temp = Math.round(data.current_weather.temperature);
                const code = data.current_weather.weathercode;
                document.getElementById("weatherTemp").innerText = `${temp}°C`;
                let desc = "Cerah";
                let icon = "fa-sun";
                let isRain = false;
                if (code >= 1 && code <= 3) {
                  desc = "Berawan";
                  icon = "fa-cloud";
                }
                if (code >= 51) {
                  desc = "Hujan";
                  icon = "fa-cloud-showers-heavy";
                  isRain = true;
                }
                document.getElementById(
                  "weatherDesc"
                ).innerText = `${desc} • Lokasi Terdeteksi`;
                document.querySelector(
                  ".weather-icon i"
                ).className = `fa-solid ${icon}`;
                document.getElementById("rainDelayBtn").style.display = isRain
                  ? "inline-flex"
                  : "none";
              } catch (err) {}
            });
          }
        },

        applyRainDelay() {
          if (
            confirm(
              "Tandai semua jadwal SIRAM hari ini sebagai 'Sudah Disiram' karena hujan?"
            )
          ) {
            const today = new Date().setHours(0, 0, 0, 0);
            let plantsToUpdate = [];
            this.data.forEach((p) => {
              const nextDate = this.getNextDate(p.waterSchedule, p.lastWater);
              if (nextDate.getTime() <= today) {
                p.lastWater = new Date().toISOString();
                p.logs.push({
                  date: new Date().toISOString(),
                  type: "siram",
                  action: "Dilewati (Hujan)",
                });
                plantsToUpdate.push(p);
              }
            });
            this.batchUpdatePlants(plantsToUpdate);
            this.updateUI();
            this.showToast(`${plantsToUpdate.length} tanaman diperbarui.`);
          }
        },

        requestNotification() {
          if (
            "Notification" in window &&
            Notification.permission !== "denied" &&
            Notification.permission !== "granted"
          ) {
            Notification.requestPermission();
          }
        },

        checkReminders() {
          if (Notification.permission !== "granted") return;
          const today = new Date().setHours(0, 0, 0, 0);
          const plantsToNotify = this.data.filter((p) => {
            const nextWater = this.getNextDate(p.waterSchedule, p.lastWater);
            if (nextWater.getTime() <= today) return true;

            if (p.method === "hydro" && p.flushFrequency) {
              const nextFlush = this.getNextFlushDate(
                p.flushFrequency,
                p.lastFlush,
                p.date
              );
              if (nextFlush && nextFlush.getTime() <= today) return true;
            }
            return false;
          });
          if (plantsToNotify.length > 0) {
            new Notification("SmartGarden Reminder", {
              body: `Ada ${plantsToNotify.length} tanaman perlu perawatan hari ini!`,
              icon: "https://cdn-icons-png.flaticon.com/512/628/628283.png",
            });
          }
        },

        exportData() {
          const dataStr =
            "data:text/json;charset=utf-8," +
            encodeURIComponent(
              JSON.stringify({ plants: this.data, finance: this.financeData })
            );
          const a = document.createElement("a");
          a.href = dataStr;
          a.download = `smartgarden_backup_${new Date()
            .toISOString()
            .slice(0, 10)}.json`;
          a.click();
        },

        exportCSV() {
          let csv =
            "Nama Tanaman,Tipe,Metode,Jadwal Siram,Jadwal Pupuk,Kesehatan,Tgl Aktivitas,Jam,Jenis Aktivitas,Keterangan\n";
          this.data.forEach((p) => {
            const wSched = p.waterSchedule.map((d) => DAYS_MAP[d]).join("/");
            const fSched = (p.fertSchedule || [])
              .map((d) => DAYS_MAP[d])
              .join("/");
            const hStat = p.healthStatus === "sick" ? "Sakit" : "Sehat";
            p.logs.forEach((l) => {
              const dObj = new Date(l.date);
              const action = (l.action || "").replace(/"/g, '""');
              const desc = (l.desc || "").replace(/"/g, '""');
              csv += `"${p.name}","${p.type}","${
                p.method || "soil"
              }","${wSched}","${fSched}","${hStat}","${dObj.toLocaleDateString()}","${dObj.toLocaleTimeString()}","${
                l.type
              }","${action} ${desc}"\n`;
            });
          });
          const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
          const a = document.createElement("a");
          a.href = URL.createObjectURL(blob);
          a.download = `smartgarden_report.csv`;
          a.click();
        },

        importData(input) {
          const file = input.files[0];
          if (!file) return;
          const reader = new FileReader();
          reader.onload = async (e) => {
            try {
              const parsed = JSON.parse(e.target.result);
              if (parsed.plants) {
                this.data = parsed.plants;
                this.financeData = parsed.finance || [];
              } else {
                this.data = parsed;
              }

              if (this.data.length > 0) await this.batchUpdatePlants(this.data);
              if (this.financeData.length > 0)
                await this.batchUpdateFinance(this.financeData);

              this.showToast("Restore berhasil!");
              this.updateUI();
            } catch (err) {
              console.error(err);
              alert("File rusak atau gagal restore!");
            }
          };
          reader.readAsText(file);
        },

        switchTab(id) {
          document
            .querySelectorAll(".view-section")
            .forEach((e) => (e.style.display = "none"));
          document.getElementById(id).style.display = "block";
          document
            .querySelectorAll(".nav-link")
            .forEach((e) => e.classList.remove("active"));

          const links = document.querySelectorAll(".nav-link");
          if (id === "dashboard") links[0].classList.add("active");
          if (id === "garden") links[1].classList.add("active");
          if (id === "calculator") links[2].classList.add("active");
          if (id === "finance") links[3].classList.add("active");
          if (id === "settings") links[4].classList.add("active");
        },
        openModal(id) {
          document.getElementById(id).classList.add("active");
        },
        closeModal(id) {
          document.getElementById(id).classList.remove("active");
        },
        toggleTheme() {
          const current = document.documentElement.getAttribute("data-theme");
          const next = current === "dark" ? "light" : "dark";
          document.documentElement.setAttribute("data-theme", next);
          localStorage.setItem("sg_theme", next);
        },
        showToast(msg) {
          const t = document.getElementById("toast");
          document.getElementById("toastMsg").innerText = msg;
          t.classList.add("show");
          setTimeout(() => t.classList.remove("show"), 3000);
        },

        async compressImage(file) {
          return new Promise((resolve) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = (e) => {
              const img = new Image();
              img.src = e.target.result;
              img.onload = () => {
                const canvas = document.createElement("canvas");
                const maxW = 500;
                const scale = maxW / img.width;
                canvas.width = maxW;
                canvas.height = img.height * scale;
                canvas
                  .getContext("2d")
                  .drawImage(img, 0, 0, canvas.width, canvas.height);
                resolve(canvas.toDataURL("image/jpeg", 0.7));
              };
            };
          });
        },
      };

      // Expose app to global window object
      window.app = app;

      // --- EVENTS ---
      document.getElementById("financeForm").addEventListener("submit", (e) => {
        e.preventDefault();
        const type = document.getElementById("fType").value;
        const amount = parseInt(document.getElementById("fAmount").value);
        const desc = document.getElementById("fDesc").value;
        const date = document.getElementById("fDate").value;

        if (app.financeEditingId) {
          const idx = app.financeData.findIndex(
            (x) => x.id === app.financeEditingId
          );
          if (idx > -1) {
            app.financeData[idx] = {
              id: app.financeEditingId,
              type,
              amount,
              desc,
              date,
            };
            app.showToast("Transaksi diperbarui!");
          }
        } else {
          app.financeData.push({ id: Date.now(), type, amount, desc, date });
          app.showToast("Transaksi disimpan!");
        }

        app.saveFinance();
        app.closeModal("financeModal");
      });

      document
        .getElementById("pImageInput")
        .addEventListener("change", function (e) {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = (evt) => {
              document.getElementById("imgPreviewBox").style.display = "block";
              document.getElementById("imgPreviewTag").src = evt.target.result;
            };
            reader.readAsDataURL(file);
          }
        });

      // --- EVENT DELEGATION FOR PLANT GRID ---
      document.getElementById("plantGrid").addEventListener("click", (e) => {
        const card = e.target.closest(".plant-card");
        if (card && card.dataset.id) {
          // Delete button inside card handles its own click with stopPropagation()
          app.openDetail(card.dataset.id);
        }
      });

      document
        .getElementById("plantForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();
          const btn = e.target.querySelector('button[type="submit"]');
          btn.innerText = "Menyimpan...";
          btn.disabled = true;

          try {
            const name = document.getElementById("pName").value;
            const file = document.getElementById("pImageInput").files[0];
            const editingId = document.getElementById("pId").value;
            const waterSchedule = app.getSelectedDays(
              "waterDayContainer",
              "active"
            );
            const fertSchedule = app.getSelectedDays(
              "fertDayContainer",
              "fert-active"
            );
            // const flushSchedule = app.getSelectedDays('flushDayContainer', 'flush-active'); // Removed
            const method = document.getElementById("pMethod").value;
            const flushFreq =
              parseInt(document.getElementById("hydroFlushFreq").value) || 0;

            if (!name || name.trim() === "") {
              alert("Nama tanaman harus diisi!");
              btn.innerText = "Simpan";
              btn.disabled = false;
              return;
            }
            if (waterSchedule.length === 0) {
              alert("Pilih minimal 1 hari jadwal air!");
              btn.innerText = "Simpan";
              btn.disabled = false;
              return;
            }
            if (method === "hydro" && flushFreq < 1) {
              alert(
                "Frekuensi kuras & ganti nutrisi harus diisi (minimal 1 hari)!"
              );
              btn.innerText = "Simpan";
              btn.disabled = false;
              return;
            }

            let imgBase64 = null;
            if (file) imgBase64 = await app.compressImage(file);
            else if (!editingId) imgBase64 = await app.getAutoImage(name);

            let plantToSave;
            if (editingId) {
              const idx = app.data.findIndex((p) => p.id == editingId);
              if (idx > -1) {
                app.data[idx].name = name;
                app.data[idx].type = document.getElementById("pType").value;
                app.data[idx].date = document.getElementById("pDate").value;
                app.data[idx].method = method;
                app.data[idx].waterSchedule = waterSchedule;
                app.data[idx].fertSchedule = fertSchedule;
                // app.data[idx].flushSchedule = flushSchedule;
                app.data[idx].flushFrequency = flushFreq; // New Field
                const removeImg =
                  document.getElementById("pImageRemove")?.checked;
                if (removeImg) {
                  app.data[idx].image = null;
                  document.getElementById("imgPreviewBox").style.display =
                    "none";
                  document.getElementById("imgPreviewTag").src = "";
                  document.getElementById("pImageInput").value = "";
                } else if (imgBase64) {
                  app.data[idx].image = imgBase64;
                }
                plantToSave = app.data[idx];
              }
              app.showToast("Data diperbarui!");
              app.updateUI();
            } else {
              const newPlant = {
                id: Date.now(),
                name: name,
                type: document.getElementById("pType").value,
                method: method,
                date: document.getElementById("pDate").value,
                waterSchedule: waterSchedule,
                fertSchedule: fertSchedule,
                // flushSchedule: flushSchedule,
                flushFrequency: flushFreq, // New Field
                healthStatus: "healthy",
                lastWater: document.getElementById("pDate").value,
                lastFert: document.getElementById("pDate").value,
                image: imgBase64,
                logs: [
                  {
                    date: new Date().toISOString(),
                    type: "init",
                    action:
                      method === "hydro"
                        ? "Sistem Hidroponik Aktif"
                        : "Ditanam",
                  },
                ],
              };
              plantToSave = newPlant;
              app.data.unshift(newPlant);
              app.showToast("Tanaman ditambahkan!");
              app.updateUI();
            }

            if (plantToSave) await app.savePlant(plantToSave);
            app.closeModal("formModal");
            e.target.reset();
            app.switchTab("garden");
          } catch (err) {
            console.error(err);
            alert("Gagal menyimpan.");
          } finally {
            btn.innerText = "Simpan";
            btn.disabled = false;
          }
        });

      // document.addEventListener('DOMContentLoaded', () => app.init());
      // Init dipanggil di module script setelah Firebase siap
    </script>

    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          // Gunakan versi statis agar tidak install ulang setiap kali refresh
          // Ganti 'v=2' jika ada update besar pada service worker di masa depan
          navigator.serviceWorker
            .register("./service-worker.js?v=2")
            .then((registration) => {
              console.log(
                "ServiceWorker berhasil didaftarkan dengan scope: ",
                registration.scope
              );
            })
            .catch((err) => {
              console.log("ServiceWorker gagal didaftarkan: ", err);
            });
        });
      }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <div class="modal-overlay" id="instructionModal">
      <div class="modal-box" style="max-width: 500px">
        <div style="padding: 1.5rem">
          <h3
            style="
              margin-bottom: 1rem;
              color: var(--text-main);
              display: flex;
              align-items: center;
              gap: 10px;
            "
          >
            <i
              class="fa-solid fa-user-doctor"
              style="color: var(--primary)"
            ></i>
            Panduan Penanganan
          </h3>
          <div
            style="
              background: #f0f9ff;
              padding: 1rem;
              border-radius: 8px;
              border: 1px solid #bae6fd;
              margin-bottom: 1.5rem;
            "
          >
            <ul
              id="instructionList"
              style="margin: 0; padding-left: 20px; color: var(--text-main)"
            >
              <!-- Dynamic Content -->
            </ul>
          </div>
          <button
            class="btn btn-primary"
            style="width: 100%"
            onclick="app.closeModal('instructionModal')"
          >
            Mengerti
          </button>
        </div>
      </div>
    </div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      // Tambahkan 'getAuth', 'signInWithPopup', 'GoogleAuthProvider', 'signOut', 'onAuthStateChanged'
      import {
        getAuth,
        signInWithPopup,
        GoogleAuthProvider,
        signOut,
        onAuthStateChanged,
      } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

      import {
        getFirestore,
        collection,
        getDocs,
        doc,
        setDoc,
        deleteDoc,
        writeBatch,
      } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

      (function (_0x20862f, _0xda5f48) {
        function _0x2112d5(
          _0xc97fe,
          _0x4556ef,
          _0x43eed2,
          _0x1e289d,
          _0x2ced3c
        ) {
          return _0x1e00(_0xc97fe - 0x25f, _0x2ced3c);
        }
        function _0x37d892(
          _0x1df932,
          _0x5456e5,
          _0x44b9f1,
          _0x13406c,
          _0x5c340e
        ) {
          return _0x1e00(_0x44b9f1 - 0x213, _0x1df932);
        }
        function _0x30359e(
          _0x562798,
          _0x454a89,
          _0x518b3b,
          _0x4883e5,
          _0x3ca161
        ) {
          return _0x1e00(_0x3ca161 - -0x206, _0x454a89);
        }
        const _0x18e5b4 = _0x20862f();
        function _0x6194da(
          _0x15f53a,
          _0x245c01,
          _0x3bf712,
          _0xb49973,
          _0x1e72a7
        ) {
          return _0x1e00(_0x1e72a7 - 0x2c9, _0x3bf712);
        }
        function _0x54927f(
          _0x23aa64,
          _0x49bc5b,
          _0x317977,
          _0x5bc2d8,
          _0x4ff582
        ) {
          return _0x1e00(_0x23aa64 - -0x1af, _0x5bc2d8);
        }
        while (!![]) {
          try {
            const _0x3c7566 =
              (-parseInt(_0x54927f(0x75, 0x88, 0x70, "eJ[8", 0x6)) /
                (-0x3b * 0x6d + 0x16d + 0x17b3)) *
                (parseInt(_0x37d892("gTIW", 0x48d, 0x420, 0x459, 0x458)) /
                  (-0x3 * 0x939 + -0x1 * 0x1471 + -0x301e * -0x1)) +
              -parseInt(_0x30359e(-0x17b, "Zsy6", -0x113, 0x78, -0x67)) /
                (0x1 * -0x2ea + 0x10c + 0x1e1) +
              (parseInt(_0x37d892("u7)C", 0x2ad, 0x2d1, 0x2e3, 0x343)) /
                (0x82 * 0x44 + 0x1 * -0x2195 + 0xef * -0x1)) *
                (parseInt(_0x37d892("gFHR", 0x28d, 0x303, 0x3b2, 0x315)) /
                  (0x151 * 0x1d + 0x1 * 0x7d + -0x26a5)) +
              (parseInt(_0x37d892("gj7%", 0x1f7, 0x2d9, 0x226, 0x1e6)) /
                (-0x18fb + 0x9eb + 0xf16)) *
                (parseInt(_0x6194da(0x26c, 0x28b, "sBk0", 0x279, 0x374)) /
                  (0x2577 + 0x6a * -0x5 + -0x235e)) +
              (-parseInt(_0x54927f(-0x3b, -0x43, -0xb, "Rord", -0x46)) /
                (0x248e * 0x1 + 0x23bf + -0x4845)) *
                (-parseInt(_0x30359e(0x1c, "VIMt", -0x7d, -0x18f, -0xaa)) /
                  (-0x15a7 + -0x1 * -0x2317 + -0x1 * 0xd67)) +
              -parseInt(_0x30359e(0x90, "7cHm", 0x65, -0x1a, -0x1d)) /
                (0x2208 + 0x1abe + 0x12b * -0x34) +
              -parseInt(_0x54927f(-0x3, -0xac, 0x110, "u7)C", -0x6b)) /
                (0x5fb * 0x3 + 0x1a3c + -0x2c22);
            if (_0x3c7566 === _0xda5f48) break;
            else _0x18e5b4["push"](_0x18e5b4["shift"]());
          } catch (_0x96aca3) {
            _0x18e5b4["push"](_0x18e5b4["shift"]());
          }
        }
      })(_0x14e7, 0x894ee + 0x176d2 + 0x1 * -0x487dc);
      const _0xf8fb22 = (function () {
          function _0x1e999b(
            _0x4c33bb,
            _0x3727bd,
            _0x2c74db,
            _0x535ce8,
            _0x4dd2a1
          ) {
            return _0x1e00(_0x4c33bb - 0x2aa, _0x2c74db);
          }
          function _0x688cb(
            _0x13c614,
            _0x4a33b7,
            _0xe94fd2,
            _0x5e31b0,
            _0x2ecdc2
          ) {
            return _0x1e00(_0x5e31b0 - 0x3a5, _0xe94fd2);
          }
          const _0xaca503 = {
            nXjbA: function (_0xf5d59) {
              return _0xf5d59();
            },
            NpvDb: function (_0xe2a37e, _0x4e3023) {
              return _0xe2a37e(_0x4e3023);
            },
            DyLJV: function (_0x5f03bd, _0x561fba) {
              return _0x5f03bd + _0x561fba;
            },
            hJzRB: function (_0xe812b7, _0x4633f4) {
              return _0xe812b7 + _0x4633f4;
            },
            IUrhb:
              _0x4ad041(0x353, 0x316, 0x25e, 0x309, "^egm") +
              _0x47f2fc(0x2c2, 0x358, 0x2e5, 0x1c4, "#1vH") +
              _0x4ad041(0x382, 0x380, 0x428, 0x452, "sBk0") +
              _0x688cb(0x4e7, 0x3e5, "gj7%", 0x424, 0x423),
            uDotG:
              _0x3bf65f(0x3c6, 0x4e3, "GoV3", 0x47f, 0x590) +
              _0x47f2fc(0x256, 0x353, 0x2e2, 0x2b5, "VIMt") +
              _0x3bf65f(0x415, 0x37d, "Y941", 0x45a, 0x519) +
              _0x3bf65f(0x471, 0x475, "bcBT", 0x552, 0x54b) +
              _0x3bf65f(0x6a0, 0x587, "Y941", 0x5f7, 0x4ee) +
              _0x3bf65f(0x50c, 0x39e, "XU3B", 0x403, 0x3a6) +
              "\x20)",
            iykpW: function (_0x221e74) {
              return _0x221e74();
            },
            duicO: function (_0x122a50, _0x2324a9) {
              return _0x122a50 !== _0x2324a9;
            },
            tSEwA: _0x1e999b(0x529, 0x494, "nqPu", 0x461, 0x595),
            ISgYj: function (_0x13fb23, _0x1531de) {
              return _0x13fb23 !== _0x1531de;
            },
            DUjGP: _0x3bf65f(0x5bb, 0x66c, "$v9m", 0x564, 0x4d2),
            NRecR: _0x688cb(0x6c5, 0x613, "GoV3", 0x5d5, 0x5b4),
            jBsyn: function (_0xc6973d, _0x24b81c) {
              return _0xc6973d === _0x24b81c;
            },
            PnKzn: _0x3bf65f(0x43c, 0x62c, "W@mu", 0x528, 0x5e1),
          };
          function _0x3bf65f(
            _0x45b09d,
            _0x40212e,
            _0xeb8493,
            _0x39ba1d,
            _0x29d379
          ) {
            return _0x1e00(_0x39ba1d - 0x38a, _0xeb8493);
          }
          function _0x4ad041(
            _0x34ce14,
            _0xac2bf6,
            _0x3bb0f5,
            _0x2b670f,
            _0x360166
          ) {
            return _0x1e00(_0xac2bf6 - 0x146, _0x360166);
          }
          function _0x47f2fc(
            _0x45d5f7,
            _0x380b52,
            _0x52d802,
            _0x4c5826,
            _0x11f849
          ) {
            return _0x1e00(_0x45d5f7 - 0x78, _0x11f849);
          }
          let _0x408bd5 = !![];
          return function (_0x5e8b92, _0x3dfa9a) {
            function _0x3f3e6d(
              _0x37d738,
              _0x32ff49,
              _0x2d733b,
              _0x56fefc,
              _0x427d52
            ) {
              return _0x688cb(
                _0x37d738 - 0xd4,
                _0x32ff49 - 0xcd,
                _0x32ff49,
                _0x2d733b - -0x4bb,
                _0x427d52 - 0x1df
              );
            }
            function _0x20ef7b(
              _0x407f7b,
              _0x57b07c,
              _0xf05171,
              _0x40fa2e,
              _0x3b52fe
            ) {
              return _0x1e999b(
                _0x40fa2e - -0x3af,
                _0x57b07c - 0x1bc,
                _0xf05171,
                _0x40fa2e - 0x1a9,
                _0x3b52fe - 0x16
              );
            }
            function _0x79bca4(
              _0x641ffd,
              _0x142aad,
              _0x4ac2ee,
              _0x2d7728,
              _0x2d8368
            ) {
              return _0x4ad041(
                _0x641ffd - 0x63,
                _0x2d7728 - -0x291,
                _0x4ac2ee - 0x141,
                _0x2d7728 - 0x1eb,
                _0x641ffd
              );
            }
            function _0x5cccdc(
              _0x87418e,
              _0x38a6a3,
              _0x583f33,
              _0x25b180,
              _0x362721
            ) {
              return _0x3bf65f(
                _0x87418e - 0x188,
                _0x38a6a3 - 0x161,
                _0x25b180,
                _0x38a6a3 - -0x5e2,
                _0x362721 - 0x17
              );
            }
            function _0x2f8fda(
              _0x14cdbe,
              _0x322994,
              _0x37813d,
              _0x147576,
              _0x414336
            ) {
              return _0x1e999b(
                _0x14cdbe - -0x41e,
                _0x322994 - 0x25,
                _0x37813d,
                _0x147576 - 0x141,
                _0x414336 - 0x99
              );
            }
            if (
              _0xaca503[_0x3f3e6d(0x12e, "9zhu", 0x28, -0x1, 0xed)](
                _0xaca503[_0x3f3e6d(0x44, "Rord", 0x14e, 0x189, 0x155)],
                _0xaca503[_0x2f8fda(0x11b, 0xd7, "tt&c", 0x1de, 0x25)]
              )
            ) {
              const _0x27df96 = _0x408bd5
                ? function () {
                    function _0xb78cf7(
                      _0x2ad5bc,
                      _0x3bbd28,
                      _0x1e0ad3,
                      _0x2a88fc,
                      _0x5b3699
                    ) {
                      return _0x3f3e6d(
                        _0x2ad5bc - 0xa2,
                        _0x3bbd28,
                        _0x5b3699 - 0x2d7,
                        _0x2a88fc - 0x4d,
                        _0x5b3699 - 0x142
                      );
                    }
                    function _0x243af3(
                      _0x466fac,
                      _0x848750,
                      _0x56ec30,
                      _0x32a886,
                      _0x372900
                    ) {
                      return _0x2f8fda(
                        _0x32a886 - -0x1a8,
                        _0x848750 - 0x80,
                        _0x56ec30,
                        _0x32a886 - 0x23,
                        _0x372900 - 0x84
                      );
                    }
                    function _0x123cfb(
                      _0x394006,
                      _0x2b0c0d,
                      _0x1f9ebf,
                      _0x58bda6,
                      _0x45da7b
                    ) {
                      return _0x20ef7b(
                        _0x394006 - 0xc0,
                        _0x2b0c0d - 0x19a,
                        _0x58bda6,
                        _0x1f9ebf - -0x1e9,
                        _0x45da7b - 0x1e2
                      );
                    }
                    const _0x53cf3d = {
                      Tdrdx: function (_0x1d58b1) {
                        function _0x137455(
                          _0x46ee23,
                          _0x434fac,
                          _0x342aa6,
                          _0x41f8bf,
                          _0x498b78
                        ) {
                          return _0x1e00(_0x498b78 - 0x36b, _0x46ee23);
                        }
                        return _0xaca503[
                          _0x137455("u7)C", 0x56e, 0x5ac, 0x4fd, 0x5f6)
                        ](_0x1d58b1);
                      },
                      ipysH: function (_0x573cf9, _0x273b7f) {
                        function _0x11ef51(
                          _0x26c2f4,
                          _0x5d0381,
                          _0x36cccf,
                          _0x22f177,
                          _0x19afab
                        ) {
                          return _0x1e00(_0x36cccf - 0xde, _0x26c2f4);
                        }
                        return _0xaca503[
                          _0x11ef51("T^6w", 0x301, 0x346, 0x267, 0x408)
                        ](_0x573cf9, _0x273b7f);
                      },
                      ekgon: function (_0x35773d, _0x3393d0) {
                        function _0x25a7c3(
                          _0x56ff2b,
                          _0x38d967,
                          _0x21e937,
                          _0x4a9336,
                          _0x30c2b0
                        ) {
                          return _0x1e00(_0x56ff2b - -0x352, _0x4a9336);
                        }
                        return _0xaca503[
                          _0x25a7c3(-0x1cb, -0x294, -0x147, "Zsy6", -0x18e)
                        ](_0x35773d, _0x3393d0);
                      },
                      oBQPw: function (_0x45fb96, _0x31c077) {
                        function _0x1de39(
                          _0x1f3a67,
                          _0x59262c,
                          _0x25bb36,
                          _0x1bf61c,
                          _0x58ae8f
                        ) {
                          return _0x1e00(_0x58ae8f - -0x2a9, _0x25bb36);
                        }
                        return _0xaca503[
                          _0x1de39(-0x10d, -0x1a1, "gFHR", -0x3e, -0xa4)
                        ](_0x45fb96, _0x31c077);
                      },
                      pzEHs:
                        _0xaca503[
                          _0x282759("sGVM", 0x4fb, 0x52f, 0x53a, 0x482)
                        ],
                      rOlsw:
                        _0xaca503[
                          _0x282759("V$by", 0x351, 0x329, 0x3ab, 0x49d)
                        ],
                      OaIMh: function (_0x542c1a) {
                        function _0x4ece9e(
                          _0x4f3a80,
                          _0x500dca,
                          _0x2d18f8,
                          _0x4c6221,
                          _0x4b4d18
                        ) {
                          return _0x282759(
                            _0x4b4d18,
                            _0x500dca - 0xca,
                            _0x2d18f8 - 0x74,
                            _0x4f3a80 - -0x86,
                            _0x4b4d18 - 0xd5
                          );
                        }
                        return _0xaca503[
                          _0x4ece9e(0x351, 0x2da, 0x434, 0x297, "V$by")
                        ](_0x542c1a);
                      },
                    };
                    function _0x4d91b2(
                      _0xbbf4a2,
                      _0x48979c,
                      _0xb8802,
                      _0x29bc31,
                      _0x1bd64b
                    ) {
                      return _0x3f3e6d(
                        _0xbbf4a2 - 0x191,
                        _0xb8802,
                        _0x1bd64b - -0x26f,
                        _0x29bc31 - 0x122,
                        _0x1bd64b - 0x1ba
                      );
                    }
                    function _0x282759(
                      _0x48300a,
                      _0x2cbbb4,
                      _0x7a3ce,
                      _0x5845b4,
                      _0x1f4b66
                    ) {
                      return _0x20ef7b(
                        _0x48300a - 0xba,
                        _0x2cbbb4 - 0x199,
                        _0x48300a,
                        _0x5845b4 - 0x438,
                        _0x1f4b66 - 0x76
                      );
                    }
                    if (
                      _0xaca503[_0xb78cf7(0x21a, "dZqL", 0x185, 0x1f8, 0x283)](
                        _0xaca503[
                          _0x4d91b2(-0xe2, -0xf7, "HlT$", -0x147, -0x177)
                        ],
                        _0xaca503[_0x282759("qI3O", 0x477, 0x424, 0x52c, 0x636)]
                      )
                    )
                      _0x53cf3d[_0xb78cf7(0x48f, "9zhu", 0x3b1, 0x2fe, 0x3b7)](
                        _0x47712b
                      );
                    else {
                      if (_0x3dfa9a) {
                        if (
                          _0xaca503[
                            _0x282759("LVM1", 0x30f, 0x446, 0x41b, 0x513)
                          ](
                            _0xaca503[
                              _0x4d91b2(-0x205, -0x210, "T^6w", -0x293, -0x263)
                            ],
                            _0xaca503[
                              _0x123cfb(-0x5d, -0xa2, -0x116, "k9pW", -0x1fd)
                            ]
                          )
                        ) {
                          const _0x2575cb = _0x3dfa9a[
                            _0x243af3(-0xcf, -0x36, "cXkO", -0xfa, -0x12f)
                          ](_0x5e8b92, arguments);
                          return (_0x3dfa9a = null), _0x2575cb;
                        } else {
                          let _0x289780;
                          try {
                            const _0x23f53e = _0x53cf3d[
                              _0xb78cf7(0x375, "sGVM", 0x493, 0x3a0, 0x39d)
                            ](
                              _0x4851bf,
                              _0x53cf3d[
                                _0xb78cf7(0x359, "^egm", 0x280, 0x38b, 0x341)
                              ](
                                _0x53cf3d[
                                  _0x282759("[Z@%", 0x4b9, 0x59e, 0x51b, 0x559)
                                ](
                                  _0x53cf3d[
                                    _0x282759(
                                      "gTIW",
                                      0x3f9,
                                      0x41b,
                                      0x3b0,
                                      0x492
                                    )
                                  ],
                                  _0x53cf3d[
                                    _0xb78cf7(
                                      0x341,
                                      "OibM",
                                      0x284,
                                      0x3d2,
                                      0x30c
                                    )
                                  ]
                                ),
                                ");"
                              )
                            );
                            _0x289780 =
                              _0x53cf3d[
                                _0x243af3(-0xf8, -0xd3, "nqPu", -0x1c3, -0x11c)
                              ](_0x23f53e);
                          } catch (_0x218287) {
                            _0x289780 = _0x417c22;
                          }
                          _0x289780[
                            _0x4d91b2(-0x20b, -0x1f4, "@Dkg", -0x22c, -0x250) +
                              _0x243af3(
                                -0x148,
                                -0x1a6,
                                "#1vH",
                                -0x15d,
                                -0x10b
                              ) +
                              "l"
                          ](_0x2c1d55, -0x4a1 + -0x23a4 + 0x37e5);
                        }
                      }
                    }
                  }
                : function () {};
              return (_0x408bd5 = ![]), _0x27df96;
            } else {
              const _0x9d8bcc =
                  _0x535e11[
                    _0x20ef7b(0x1d, -0x45, "9zhu", -0x4c, -0x3f) +
                      _0x20ef7b(-0x50, 0x161, "7cHm", 0xaf, 0x1bf) +
                      "r"
                  ][
                    _0x5cccdc(-0x8d, -0xa, -0xda, "XU3B", -0x49) +
                      _0x2f8fda(-0x40, -0x7b, "@Dkg", 0x58, 0x3c)
                  ][_0x2f8fda(-0xf6, -0x1b9, "#1vH", -0xc4, -0xc6)](_0x4b18ba),
                _0x51f26c = _0x5df53b[_0x397596],
                _0x2603cb = _0x25e1eb[_0x51f26c] || _0x9d8bcc;
              (_0x9d8bcc[
                _0x5cccdc(-0x1c3, -0xe1, -0x6e, "#1vH", -0x96) +
                  _0x3f3e6d(0x1c8, "eJ[8", 0xbc, 0x189, 0x197)
              ] =
                _0x47be28[_0x5cccdc(-0x1b5, -0x12b, -0x1f7, "Zsy6", -0x13d)](
                  _0x14471b
                )),
                (_0x9d8bcc[
                  _0x5cccdc(-0x1e8, -0x1be, -0x2d0, "V$by", -0x14a) +
                    _0x5cccdc(-0xa7, -0xe5, -0x1a8, "J#)U", -0x112)
                ] =
                  _0x2603cb[
                    _0x2f8fda(0xf, -0x3a, ")QtV", 0x29, 0x16) +
                      _0x20ef7b(0x223, 0x9b, "h&M!", 0x16f, 0x180)
                  ][_0x20ef7b(0x8e, 0x5, "GoV3", 0xcf, -0x22)](_0x2603cb)),
                (_0x4c3ba5[_0x51f26c] = _0x9d8bcc);
            }
          };
        })(),
        _0x1596e8 = _0xf8fb22(this, function () {
          const _0x2932bd = {};
          function _0x34687d(
            _0x193823,
            _0x13bd0d,
            _0x58bd37,
            _0x26e387,
            _0x43a145
          ) {
            return _0x1e00(_0x58bd37 - 0x225, _0x26e387);
          }
          function _0x413cfb(
            _0x552881,
            _0x53911d,
            _0x512981,
            _0x40f644,
            _0x296e2b
          ) {
            return _0x1e00(_0x40f644 - -0x10b, _0x512981);
          }
          function _0x51c248(
            _0x406d08,
            _0x1b5b05,
            _0x330e55,
            _0x21c1ef,
            _0x149753
          ) {
            return _0x1e00(_0x1b5b05 - -0x256, _0x406d08);
          }
          function _0x21d155(
            _0x10a9be,
            _0x4ce5db,
            _0x5d2b51,
            _0x5d15d1,
            _0x316d54
          ) {
            return _0x1e00(_0x5d2b51 - 0x39a, _0x316d54);
          }
          function _0x5890f7(
            _0x24b08a,
            _0x25eeac,
            _0x3aa9f3,
            _0x34bd0f,
            _0x108736
          ) {
            return _0x1e00(_0x3aa9f3 - 0x7e, _0x34bd0f);
          }
          _0x2932bd[_0x34687d(0x38e, 0x395, 0x2c5, "T^6w", 0x30f)] =
            _0x34687d(0x518, 0x3a6, 0x421, "*h3V", 0x50f) +
            _0x34687d(0x215, 0x273, 0x309, "^egm", 0x3ea) +
            "+$";
          const _0x1c9a4e = _0x2932bd;
          return _0x1596e8[
            _0x413cfb(0x5c, 0x2b, "qI3O", 0x13a, 0x211) +
              _0x413cfb(0x94, 0x149, "eJ[8", 0x137, 0x164)
          ]()
            [_0x413cfb(0x242, 0x21c, "41Bu", 0x140, 0x1a4) + "h"](
              _0x1c9a4e[_0x21d155(0x5a7, 0x4b1, 0x4ee, 0x590, "k9pW")]
            )
            [
              _0x5890f7(0x259, 0x2cd, 0x304, "T^6w", 0x2cd) +
                _0x5890f7(0xa2, 0xf1, 0x14d, "LVM1", 0xd3)
            ]()
            [
              _0x21d155(0x59a, 0x5b2, 0x4cb, 0x52b, "Y941") +
                _0x5890f7(0x1e5, 0x359, 0x29f, "$Bj&", 0x382) +
                "r"
            ](_0x1596e8)
            [_0x51c248("gFHR", -0x13f, -0xa0, -0x5e, -0x63) + "h"](
              _0x1c9a4e[_0x5890f7(0x2e9, 0x175, 0x27d, "J#)U", 0x25e)]
            );
        });
      _0x1596e8();
      function _0x1501ee(
        _0x2db2cb,
        _0x3a173d,
        _0x188465,
        _0x3ad743,
        _0x4117fa
      ) {
        return _0x1e00(_0x4117fa - -0x62, _0x188465);
      }
      function _0x19dfc8(
        _0x531ef1,
        _0x305a4e,
        _0x4c7a58,
        _0x10eb8e,
        _0x17bbf9
      ) {
        return _0x1e00(_0x305a4e - 0x9f, _0x531ef1);
      }
      function _0x1e00(_0x8f540, _0x1ea614) {
        const _0x3b1714 = _0x14e7();
        return (
          (_0x1e00 = function (_0x2a44c9, _0xc99c1b) {
            _0x2a44c9 = _0x2a44c9 - (-0xb01 + 0xc4b * -0x3 + 0x3055);
            let _0x2c1d55 = _0x3b1714[_0x2a44c9];
            if (_0x1e00["OuvMKo"] === undefined) {
              var _0x4851bf = function (_0x2c5b0c) {
                const _0x3bc674 =
                  "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=";
                let _0x503cd2 = "",
                  _0x539375 = "",
                  _0x1b022a = _0x503cd2 + _0x4851bf;
                for (
                  let _0x2bc3b4 = 0x24b1 + -0x183f * -0x1 + -0x9c * 0x64,
                    _0x5bbe93,
                    _0x4248bd,
                    _0x2d3bc4 = -0x1a53 + 0xaf9 * -0x2 + 0x55d * 0x9;
                  (_0x4248bd = _0x2c5b0c["charAt"](_0x2d3bc4++));
                  ~_0x4248bd &&
                  ((_0x5bbe93 =
                    _0x2bc3b4 % (-0x24d3 + -0xb4 * 0x1d + 0x393b)
                      ? _0x5bbe93 * (0xfca * -0x1 + 0x1b8c + -0xb82) + _0x4248bd
                      : _0x4248bd),
                  _0x2bc3b4++ % (-0x243a + 0x932 + -0xd86 * -0x2))
                    ? (_0x503cd2 +=
                        _0x1b022a["charCodeAt"](
                          _0x2d3bc4 + (-0x31 * -0x9e + -0x11c0 * -0x1 + -0x2ff4)
                        ) -
                          (-0x760 + 0x1 * -0x11a4 + 0x1 * 0x190e) !==
                        0xeb0 + 0x2 * 0x117f + -0x31ae
                          ? String["fromCharCode"](
                              (-0x682 + 0xae0 + -0x1 * 0x35f) &
                                (_0x5bbe93 >>
                                  ((-(0x1020 + -0x5 * 0x611 + 0xe37) *
                                    _0x2bc3b4) &
                                    (0x68 * 0x4a + 0xc74 + -0x206 * 0x15)))
                            )
                          : _0x2bc3b4)
                    : -0x273 + 0x2175 + -0x12 * 0x1b9
                ) {
                  _0x4248bd = _0x3bc674["indexOf"](_0x4248bd);
                }
                for (
                  let _0x1ab06d = 0x7 * 0x26b + 0x2667 + -0x3754,
                    _0x10e98c = _0x503cd2["length"];
                  _0x1ab06d < _0x10e98c;
                  _0x1ab06d++
                ) {
                  _0x539375 +=
                    "%" +
                    ("00" +
                      _0x503cd2["charCodeAt"](_0x1ab06d)["toString"](
                        -0xdd1 + 0x12 + 0x1f9 * 0x7
                      ))["slice"](-(-0x77c + 0x4f3 * 0x4 + 0x627 * -0x2));
                }
                return decodeURIComponent(_0x539375);
              };
              const _0x36655d = function (_0xf82c13, _0x42db3d) {
                let _0x4dde10 = [],
                  _0x439687 = -0x1594 + -0x1f0 * -0x2 + 0x11b4 * 0x1,
                  _0x574be7,
                  _0x35b9c6 = "";
                _0xf82c13 = _0x4851bf(_0xf82c13);
                let _0x5a8d7e;
                for (
                  _0x5a8d7e = -0x1a47 + 0xe4 + 0x1963;
                  _0x5a8d7e < 0xbf2 + -0x35f + -0x793;
                  _0x5a8d7e++
                ) {
                  _0x4dde10[_0x5a8d7e] = _0x5a8d7e;
                }
                for (
                  _0x5a8d7e = -0x21a4 + -0x5 * 0x377 + 0x32f7;
                  _0x5a8d7e < -0x2589 + 0x47 * -0x3d + -0xa9 * -0x54;
                  _0x5a8d7e++
                ) {
                  (_0x439687 =
                    (_0x439687 +
                      _0x4dde10[_0x5a8d7e] +
                      _0x42db3d["charCodeAt"](
                        _0x5a8d7e % _0x42db3d["length"]
                      )) %
                    (0x2 * -0xb09 + 0x1 * -0x5d5 + 0x1ce7)),
                    (_0x574be7 = _0x4dde10[_0x5a8d7e]),
                    (_0x4dde10[_0x5a8d7e] = _0x4dde10[_0x439687]),
                    (_0x4dde10[_0x439687] = _0x574be7);
                }
                (_0x5a8d7e = -0x6a * -0x2f + -0x3 * -0xa22 + -0x31dc),
                  (_0x439687 = 0x12e2 * 0x2 + -0x1 * -0x235a + 0x7 * -0xa72);
                for (
                  let _0x48ec8f = 0x6fc + -0x19eb + 0x25 * 0x83;
                  _0x48ec8f < _0xf82c13["length"];
                  _0x48ec8f++
                ) {
                  (_0x5a8d7e =
                    (_0x5a8d7e + (-0x1d79 + -0x223 * 0x8 + 0x2e92)) %
                    (0x6af + -0x2375 + 0xee3 * 0x2)),
                    (_0x439687 =
                      (_0x439687 + _0x4dde10[_0x5a8d7e]) %
                      (-0x1539 + -0x1055 + -0x1347 * -0x2)),
                    (_0x574be7 = _0x4dde10[_0x5a8d7e]),
                    (_0x4dde10[_0x5a8d7e] = _0x4dde10[_0x439687]),
                    (_0x4dde10[_0x439687] = _0x574be7),
                    (_0x35b9c6 += String["fromCharCode"](
                      _0xf82c13["charCodeAt"](_0x48ec8f) ^
                        _0x4dde10[
                          (_0x4dde10[_0x5a8d7e] + _0x4dde10[_0x439687]) %
                            (0x217b * 0x1 + -0x151 * -0x1 + -0x21cc)
                        ]
                    ));
                }
                return _0x35b9c6;
              };
              (_0x1e00["rHalZh"] = _0x36655d),
                (_0x8f540 = arguments),
                (_0x1e00["OuvMKo"] = !![]);
            }
            const _0x5baf52 = _0x3b1714[-0x527 + -0x9 * -0x7f + 0x1 * 0xb0],
              _0x417c22 = _0x2a44c9 + _0x5baf52,
              _0x23294c = _0x8f540[_0x417c22];
            if (!_0x23294c) {
              if (_0x1e00["uEOnBZ"] === undefined) {
                const _0x3fce74 = function (_0x40ed39) {
                  (this["YqnMzv"] = _0x40ed39),
                    (this["pecKSK"] = [
                      0x1120 + -0x1 * 0x2149 + 0x102a,
                      0x1081 * 0x1 + -0x2d5 * -0x1 + -0x1356,
                      -0x24d2 * 0x1 + -0x186f + 0x3d41 * 0x1,
                    ]),
                    (this["IzIxRE"] = function () {
                      return "newState";
                    }),
                    (this["zzHXRL"] = "\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*"),
                    (this["tcAGvu"] = "[\x27|\x22].+[\x27|\x22];?\x20*}");
                };
                (_0x3fce74["prototype"]["MlLxTX"] = function () {
                  const _0x2f9127 = new RegExp(this["zzHXRL"] + this["tcAGvu"]),
                    _0x14b9c6 = _0x2f9127["test"](this["IzIxRE"]["toString"]())
                      ? --this["pecKSK"][0x923 * 0x3 + -0xd7d + -0x1 * 0xdeb]
                      : --this["pecKSK"][-0x200c + -0x2562 + 0x456e * 0x1];
                  return this["FLradt"](_0x14b9c6);
                }),
                  (_0x3fce74["prototype"]["FLradt"] = function (_0x3242b8) {
                    if (!Boolean(~_0x3242b8)) return _0x3242b8;
                    return this["TJtEAK"](this["YqnMzv"]);
                  }),
                  (_0x3fce74["prototype"]["TJtEAK"] = function (_0x3de71a) {
                    for (
                      let _0x258b23 = -0xfa * 0x10 + 0x67f * -0x4 + 0x299c,
                        _0x18b597 = this["pecKSK"]["length"];
                      _0x258b23 < _0x18b597;
                      _0x258b23++
                    ) {
                      this["pecKSK"]["push"](Math["round"](Math["random"]())),
                        (_0x18b597 = this["pecKSK"]["length"]);
                    }
                    return _0x3de71a(
                      this["pecKSK"][-0x2ab * -0x3 + 0x79 * -0x11 + 0x2 * 0x4]
                    );
                  }),
                  new _0x3fce74(_0x1e00)["MlLxTX"](),
                  (_0x1e00["uEOnBZ"] = !![]);
              }
              (_0x2c1d55 = _0x1e00["rHalZh"](_0x2c1d55, _0xc99c1b)),
                (_0x8f540[_0x417c22] = _0x2c1d55);
            } else _0x2c1d55 = _0x23294c;
            return _0x2c1d55;
          }),
          _0x1e00(_0x8f540, _0x1ea614)
        );
      }
      const _0x7addbb = (function () {
        function _0x322762(
          _0x2c907b,
          _0x344243,
          _0x4a443c,
          _0x17bd38,
          _0x365d90
        ) {
          return _0x1e00(_0x2c907b - 0x5d, _0x4a443c);
        }
        function _0x33d8b9(
          _0x1d65e7,
          _0x243b26,
          _0x4b93e9,
          _0x2d9f89,
          _0x24ec03
        ) {
          return _0x1e00(_0x243b26 - 0x2ac, _0x24ec03);
        }
        function _0x5b8329(
          _0xf9f792,
          _0x5b3469,
          _0x50fdca,
          _0x578771,
          _0x9651ea
        ) {
          return _0x1e00(_0x578771 - 0x2f0, _0x9651ea);
        }
        function _0x380421(
          _0x4ed093,
          _0x3b317b,
          _0x11fda0,
          _0x4cc7ec,
          _0x16d0e7
        ) {
          return _0x1e00(_0x11fda0 - 0x46, _0x4ed093);
        }
        function _0x13d91a(
          _0x303f2a,
          _0x344947,
          _0x35cccc,
          _0x9b3f32,
          _0x580681
        ) {
          return _0x1e00(_0x580681 - 0x4, _0x344947);
        }
        const _0x280062 = {
          ZzLuf: function (_0x540fd4, _0xfd8089) {
            return _0x540fd4 === _0xfd8089;
          },
          jDWPj: _0x380421("@Dkg", 0x363, 0x297, 0x39f, 0x1d8),
          QrPYx: _0x380421("*h3V", 0x109, 0x170, 0x24a, 0x82),
          BCoZV: _0x380421("tt&c", 0x29b, 0x1b5, 0x106, 0x21d),
          IfOxT:
            _0x13d91a(0x21b, "$Bj&", 0x2e8, 0x2df, 0x206) +
            _0x33d8b9(0x449, 0x3e9, 0x3c1, 0x4ef, "pKZl") +
            _0x322762(0x2d8, 0x38d, "LVM1", 0x258, 0x3d3) +
            ")",
          eHJko:
            _0x322762(0x1ee, 0x2f2, "cXkO", 0x2e6, 0x1cd) +
            _0x322762(0x17b, 0x21d, "UN%X", 0x206, 0xfc) +
            _0x380421("PlV*", 0x30c, 0x2d4, 0x28a, 0x279) +
            _0x13d91a(0x1cd, "%fZq", 0x18e, 0x230, 0x257) +
            _0x13d91a(0x127, "GoV3", 0x261, 0x234, 0x18a) +
            _0x13d91a(-0x24, "V$by", 0x188, -0x8a, 0x79) +
            _0x13d91a(0xa5, "^egm", 0x148, 0x195, 0x181),
          wqhSA: function (_0x47edd0, _0x9dcdfc) {
            return _0x47edd0(_0x9dcdfc);
          },
          GeeTq: _0x5b8329(0x451, 0x5b3, 0x5ba, 0x533, "dZqL"),
          KWBMR: function (_0x3cbe4d, _0x956e7a) {
            return _0x3cbe4d + _0x956e7a;
          },
          OifHH: _0x380421("GoV3", 0x159, 0x101, 0x1eb, 0x10c),
          WwEgO: _0x380421("Rord", 0x2e0, 0x25c, 0x2c9, 0x1bd),
          lffCK: function (_0x5de808) {
            return _0x5de808();
          },
          aeuas: function (_0x5592eb, _0x14ced9, _0x33de27) {
            return _0x5592eb(_0x14ced9, _0x33de27);
          },
          VxWwO: function (_0x4aad29, _0x7de474) {
            return _0x4aad29 !== _0x7de474;
          },
          pEEYn: _0x322762(0x20e, 0x2f3, "Y941", 0x2fc, 0x2ab),
          JQmlU: _0x13d91a(0x244, "OibM", 0x15f, 0x1ff, 0x269),
        };
        let _0x20e2d4 = !![];
        return function (_0x52a7e7, _0x3650c3) {
          function _0x4d7991(
            _0x4f92d0,
            _0x535eed,
            _0x1bf012,
            _0x1770fc,
            _0x408295
          ) {
            return _0x380421(
              _0x1770fc,
              _0x535eed - 0x1f,
              _0x4f92d0 - 0x13b,
              _0x1770fc - 0xa1,
              _0x408295 - 0x6b
            );
          }
          function _0x2129b2(
            _0x8f71c6,
            _0x3a38c0,
            _0x46926f,
            _0x133dca,
            _0x73727e
          ) {
            return _0x5b8329(
              _0x8f71c6 - 0x102,
              _0x3a38c0 - 0x103,
              _0x46926f - 0x111,
              _0x3a38c0 - -0x5e,
              _0x8f71c6
            );
          }
          const _0x5b5851 = {
            SxaFN: _0x280062[_0x4d7991(0x30a, 0x3c8, 0x262, "Y6JY", 0x2f5)],
            VKKPy: _0x280062[_0x3a429c(0x2db, 0x2b6, 0x3a1, 0x3ae, "pKZl")],
            iGvDa: function (_0x45f295, _0x59aaa2) {
              function _0x26ce53(
                _0x414f5b,
                _0x394afe,
                _0x5709f0,
                _0x31434a,
                _0x5c92da
              ) {
                return _0x3a429c(
                  _0x414f5b - 0x44,
                  _0x394afe - 0xaa,
                  _0x394afe - -0x555,
                  _0x31434a - 0x37,
                  _0x5c92da
                );
              }
              return _0x280062[
                _0x26ce53(-0x2c2, -0x1b5, -0x16c, -0xf7, "dZqL")
              ](_0x45f295, _0x59aaa2);
            },
            KABFS: _0x280062[_0x3a429c(0x491, 0x354, 0x3b8, 0x4c2, "gTIW")],
            Plzps: function (_0x5e3f7a, _0x42b2c3) {
              function _0x326553(
                _0x2d9a1f,
                _0x2a45a8,
                _0x124aba,
                _0x579dee,
                _0x5102e6
              ) {
                return _0x4d7991(
                  _0x2a45a8 - 0x1b,
                  _0x2a45a8 - 0x7a,
                  _0x124aba - 0x161,
                  _0x579dee,
                  _0x5102e6 - 0x11f
                );
              }
              return _0x280062[_0x326553(0x36a, 0x34a, 0x377, "[Z@%", 0x25f)](
                _0x5e3f7a,
                _0x42b2c3
              );
            },
            fmaIx: _0x280062[_0x3a429c(0x370, 0x287, 0x367, 0x380, "h&M!")],
            AUFRX: _0x280062[_0x2129b2("VIMt", 0x438, 0x41d, 0x389, 0x32a)],
            NTsWt: function (_0x2cddd5, _0x179e41) {
              function _0xb4400b(
                _0x40a85f,
                _0x5ee9ec,
                _0x1c0998,
                _0x319af5,
                _0x25f42f
              ) {
                return _0x3f64ec(
                  _0x40a85f - 0x1de,
                  _0x5ee9ec - 0x14e,
                  _0x319af5 - -0x45b,
                  _0x25f42f,
                  _0x25f42f - 0x7d
                );
              }
              return _0x280062[_0xb4400b(0x1db, 0x210, 0x65, 0x152, "eJ[8")](
                _0x2cddd5,
                _0x179e41
              );
            },
            Notdv: function (_0x3612e3) {
              function _0xd67b41(
                _0x2b1230,
                _0x15b406,
                _0x34a3ed,
                _0x5b8e89,
                _0x5cd46f
              ) {
                return _0x4d7991(
                  _0x5b8e89 - -0x520,
                  _0x15b406 - 0x4f,
                  _0x34a3ed - 0xa0,
                  _0x34a3ed,
                  _0x5cd46f - 0x1c3
                );
              }
              return _0x280062[
                _0xd67b41(-0x1fe, -0x261, "9zhu", -0x25e, -0x1af)
              ](_0x3612e3);
            },
            alcDp: function (_0x588c69, _0xe227a6, _0x1ea239) {
              function _0xd4649c(
                _0x357700,
                _0x54b518,
                _0x58b352,
                _0x5042d1,
                _0x30af25
              ) {
                return _0x3f64ec(
                  _0x357700 - 0x172,
                  _0x54b518 - 0xa5,
                  _0x357700 - 0x76,
                  _0x30af25,
                  _0x30af25 - 0x135
                );
              }
              return _0x280062[_0xd4649c(0x4f6, 0x55d, 0x4f5, 0x4ee, ")QtV")](
                _0x588c69,
                _0xe227a6,
                _0x1ea239
              );
            },
          };
          function _0x3f64ec(
            _0x58c612,
            _0x3d8799,
            _0x112074,
            _0x1cb788,
            _0x5edc6f
          ) {
            return _0x5b8329(
              _0x58c612 - 0x15d,
              _0x3d8799 - 0x1be,
              _0x112074 - 0x1ee,
              _0x112074 - 0x27,
              _0x1cb788
            );
          }
          function _0x359884(
            _0x14d688,
            _0x480a4b,
            _0x260783,
            _0x4bbeba,
            _0x3f197f
          ) {
            return _0x380421(
              _0x14d688,
              _0x480a4b - 0x16c,
              _0x4bbeba - -0x1e9,
              _0x4bbeba - 0x9c,
              _0x3f197f - 0xd5
            );
          }
          function _0x3a429c(
            _0x13854c,
            _0x468038,
            _0x222af2,
            _0x239f13,
            _0x24bfd4
          ) {
            return _0x380421(
              _0x24bfd4,
              _0x468038 - 0x6,
              _0x222af2 - 0x16e,
              _0x239f13 - 0x160,
              _0x24bfd4 - 0x190
            );
          }
          if (
            _0x280062[_0x3f64ec(0x431, 0x331, 0x399, "VIMt", 0x32c)](
              _0x280062[_0x3f64ec(0x527, 0x507, 0x475, "$Bj&", 0x3e0)],
              _0x280062[_0x359884("@Dkg", 0xd8, 0x3c, 0xe0, 0x1e9)]
            )
          ) {
            const _0x1aaa87 = _0x20e2d4
              ? function () {
                  function _0x5cdfd9(
                    _0x1f42fa,
                    _0x396d89,
                    _0x4da7de,
                    _0x1972ad,
                    _0x78434e
                  ) {
                    return _0x4d7991(
                      _0x78434e - 0x98,
                      _0x396d89 - 0x163,
                      _0x4da7de - 0x171,
                      _0x396d89,
                      _0x78434e - 0x23
                    );
                  }
                  function _0x2dc36e(
                    _0x4224ca,
                    _0x1ae989,
                    _0x3260e0,
                    _0x1e899a,
                    _0x7b574e
                  ) {
                    return _0x4d7991(
                      _0x1e899a - -0x2,
                      _0x1ae989 - 0x14c,
                      _0x3260e0 - 0x193,
                      _0x1ae989,
                      _0x7b574e - 0x51
                    );
                  }
                  function _0x565acd(
                    _0xc132e6,
                    _0x11082b,
                    _0x22a5a5,
                    _0x39e5df,
                    _0x243aa8
                  ) {
                    return _0x3a429c(
                      _0xc132e6 - 0x13f,
                      _0x11082b - 0x15b,
                      _0x243aa8 - -0x429,
                      _0x39e5df - 0x17e,
                      _0x22a5a5
                    );
                  }
                  function _0x1f1ab5(
                    _0x329b2d,
                    _0x110c81,
                    _0x4f256b,
                    _0x1c5bc5,
                    _0x170991
                  ) {
                    return _0x3f64ec(
                      _0x329b2d - 0x184,
                      _0x110c81 - 0x1d7,
                      _0x1c5bc5 - -0x3ce,
                      _0x110c81,
                      _0x170991 - 0x17c
                    );
                  }
                  function _0x5e1a85(
                    _0x4ba02b,
                    _0xb04805,
                    _0x523498,
                    _0x2b720a,
                    _0x13e472
                  ) {
                    return _0x3a429c(
                      _0x4ba02b - 0x5b,
                      _0xb04805 - 0x79,
                      _0x523498 - 0xe6,
                      _0x2b720a - 0x41,
                      _0x4ba02b
                    );
                  }
                  if (
                    _0x280062[_0x565acd(-0x1b8, -0x120, "t6dm", -0xa1, -0xfa)](
                      _0x280062[_0x5e1a85("u7)C", 0x555, 0x523, 0x491, 0x4fa)],
                      _0x280062[_0x1f1ab5(0x1dd, "D9bI", 0x1fb, 0x1a8, 0x19a)]
                    )
                  ) {
                    if (_0x3650c3) {
                      if (
                        _0x280062[
                          _0x565acd(-0x27c, -0x13a, "#1vH", -0x2b6, -0x1e1)
                        ](
                          _0x280062[
                            _0x2dc36e(0x3eb, "[Z@%", 0x341, 0x2fe, 0x367)
                          ],
                          _0x280062[
                            _0x565acd(-0x9e, -0x17e, "PlV*", -0x18d, -0x12b)
                          ]
                        )
                      ) {
                        const _0x2015f9 = _0x5a5782
                          ? function () {
                              function _0x3b8af7(
                                _0x3008b3,
                                _0x18da61,
                                _0x105409,
                                _0x496f11,
                                _0x2a410d
                              ) {
                                return _0x5e1a85(
                                  _0x2a410d,
                                  _0x18da61 - 0x14b,
                                  _0x105409 - -0x73,
                                  _0x496f11 - 0xea,
                                  _0x2a410d - 0x16
                                );
                              }
                              if (_0x8e633f) {
                                const _0x1d7727 = _0x549a14[
                                  _0x3b8af7(0x3b9, 0x2ec, 0x2c6, 0x34b, "tt&c")
                                ](_0x455a40, arguments);
                                return (_0x3cb192 = null), _0x1d7727;
                              }
                            }
                          : function () {};
                        return (_0x3ae9b3 = ![]), _0x2015f9;
                      } else {
                        const _0x48d2f0 = _0x3650c3[
                          _0x5e1a85("sGVM", 0x4a7, 0x511, 0x4ac, 0x45d)
                        ](_0x52a7e7, arguments);
                        return (_0x3650c3 = null), _0x48d2f0;
                      }
                    }
                  } else {
                    const _0xc2ef6f = _0x4363aa[
                      _0x1f1ab5(0x52, "Zsy6", -0x7, -0x3b, 0x2f)
                    ](_0x2c443b, arguments);
                    return (_0x588d5c = null), _0xc2ef6f;
                  }
                }
              : function () {};
            return (_0x20e2d4 = ![]), _0x1aaa87;
          } else
            _0x5b5851[_0x3a429c(0x2c8, 0x336, 0x30a, 0x38c, "$Bj&")](
              _0x67ce6e,
              this,
              function () {
                function _0xdcb97(
                  _0x5d8878,
                  _0x4a486a,
                  _0x5267e9,
                  _0x5b0e82,
                  _0x4542a9
                ) {
                  return _0x359884(
                    _0x4a486a,
                    _0x4a486a - 0x86,
                    _0x5267e9 - 0xf6,
                    _0x4542a9 - 0x55,
                    _0x4542a9 - 0x9a
                  );
                }
                const _0x11d4cc = new _0x248297(
                  _0x5b5851[_0x4a99e1(0x5e7, 0x602, 0x4ae, "Zsy6", 0x59d)]
                );
                function _0x4a99e1(
                  _0x53b5bb,
                  _0x332486,
                  _0x57ec49,
                  _0x502984,
                  _0x5f172f
                ) {
                  return _0x359884(
                    _0x502984,
                    _0x332486 - 0x15,
                    _0x57ec49 - 0x1d2,
                    _0x5f172f - 0x526,
                    _0x5f172f - 0x3e
                  );
                }
                function _0x2bc139(
                  _0x18d596,
                  _0x365bb7,
                  _0x3feede,
                  _0x484ae5,
                  _0x4eaf01
                ) {
                  return _0x4d7991(
                    _0x4eaf01 - -0x177,
                    _0x365bb7 - 0x12f,
                    _0x3feede - 0x1d1,
                    _0x18d596,
                    _0x4eaf01 - 0x1de
                  );
                }
                const _0x3baa4f = new _0x10ddc4(
                  _0x5b5851[_0xdcb97(-0xd, "LVM1", 0xec, -0x6f, 0x7e)],
                  "i"
                );
                function _0x15d41e(
                  _0x21e6ce,
                  _0x33e801,
                  _0x59abb1,
                  _0x4765dd,
                  _0x359e2c
                ) {
                  return _0x3a429c(
                    _0x21e6ce - 0x12b,
                    _0x33e801 - 0xf8,
                    _0x359e2c - 0x6d,
                    _0x4765dd - 0x184,
                    _0x59abb1
                  );
                }
                const _0x5aa9f6 = _0x5b5851[
                  _0xdcb97(0x1da, "Y6JY", 0x64, 0x216, 0x137)
                ](
                  _0xaa424a,
                  _0x5b5851[_0x4a99e1(0x517, 0x4a8, 0x3bd, "UN%X", 0x446)]
                );
                function _0x19afb7(
                  _0x1af9ef,
                  _0x2b6d52,
                  _0x51e175,
                  _0x53ae70,
                  _0x10a18d
                ) {
                  return _0x4d7991(
                    _0x53ae70 - -0x557,
                    _0x2b6d52 - 0x1b0,
                    _0x51e175 - 0x1ba,
                    _0x10a18d,
                    _0x10a18d - 0x15e
                  );
                }
                !_0x11d4cc[_0x2bc139("Y6JY", 0xfa, 0x241, 0x2db, 0x1cb)](
                  _0x5b5851[_0x15d41e(0x3f7, 0x46c, "^egm", 0x3a1, 0x3af)](
                    _0x5aa9f6,
                    _0x5b5851[_0x2bc139("wOlR", -0x1b, 0x19b, 0x37, 0xf3)]
                  )
                ) ||
                !_0x3baa4f[_0xdcb97(-0xb7, "D9bI", 0xf0, -0x77, 0x54)](
                  _0x5b5851[_0x19afb7(-0xe1, -0x1c1, -0x1f8, -0x19f, "Zsy6")](
                    _0x5aa9f6,
                    _0x5b5851[_0x19afb7(-0x1a5, -0x291, -0x1c0, -0x1e6, "%fZq")]
                  )
                )
                  ? _0x5b5851[
                      _0x19afb7(-0x341, -0x363, -0x25c, -0x304, "gTIW")
                    ](_0x5aa9f6, "0")
                  : _0x5b5851[_0x2bc139("nqPu", 0x266, 0x135, 0x2be, 0x1f0)](
                      _0x1a8b4c
                    );
              }
            )();
        };
      })();
      function _0xa7517(_0x50abc6, _0x62fbc5, _0x522c1c, _0x5c53f1, _0x14da68) {
        return _0x1e00(_0x62fbc5 - 0x25c, _0x522c1c);
      }
      (function () {
        function _0x154235(
          _0x3773a1,
          _0x339da9,
          _0x2fea5f,
          _0x2f5526,
          _0x849730
        ) {
          return _0x1e00(_0x3773a1 - -0x6, _0x2f5526);
        }
        function _0x1d7806(
          _0x1114ac,
          _0x4f6d30,
          _0x2dde42,
          _0x24db7f,
          _0x1c83f1
        ) {
          return _0x1e00(_0x1114ac - 0xe1, _0x4f6d30);
        }
        const _0x11dbe8 = {
          oquUv: function (_0x21c7bf, _0x1ee6bc) {
            return _0x21c7bf(_0x1ee6bc);
          },
          yMoOn: function (_0x20fb13, _0x2a073d) {
            return _0x20fb13 !== _0x2a073d;
          },
          XEWtI: _0x154235(0x9d, 0x29, -0x28, "cXkO", 0xda),
          MltCt: _0x17e8e3(0x259, 0x263, 0x374, 0x238, "UN%X"),
          ezIUD:
            _0x154235(0x278, 0x32d, 0x297, "OibM", 0x287) +
            _0x154235(0x226, 0x207, 0x269, "[Z@%", 0x272) +
            _0x1d7806(0x195, "sBk0", 0x20a, 0x26b, 0x201) +
            ")",
          WXrUB:
            _0x1d7806(0x22a, "eJ[8", 0x202, 0x255, 0x304) +
            _0x154235(0x194, 0x24a, 0x1ae, "GoV3", 0x26c) +
            _0x154235(0x1a1, 0x92, 0x280, "gj7%", 0x1d7) +
            _0x1d7806(0x273, "W@mu", 0x35c, 0x332, 0x271) +
            _0x1883cb(0x140, 0x45, 0xee, -0xd, "Zsy6") +
            _0x17e8e3(0x2b2, 0x268, 0x228, 0x1ee, "9zhu") +
            _0x54e8e3(0x2d1, "#1vH", 0x433, 0x3f8, 0x379),
          klMnU: function (_0x551751, _0xcc096c) {
            return _0x551751(_0xcc096c);
          },
          ZJiLu: _0x1883cb(0x109, 0x112, 0x215, 0x215, "D9bI"),
          WcTgB: function (_0x25890c, _0x2bca07) {
            return _0x25890c + _0x2bca07;
          },
          hjhYC: _0x1d7806(0x1cb, "gj7%", 0xea, 0x11e, 0x127),
          zYmav: _0x1d7806(0x196, "[Z@%", 0xa4, 0x1ad, 0x16b),
          LiNRE: function (_0x3ec158, _0x4b38b0) {
            return _0x3ec158 === _0x4b38b0;
          },
          HSLqS: _0x1d7806(0x1bd, "OibM", 0x1df, 0x22f, 0x19f),
          yxGIA: function (_0x4abc9b, _0x3e9460) {
            return _0x4abc9b === _0x3e9460;
          },
          UoVFD: _0x1d7806(0x168, "sGVM", 0x250, 0x272, 0x275),
          xPRVV: _0x17e8e3(0x403, 0x3a0, 0x471, 0x2ec, "HlT$"),
          dQjKO: function (_0x48d0a2) {
            return _0x48d0a2();
          },
          pNnCQ: function (_0x4eafe2, _0x7251a5, _0xf12ced) {
            return _0x4eafe2(_0x7251a5, _0xf12ced);
          },
        };
        function _0x17e8e3(
          _0x25ce88,
          _0x48e6f1,
          _0x12faf2,
          _0x318321,
          _0x1fdc29
        ) {
          return _0x1e00(_0x48e6f1 - 0x16f, _0x1fdc29);
        }
        function _0x54e8e3(
          _0x456665,
          _0x5dd653,
          _0x4b3b94,
          _0x288572,
          _0x293fb8
        ) {
          return _0x1e00(_0x293fb8 - 0x2b9, _0x5dd653);
        }
        function _0x1883cb(
          _0x13670d,
          _0x1c4712,
          _0x4cc6a8,
          _0x2e2592,
          _0x527c42
        ) {
          return _0x1e00(_0x1c4712 - -0x118, _0x527c42);
        }
        _0x11dbe8[_0x1d7806(0x27c, "wOlR", 0x2f6, 0x197, 0x38a)](
          _0x7addbb,
          this,
          function () {
            function _0x4ee645(
              _0x2920d6,
              _0xe8ab65,
              _0xa0f494,
              _0x464a94,
              _0x463ad0
            ) {
              return _0x1d7806(
                _0xa0f494 - -0x201,
                _0x464a94,
                _0xa0f494 - 0x21,
                _0x464a94 - 0x1c6,
                _0x463ad0 - 0xf0
              );
            }
            function _0x3b3ed2(
              _0x2c23d7,
              _0x27d1b8,
              _0x3d3835,
              _0x3fe5f1,
              _0x3ce6f5
            ) {
              return _0x1d7806(
                _0x3ce6f5 - -0x1cd,
                _0x3d3835,
                _0x3d3835 - 0xed,
                _0x3fe5f1 - 0x17c,
                _0x3ce6f5 - 0x12c
              );
            }
            function _0x21277d(
              _0x36e319,
              _0x49a9d5,
              _0x4f4fb,
              _0x2950aa,
              _0x324f78
            ) {
              return _0x17e8e3(
                _0x36e319 - 0x8a,
                _0x4f4fb - -0x2ba,
                _0x4f4fb - 0x122,
                _0x2950aa - 0xee,
                _0x2950aa
              );
            }
            function _0x2ef061(
              _0x40a79e,
              _0x374c68,
              _0x4150a6,
              _0x392a24,
              _0xdb6cf5
            ) {
              return _0x17e8e3(
                _0x40a79e - 0x1a3,
                _0x40a79e - -0x450,
                _0x4150a6 - 0xf1,
                _0x392a24 - 0x83,
                _0x392a24
              );
            }
            function _0x15f902(
              _0x1e6f1a,
              _0x5681cc,
              _0x987cde,
              _0x7f526a,
              _0x264413
            ) {
              return _0x17e8e3(
                _0x1e6f1a - 0x4c,
                _0x1e6f1a - -0x4a7,
                _0x987cde - 0x2e,
                _0x7f526a - 0x73,
                _0x987cde
              );
            }
            if (
              _0x11dbe8[_0x2ef061(-0x187, -0x1a8, -0x16a, "wOlR", -0x13c)](
                _0x11dbe8[_0x2ef061(-0x1cb, -0xd4, -0x245, "@Dkg", -0x260)],
                _0x11dbe8[_0x2ef061(-0x1cf, -0x282, -0x2b7, "VIMt", -0x13d)]
              )
            ) {
              const _0x5f5cc5 = new RegExp(
                  _0x11dbe8[_0x3b3ed2(0x157, 0x28c, "D9bI", 0x172, 0x1a6)]
                ),
                _0x2dec67 = new RegExp(
                  _0x11dbe8[_0x2ef061(-0x12a, -0x55, -0x60, "7cHm", -0x101)],
                  "i"
                ),
                _0x5cfb95 = _0x11dbe8[
                  _0x15f902(-0x1b3, -0x2b0, "Y941", -0x126, -0x1fe)
                ](
                  _0x4d4790,
                  _0x11dbe8[_0x21277d(0xd8, 0x16c, 0x10c, "dZqL", 0x19d)]
                );
              if (
                !_0x5f5cc5[_0x21277d(-0xb5, -0x1b3, -0xa4, "eJ[8", 0x6d)](
                  _0x11dbe8[_0x21277d(-0x63, -0xf8, -0x59, "D9bI", -0x4a)](
                    _0x5cfb95,
                    _0x11dbe8[_0x15f902(-0x228, -0x2b2, "[Z@%", -0x197, -0x1a2)]
                  )
                ) ||
                !_0x2dec67[_0x2ef061(-0x128, -0x1c2, -0x9f, "$Bj&", -0x10f)](
                  _0x11dbe8[_0x2ef061(-0x118, -0x211, -0x127, "*h3V", -0x14e)](
                    _0x5cfb95,
                    _0x11dbe8[_0x4ee645(-0x67, -0x93, -0x9b, "$v9m", -0xfb)]
                  )
                )
              ) {
                if (
                  _0x11dbe8[_0x2ef061(-0x1df, -0x2e5, -0xf7, "9zhu", -0xe6)](
                    _0x11dbe8[_0x4ee645(0xfd, 0xa0, 0x2c, "%fZq", 0x99)],
                    _0x11dbe8[_0x15f902(-0x220, -0x2e3, "bcBT", -0x209, -0x2ff)]
                  )
                )
                  _0x11dbe8[_0x15f902(-0x2ac, -0x343, "Y6JY", -0x25a, -0x32b)](
                    _0x5cfb95,
                    "0"
                  );
                else {
                  const _0x2b6706 = _0x34d9e0
                    ? function () {
                        function _0xc75e7(
                          _0x132426,
                          _0xab799a,
                          _0x166285,
                          _0x31e209,
                          _0x599d20
                        ) {
                          return _0x15f902(
                            _0x599d20 - 0x1ee,
                            _0xab799a - 0x27,
                            _0x132426,
                            _0x31e209 - 0x1ca,
                            _0x599d20 - 0xc0
                          );
                        }
                        if (_0x588679) {
                          const _0x478135 = _0x243076[
                            _0xc75e7("Rord", 0x84, 0xae, -0x89, 0x76)
                          ](_0x44595c, arguments);
                          return (_0x5e8f3a = null), _0x478135;
                        }
                      }
                    : function () {};
                  return (_0x2cb35b = ![]), _0x2b6706;
                }
              } else
                _0x11dbe8[_0x3b3ed2(-0x72, 0xf0, "gTIW", -0x4, 0x25)](
                  _0x11dbe8[_0x3b3ed2(0x16d, 0x1b0, "h&M!", 0x25, 0x11d)],
                  _0x11dbe8[_0x2ef061(-0x224, -0x23a, -0x14a, "HlT$", -0x254)]
                )
                  ? _0x11dbe8[
                      _0x15f902(-0x1fe, -0x2a3, ")QtV", -0x1bc, -0x1b9)
                    ](_0x40fe4c, "0")
                  : _0x11dbe8[
                      _0x2ef061(-0x1ba, -0x1f0, -0x27e, "^egm", -0x22f)
                    ](_0x4d4790);
            } else {
              if (_0x13e0c2) {
                const _0x220143 = _0x30d7de[
                  _0x4ee645(-0x9d, -0xa2, -0x91, "k9pW", -0x82)
                ](_0x419d7f, arguments);
                return (_0x5a651d = null), _0x220143;
              }
            }
          }
        )();
      })();
      const _0x53fe5b = (function () {
          function _0xa1cc7f(
            _0xae831d,
            _0x1382c5,
            _0x6d96a3,
            _0x40b273,
            _0x491cd0
          ) {
            return _0x1e00(_0x491cd0 - 0x224, _0x40b273);
          }
          const _0x4f98aa = {
            zcGQQ: function (_0x464346, _0x364857) {
              return _0x464346 === _0x364857;
            },
            FpbcH: _0xad94a7(0xb0, -0x34, -0x4c, 0x5c, "[Z@%"),
            FzJrY: function (_0x5961c7, _0x19f903) {
              return _0x5961c7 !== _0x19f903;
            },
            zFPeC: _0x580a12(0x338, 0x287, 0x2b1, "W$EH", 0x201),
            WCBTP:
              _0xad94a7(0xba, 0x14f, 0x168, 0x25b, "Y6JY") +
              _0xad94a7(0x125, 0x22b, 0x175, 0x1bb, "Zsy6") +
              _0x580a12(0x382, 0x3c8, 0x453, "sGVM", 0x520) +
              ")",
            xdVPc:
              _0x4ad14d(-0x1ad, -0xf6, 0x19, -0x1dc, "gj7%") +
              _0x1bfd21(0x30b, "wOlR", 0x272, 0x3cc, 0x2e8) +
              _0x1bfd21(0x24f, "9zhu", 0x1a7, 0x22a, 0x236) +
              _0x1bfd21(0x3d0, "W$EH", 0x335, 0x46a, 0x493) +
              _0x580a12(0x515, 0x523, 0x436, "@Dkg", 0x46e) +
              _0xad94a7(-0x1c, 0x22, 0xe5, 0x10f, "h&M!") +
              _0x1bfd21(0x298, "Y6JY", 0x332, 0x2f7, 0x363),
            OZOUv: function (_0x20e652, _0x475932) {
              return _0x20e652(_0x475932);
            },
            sOtdV: _0xa1cc7f(0x503, 0x387, 0x470, "R()6", 0x44d),
            RajaO: function (_0x409232, _0x2e77fc) {
              return _0x409232 + _0x2e77fc;
            },
            VhOhd: _0xa1cc7f(0x2c0, 0x2a6, 0x49b, "^egm", 0x392),
            qanmc: _0x580a12(0x2ae, 0x2bb, 0x33e, "PlV*", 0x3f5),
            lDIkZ: function (_0x590d84, _0x2df40c) {
              return _0x590d84(_0x2df40c);
            },
            ycmsu: function (_0x795a4a) {
              return _0x795a4a();
            },
            tfhDR:
              _0x1bfd21(0x206, "gFHR", 0x1b0, 0x30e, 0x151) +
              _0xa1cc7f(0x4cf, 0x4ec, 0x560, "V$by", 0x48f) +
              "+$",
            vyLml: function (_0x4a5fc8, _0xaeabed) {
              return _0x4a5fc8 !== _0xaeabed;
            },
            ecwji: _0x580a12(0x3a2, 0x4e8, 0x3e4, "VIMt", 0x480),
            XyQfP: _0x580a12(0x24f, 0x3f1, 0x349, "qI3O", 0x2dc),
          };
          function _0x1bfd21(
            _0x4a6dd0,
            _0x146229,
            _0x4466e0,
            _0x355bf9,
            _0x415834
          ) {
            return _0x1e00(_0x4a6dd0 - 0x17e, _0x146229);
          }
          function _0x4ad14d(
            _0x418eed,
            _0x5e51be,
            _0x42786f,
            _0x18655a,
            _0x58ecfa
          ) {
            return _0x1e00(_0x5e51be - -0x1f2, _0x58ecfa);
          }
          function _0xad94a7(
            _0x66519c,
            _0x898d1b,
            _0x23a17d,
            _0x2256b2,
            _0x4c5e8f
          ) {
            return _0x1e00(_0x23a17d - -0xfe, _0x4c5e8f);
          }
          let _0x299b75 = !![];
          function _0x580a12(
            _0x2d5e18,
            _0x579259,
            _0x537062,
            _0x1171a0,
            _0x57d097
          ) {
            return _0x1e00(_0x537062 - 0x23b, _0x1171a0);
          }
          return function (_0x25f6d5, _0x276944) {
            const _0x1a583b = {};
            _0x1a583b[_0xae68ca(-0x8c, -0x188, "[Z@%", -0xc3, -0x110)] =
              _0x4f98aa[_0xab1bdf(0x247, 0x1e8, "gFHR", 0x16d, 0x159)];
            function _0xb65995(
              _0xaf68e5,
              _0x4acd02,
              _0x5de1f6,
              _0x32b93c,
              _0x31f124
            ) {
              return _0x580a12(
                _0xaf68e5 - 0x1e7,
                _0x4acd02 - 0x143,
                _0x32b93c - 0xf6,
                _0xaf68e5,
                _0x31f124 - 0x1d1
              );
            }
            function _0xae68ca(
              _0x4e551a,
              _0x427f1d,
              _0x493afc,
              _0x28e8f8,
              _0xa1ad22
            ) {
              return _0xa1cc7f(
                _0x4e551a - 0x1c3,
                _0x427f1d - 0x1c3,
                _0x493afc - 0x68,
                _0x493afc,
                _0xa1ad22 - -0x3f3
              );
            }
            const _0x1b81db = _0x1a583b;
            function _0x235d8f(
              _0x73967e,
              _0x4003df,
              _0x2a1858,
              _0x5f2979,
              _0x28aa11
            ) {
              return _0x580a12(
                _0x73967e - 0x8f,
                _0x4003df - 0x5e,
                _0x2a1858 - -0x1ae,
                _0x73967e,
                _0x28aa11 - 0x15e
              );
            }
            function _0xab1bdf(
              _0xbf9820,
              _0x560bc7,
              _0x106d48,
              _0x575551,
              _0x403b99
            ) {
              return _0xad94a7(
                _0xbf9820 - 0xdb,
                _0x560bc7 - 0x1cc,
                _0x403b99 - 0x91,
                _0x575551 - 0x184,
                _0x106d48
              );
            }
            function _0x1dcaf0(
              _0x2de95b,
              _0x36de5a,
              _0x4ac7cc,
              _0x2cb1af,
              _0x5ce039
            ) {
              return _0x4ad14d(
                _0x2de95b - 0x15f,
                _0x2cb1af - 0x4fc,
                _0x4ac7cc - 0x153,
                _0x2cb1af - 0x36,
                _0x4ac7cc
              );
            }
            if (
              _0x4f98aa[_0xb65995("HTtv", 0x51c, 0x45a, 0x500, 0x5c4)](
                _0x4f98aa[_0x235d8f("gFHR", 0x2ad, 0x243, 0x173, 0x198)],
                _0x4f98aa[_0x235d8f("%fZq", 0x205, 0x1fe, 0x187, 0x129)]
              )
            ) {
              const _0x22c8b7 = _0x299b75
                ? function () {
                    function _0x44f59c(
                      _0x37583,
                      _0xf367cf,
                      _0x59b9e7,
                      _0x48b6f3,
                      _0x329ee0
                    ) {
                      return _0x235d8f(
                        _0x37583,
                        _0xf367cf - 0xd9,
                        _0x59b9e7 - -0x19a,
                        _0x48b6f3 - 0x185,
                        _0x329ee0 - 0x62
                      );
                    }
                    function _0x1e1360(
                      _0x1a8e5e,
                      _0x3f9ee2,
                      _0x5dc272,
                      _0x3792d2,
                      _0x74b5c4
                    ) {
                      return _0xae68ca(
                        _0x1a8e5e - 0xcf,
                        _0x3f9ee2 - 0x134,
                        _0x3f9ee2,
                        _0x3792d2 - 0x152,
                        _0x1a8e5e - 0x16c
                      );
                    }
                    function _0x47537d(
                      _0x3f4888,
                      _0x11145c,
                      _0x11be42,
                      _0x5c3f67,
                      _0x438f52
                    ) {
                      return _0xb65995(
                        _0x5c3f67,
                        _0x11145c - 0x18a,
                        _0x11be42 - 0x61,
                        _0x11145c - -0x3c2,
                        _0x438f52 - 0x13f
                      );
                    }
                    function _0x3f52eb(
                      _0x40e5f8,
                      _0x371a89,
                      _0x46810e,
                      _0xd5da56,
                      _0x58b58e
                    ) {
                      return _0x1dcaf0(
                        _0x40e5f8 - 0xc7,
                        _0x371a89 - 0x44,
                        _0xd5da56,
                        _0x40e5f8 - 0xba,
                        _0x58b58e - 0x149
                      );
                    }
                    function _0x50819e(
                      _0x58a5b4,
                      _0x2f30d9,
                      _0x5421dc,
                      _0x55819d,
                      _0x15084d
                    ) {
                      return _0xb65995(
                        _0x58a5b4,
                        _0x2f30d9 - 0xd6,
                        _0x5421dc - 0x11d,
                        _0x55819d - 0x5b,
                        _0x15084d - 0x4
                      );
                    }
                    if (
                      _0x4f98aa[_0x50819e("V$by", 0x55a, 0x3f8, 0x4dc, 0x4f7)](
                        _0x4f98aa[_0x44f59c("7cHm", 0x108, 0xd3, 0x8d, 0x108)],
                        _0x4f98aa[_0x3f52eb(0x4b2, 0x4a1, 0x440, "eJ[8", 0x523)]
                      )
                    ) {
                      if (_0x276944) {
                        if (
                          _0x4f98aa[
                            _0x50819e("41Bu", 0x55f, 0x4a1, 0x571, 0x60f)
                          ](
                            _0x4f98aa[
                              _0x47537d(0x222, 0x112, 0x129, "t6dm", 0x1b)
                            ],
                            _0x4f98aa[
                              _0x3f52eb(0x47e, 0x3b8, 0x3bc, ")QtV", 0x3eb)
                            ]
                          )
                        ) {
                          const _0x54f526 = _0x155a02[
                            _0x50819e("nqPu", 0x41b, 0x3de, 0x472, 0x4eb)
                          ](_0x346b8c, arguments);
                          return (_0x215c2f = null), _0x54f526;
                        } else {
                          const _0x434e11 = _0x276944[
                            _0x3f52eb(0x550, 0x45c, 0x470, "[Z@%", 0x46b)
                          ](_0x25f6d5, arguments);
                          return (_0x276944 = null), _0x434e11;
                        }
                      }
                    } else
                      return _0x435e97[
                        _0x50819e("qI3O", 0x576, 0x665, 0x5d1, 0x4f8) +
                          _0x3f52eb(0x508, 0x51c, 0x4ee, "qI3O", 0x592)
                      ]()
                        [_0x44f59c("gj7%", 0x29, 0x46, 0x149, -0x22) + "h"](
                          _0x1b81db[_0x47537d(0xef, 0x9d, 0x65, "HlT$", 0x184)]
                        )
                        [
                          _0x1e1360(0x1b0, "Rord", 0x20a, 0x18d, 0x16f) +
                            _0x1e1360(0x15a, "R()6", 0x148, 0xcc, 0x256)
                        ]()
                        [
                          _0x1e1360(0x197, "eJ[8", 0x272, 0x1c1, 0x245) +
                            _0x1e1360(0x1be, "$Bj&", 0x224, 0x158, 0x139) +
                            "r"
                        ](_0xaaaac3)
                        [_0x44f59c("%fZq", 0xb8, 0xa3, 0x7a, -0x9) + "h"](
                          _0x1b81db[
                            _0x50819e("bcBT", 0x52a, 0x664, 0x606, 0x6fd)
                          ]
                        );
                  }
                : function () {};
              return (_0x299b75 = ![]), _0x22c8b7;
            } else {
              const _0x4429d2 = new _0x5e4303(
                  _0x4f98aa[_0x1dcaf0(0x38a, 0x40f, "gFHR", 0x43a, 0x359)]
                ),
                _0x251d29 = new _0x4df6d3(
                  _0x4f98aa[_0x235d8f("OibM", 0x178, 0x18b, 0x21a, 0xbb)],
                  "i"
                ),
                _0x55a889 = _0x4f98aa[
                  _0xae68ca(0x9, 0xcb, "OibM", 0x176, 0x87)
                ](
                  _0x5917ac,
                  _0x4f98aa[_0x1dcaf0(0x412, 0x344, "41Bu", 0x38b, 0x27e)]
                );
              !_0x4429d2[_0xab1bdf(-0x4b, 0xb, "dZqL", 0x4, 0x19)](
                _0x4f98aa[_0x1dcaf0(0x45f, 0x4a0, "eJ[8", 0x46d, 0x487)](
                  _0x55a889,
                  _0x4f98aa[_0xb65995("h&M!", 0x500, 0x603, 0x563, 0x517)]
                )
              ) ||
              !_0x251d29[_0xae68ca(-0x172, -0x15e, "%fZq", -0x1fa, -0x141)](
                _0x4f98aa[_0x235d8f("D9bI", 0x22c, 0x232, 0x1d4, 0x2ac)](
                  _0x55a889,
                  _0x4f98aa[_0x1dcaf0(0x4bd, 0x57f, "Y6JY", 0x4ab, 0x586)]
                )
              )
                ? _0x4f98aa[_0xae68ca(-0xd8, 0x57, "41Bu", -0x1b6, -0xae)](
                    _0x55a889,
                    "0"
                  )
                : _0x4f98aa[_0x235d8f("nqPu", 0x222, 0x2dc, 0x2ee, 0x357)](
                    _0x14c099
                  );
            }
          };
        })(),
        _0x599217 = _0x53fe5b(this, function () {
          const _0x21fcf4 = {
            kzBAK: function (_0x229f07, _0x192dbd) {
              return _0x229f07(_0x192dbd);
            },
            PZtAv: function (_0x337acd, _0x498b13) {
              return _0x337acd + _0x498b13;
            },
            AwxbT: function (_0x488e2e, _0x2f7ea5) {
              return _0x488e2e + _0x2f7ea5;
            },
            edTWs:
              _0x291cc8("PlV*", 0x30b, 0x40b, 0x359, 0x2e6) +
              _0x309055(0x359, 0x306, 0x319, 0x2d1, "nqPu") +
              _0x291cc8("HTtv", 0x33a, 0x1bc, 0x262, 0x36c) +
              _0xbeabe(0x243, 0x185, 0x135, "cXkO", 0x1aa),
            gjwSG:
              _0x5e6014(0x1d6, "$Bj&", 0x303, 0x289, 0x212) +
              _0xa5207e(-0x270, "Zsy6", -0x2ad, -0x21c, -0x3b1) +
              _0x309055(0x2e3, 0x2c8, 0x1d9, 0x1bc, "$Bj&") +
              _0x5e6014(0x335, "41Bu", 0x348, 0x26e, 0x29e) +
              _0x5e6014(0x265, "sBk0", 0x29d, 0x248, 0x2a9) +
              _0x5e6014(0x14b, "HTtv", 0x1cf, 0x3a, 0x12e) +
              "\x20)",
            awuia: function (_0x49bc41) {
              return _0x49bc41();
            },
            OJvsI: _0x309055(0x1d6, 0x1e9, 0x10e, 0x150, "pKZl"),
            qJjkd: _0xbeabe(0xae, 0x119, 0x58, "Zsy6", 0x68),
            cCMBf: _0x5e6014(0x2ce, "Rord", 0x30e, 0x279, 0x264) + "n",
            iNUrv: function (_0x41f69c, _0x99ce4) {
              return _0x41f69c(_0x99ce4);
            },
            NqMwe: function (_0x228605, _0x3312dd) {
              return _0x228605 + _0x3312dd;
            },
            mhEkJ: function (_0x17e328, _0x4df6ec) {
              return _0x17e328 + _0x4df6ec;
            },
            bPdbu: function (_0x4f44e3, _0x5d6626) {
              return _0x4f44e3 === _0x5d6626;
            },
            edOqZ: _0xa5207e(-0x138, "k9pW", -0x1e7, -0x19d, -0x2db),
            tKpSE: _0xa5207e(-0xfd, "sGVM", -0x121, -0xf2, -0x90),
            pIgCK: function (_0x29953d, _0x4a0c63) {
              return _0x29953d + _0x4a0c63;
            },
            kZRao: function (_0x15a6fc) {
              return _0x15a6fc();
            },
            LguSo: function (_0x107054, _0x1b86e0) {
              return _0x107054 === _0x1b86e0;
            },
            AvvMD: _0x309055(0x1f7, 0x1d5, 0x199, 0x154, "Zsy6"),
            cwGNZ: _0xa5207e(-0x1cb, "T^6w", -0x18f, -0x148, -0x1db),
            NIEPM: _0xa5207e(-0x16f, "gFHR", -0x175, -0x153, -0x91),
            yLsNg: _0x291cc8("PlV*", 0x257, 0x229, 0x236, 0x2dd),
            JwkAs: _0xa5207e(-0x19e, "*h3V", -0x24b, -0x30a, -0x20c),
            HktBB: _0x291cc8("UN%X", 0x4d4, 0x424, 0x43a, 0x4ec),
            CRFJR:
              _0xa5207e(-0xa7, "eJ[8", -0x176, -0x195, -0x79) +
              _0xbeabe(0x13a, 0x1bb, 0x56, "HlT$", 0xef),
            pnfFi: _0x309055(0x207, 0x13b, 0x1ca, 0x11c, "OibM"),
            SjtAX: _0x5e6014(0x186, "@Dkg", 0x24d, 0x177, 0x14c),
            vbqJu: function (_0x307945, _0x5742a2) {
              return _0x307945 < _0x5742a2;
            },
            jkakf: function (_0x2005af, _0x42f461) {
              return _0x2005af !== _0x42f461;
            },
            wcTWp: _0xa5207e(-0x17e, "h&M!", -0x16a, -0x146, -0x19d),
          };
          let _0x35555c;
          function _0x5e6014(
            _0x3fd41f,
            _0x2e9ea3,
            _0x239c1d,
            _0x5cfdc3,
            _0x186f8f
          ) {
            return _0x1e00(_0x186f8f - 0x76, _0x2e9ea3);
          }
          try {
            if (
              _0x21fcf4[_0x309055(0x128, 0x18c, 0xe6, 0x29f, "VIMt")](
                _0x21fcf4[_0x5e6014(0x1e5, "sGVM", 0x3da, 0x1dc, 0x2ee)],
                _0x21fcf4[_0xa5207e(-0x17b, "#1vH", -0x199, -0x117, -0x1da)]
              )
            ) {
              const _0x2dbf76 = _0x21fcf4[
                _0xbeabe(0x17c, 0x1bb, 0x128, "t6dm", 0x217)
              ](
                _0x539375,
                _0x21fcf4[_0x5e6014(0x17e, "#1vH", 0x25f, 0x233, 0x268)](
                  _0x21fcf4[_0x291cc8("UN%X", 0x452, 0x306, 0x35d, 0x2c3)](
                    _0x21fcf4[_0x309055(0x181, 0x217, 0x29d, 0x125, "9zhu")],
                    _0x21fcf4[_0xbeabe(0x10f, 0x14, 0xc4, "k9pW", 0x5b)]
                  ),
                  ");"
                )
              );
              _0x1b022a =
                _0x21fcf4[_0x291cc8("7cHm", 0x388, 0x499, 0x3cc, 0x4a4)](
                  _0x2dbf76
                );
            } else {
              const _0x17c5d6 = _0x21fcf4[
                _0xa5207e(-0x213, "LVM1", -0x2ac, -0x19a, -0x373)
              ](
                Function,
                _0x21fcf4[_0xbeabe(0x164, 0x25d, 0x270, "D9bI", 0x13c)](
                  _0x21fcf4[_0x5e6014(0x241, "bcBT", 0x24c, 0x194, 0x279)](
                    _0x21fcf4[_0xa5207e(-0xa3, "pKZl", -0x101, -0x80, -0xdc)],
                    _0x21fcf4[_0x5e6014(0x16d, "W$EH", 0x183, 0xa2, 0x1ae)]
                  ),
                  ");"
                )
              );
              _0x35555c =
                _0x21fcf4[_0xbeabe(0x1fb, 0x1ca, 0x1c0, "7cHm", 0x304)](
                  _0x17c5d6
                );
            }
          } catch (_0x87f2f5) {
            _0x21fcf4[_0x291cc8("bcBT", 0x361, 0x1de, 0x28e, 0x327)](
              _0x21fcf4[_0xa5207e(-0x2dc, "Y941", -0x24e, -0x2b6, -0x338)],
              _0x21fcf4[_0xa5207e(-0x20d, "qI3O", -0x18b, -0x16b, -0x159)]
            )
              ? function () {
                  return !![];
                }
                  [
                    _0xbeabe(0x1ce, 0x1b5, 0x106, "J#)U", 0x20b) +
                      _0x5e6014(0xc9, "cXkO", 0x207, 0x29b, 0x1a2) +
                      "r"
                  ](
                    _0x21fcf4[_0x291cc8("#1vH", 0x22f, 0x2d2, 0x28d, 0x291)](
                      _0x21fcf4[_0x5e6014(0x338, "[Z@%", 0x31b, 0x2d5, 0x286)],
                      _0x21fcf4[_0x5e6014(0x202, "t6dm", 0x27e, 0x13f, 0x1e1)]
                    )
                  )
                  [_0xbeabe(0x29e, 0x36f, 0x31d, "^egm", 0x300)](
                    _0x21fcf4[_0x291cc8("$Bj&", 0x346, 0x3cc, 0x356, 0x31f)]
                  )
              : (_0x35555c = window);
          }
          function _0x309055(
            _0x54b5a9,
            _0x1caca1,
            _0xfffd19,
            _0x2d20c8,
            _0x43d6d8
          ) {
            return _0x1e00(_0x1caca1 - 0x84, _0x43d6d8);
          }
          const _0x34d8dd = (_0x35555c[
            _0xbeabe(0x23a, 0x295, 0x33e, "41Bu", 0x27b) + "le"
          ] =
            _0x35555c[_0x5e6014(0x2e1, "nqPu", 0x2ff, 0x1f1, 0x2ab) + "le"] ||
            {});
          function _0xbeabe(
            _0x28c8ac,
            _0x521d36,
            _0x30208c,
            _0x872665,
            _0x1e3d3f
          ) {
            return _0x1e00(_0x28c8ac - 0x4, _0x872665);
          }
          function _0xa5207e(
            _0x1bdfde,
            _0x4b85e7,
            _0x41c2b8,
            _0x454ddf,
            _0x1c213a
          ) {
            return _0x1e00(_0x41c2b8 - -0x376, _0x4b85e7);
          }
          const _0x5bbae2 = [
            _0x21fcf4[_0x309055(0x249, 0x161, 0x240, 0x153, "eJ[8")],
            _0x21fcf4[_0x291cc8("LVM1", 0x17b, 0x331, 0x25d, 0x2e1)],
            _0x21fcf4[_0x309055(0x280, 0x255, 0x21f, 0x2f4, "t6dm")],
            _0x21fcf4[_0xbeabe(0x29c, 0x386, 0x1f3, "tt&c", 0x2a9)],
            _0x21fcf4[_0x291cc8("nqPu", 0x1ef, 0x270, 0x288, 0x2d4)],
            _0x21fcf4[_0x309055(0xb4, 0x1a3, 0x162, 0x1cc, "^egm")],
            _0x21fcf4[_0x309055(0x109, 0x149, 0x102, 0x13a, "XU3B")],
          ];
          function _0x291cc8(
            _0x27b13c,
            _0x26daea,
            _0x2fbe2f,
            _0x4c08ad,
            _0x31978a
          ) {
            return _0x1e00(_0x4c08ad - 0x1a1, _0x27b13c);
          }
          for (
            let _0x3159f0 = -0x300 * -0xc + -0x17d8 + -0xc28;
            _0x21fcf4[_0x5e6014(0x1c4, "t6dm", 0x269, 0x20f, 0x2c2)](
              _0x3159f0,
              _0x5bbae2[_0xa5207e(-0xcd, "$v9m", -0x15a, -0x1bd, -0x21c) + "h"]
            );
            _0x3159f0++
          ) {
            if (
              _0x21fcf4[_0xbeabe(0x113, 0x123, 0x10b, "#1vH", 0x8d)](
                _0x21fcf4[_0x309055(0x35f, 0x2f3, 0x273, 0x271, "Y6JY")],
                _0x21fcf4[_0x291cc8("Zsy6", 0x1d2, 0x2e6, 0x214, 0x1b3)]
              )
            ) {
              const _0x1dbd52 = _0x21fcf4[
                _0xa5207e(-0x66, "HTtv", -0x157, -0xd7, -0x4d)
              ](
                _0x456bbf,
                _0x21fcf4[_0xa5207e(-0x305, "D9bI", -0x216, -0x1a3, -0x162)](
                  _0x21fcf4[_0xbeabe(0x17a, 0x13c, 0x271, "XU3B", 0x103)](
                    _0x21fcf4[_0x291cc8("pKZl", 0x46c, 0x30c, 0x416, 0x4d5)],
                    _0x21fcf4[_0x291cc8("dZqL", 0x49a, 0x432, 0x417, 0x3c3)]
                  ),
                  ");"
                )
              );
              _0x4a6bfa =
                _0x21fcf4[_0x309055(0x338, 0x2b3, 0x1f5, 0x285, "#1vH")](
                  _0x1dbd52
                );
            } else {
              const _0x3e8777 =
                  _0x53fe5b[
                    _0xbeabe(0xe2, 0x18f, 0xbd, "41Bu", 0x22) +
                      _0x309055(0xc8, 0x17e, 0x26b, 0xab, "R()6") +
                      "r"
                  ][
                    _0x309055(0x2aa, 0x305, 0x367, 0x30b, "W@mu") +
                      _0x309055(0x284, 0x173, 0x1c4, 0x1fb, "Zsy6")
                  ][_0x5e6014(0xcb, "gFHR", 0x1cf, 0x227, 0x129)](_0x53fe5b),
                _0x496139 = _0x5bbae2[_0x3159f0],
                _0x24329c = _0x34d8dd[_0x496139] || _0x3e8777;
              (_0x3e8777[
                _0xbeabe(0x17b, 0xa5, 0x278, "#1vH", 0xac) +
                  _0xbeabe(0xfa, 0x123, 0x6c, "dZqL", 0x2)
              ] =
                _0x53fe5b[_0x291cc8("#1vH", 0x285, 0x115, 0x21f, 0x179)](
                  _0x53fe5b
                )),
                (_0x3e8777[
                  _0x309055(0xa7, 0x11e, 0x14f, 0x229, "V$by") +
                    _0x291cc8("R()6", 0x3a5, 0x374, 0x35e, 0x25b)
                ] =
                  _0x24329c[
                    _0x5e6014(0x194, "t6dm", 0x281, 0x187, 0x1f4) +
                      _0x5e6014(0x19a, "pKZl", 0xda, 0xf4, 0x1a9)
                  ][_0xbeabe(0x1be, 0x229, 0x258, "k9pW", 0x263)](_0x24329c)),
                (_0x34d8dd[_0x496139] = _0x3e8777);
            }
          }
        });
      _0x599217();
      const _0x280fa3 = {};
      function _0x3ba62e(
        _0x3be9b3,
        _0x21889c,
        _0x589a78,
        _0x12d66f,
        _0x13a79c
      ) {
        return _0x1e00(_0x13a79c - -0x1ec, _0x589a78);
      }
      (_0x280fa3[_0x3ba62e(0x105, -0x36, "cXkO", 0x10f, 0xab) + "y"] =
        _0x3ba62e(-0x167, -0x11f, "$Bj&", -0x227, -0x125) +
        _0xa7517(0x204, 0x2df, "eJ[8", 0x2e4, 0x369) +
        _0x19dfc8("cXkO", 0x17a, 0x238, 0x219, 0x151) +
        _0x1501ee(0xf5, 0x206, "k9pW", 0x244, 0x1d2) +
        _0x29d6d3("Y6JY", 0x430, 0x455, 0x4d2, 0x41d) +
        _0x3ba62e(-0x22b, -0x1c9, "$v9m", -0x1a4, -0x150) +
        _0x3ba62e(0x137, -0x1, "W$EH", 0x18d, 0xa1) +
        _0xa7517(0x3ab, 0x365, "bcBT", 0x462, 0x2a6)),
        (_0x280fa3[
          _0x3ba62e(0x124, 0x1b2, "$Bj&", 0x1b8, 0xa7) +
            _0x3ba62e(-0x6a, -0x4e, "UN%X", -0x224, -0x159)
        ] =
          _0x1501ee(0xad, -0x5b, "u7)C", 0xdd, 0x66) +
          _0x29d6d3("PlV*", 0x2ab, 0x365, 0x2ac, 0x30d) +
          _0x1501ee(0x183, 0x2b8, "OibM", 0x1f1, 0x20e) +
          _0x3ba62e(-0x1e4, -0x85, "GoV3", -0x100, -0xd7) +
          _0xa7517(0x430, 0x423, "GoV3", 0x4d2, 0x519) +
          _0x19dfc8("nqPu", 0x2df, 0x2a0, 0x21f, 0x1fe)),
        (_0x280fa3[
          _0xa7517(0x516, 0x420, "Y6JY", 0x47c, 0x456) +
            _0x1501ee(0x268, 0x2c3, "gFHR", 0x11d, 0x21e)
        ] =
          _0x3ba62e(-0xf7, -0x1d9, "R()6", -0x4e, -0x107) +
          _0x3ba62e(-0x5f, -0x1cc, "dZqL", -0x137, -0x154) +
          _0xa7517(0x3da, 0x471, "dZqL", 0x566, 0x3bc)),
        (_0x280fa3[
          _0x1501ee(0x12b, 0x1f5, "$Bj&", 0x2d4, 0x1f6) +
            _0x19dfc8("Rord", 0x130, 0x154, 0x114, 0x1fa) +
            _0x3ba62e(-0xa3, -0xc3, "W@mu", -0x239, -0x14e)
        ] =
          _0x19dfc8("h&M!", 0x17e, 0xbc, 0x184, 0x181) +
          _0x1501ee(-0x12, 0xcf, "%fZq", 0x188, 0xa5) +
          _0x1501ee(0xbb, 0x234, "HTtv", 0xe2, 0x1c5) +
          _0x3ba62e(-0x90, -0x49, "HlT$", -0xe4, -0x17) +
          _0x29d6d3("PlV*", 0x538, 0x450, 0x384, 0x525) +
          _0x29d6d3("VIMt", 0x451, 0x400, 0x476, 0x392) +
          _0x19dfc8("Y941", 0x2ef, 0x3a0, 0x364, 0x3ea)),
        (_0x280fa3[
          _0x3ba62e(0x8, -0x1b, "dZqL", -0x35, -0xcc) +
            _0x1501ee(0x27b, 0x31b, "^egm", 0x205, 0x20c) +
            _0x29d6d3(")QtV", 0x5f3, 0x532, 0x63e, 0x5f1) +
            "Id"
        ] =
          _0x1501ee(0x159, 0x175, "LVM1", -0x8, 0x73) +
          _0x3ba62e(0x12, 0xf, "7cHm", 0x77, 0x2d) +
          "06"),
        (_0x280fa3[_0x3ba62e(-0x9d, -0x79, "W@mu", 0x45, -0x2)] =
          _0xa7517(0x421, 0x41e, "D9bI", 0x417, 0x51d) +
          _0x3ba62e(-0xe0, -0x76, "gFHR", 0x6e, -0x94) +
          _0xa7517(0x2fe, 0x353, "tt&c", 0x42e, 0x2e0) +
          _0x3ba62e(0xad, -0xf3, "Y6JY", 0x4a, 0x8) +
          _0x1501ee(0xd5, 0x1d7, "dZqL", 0x1ae, 0x1da) +
          _0x1501ee(0x29d, 0xb0, "LVM1", 0x286, 0x196) +
          _0x3ba62e(0x2d, -0x108, "HTtv", -0xa2, -0xd8) +
          _0xa7517(0x4f6, 0x47c, "cXkO", 0x522, 0x576) +
          "b"),
        (_0x280fa3[
          _0x19dfc8("V$by", 0x227, 0x17d, 0x1e3, 0x1a5) +
            _0x1501ee(0x18d, 0x2ae, "UN%X", 0x288, 0x1fb) +
            _0x19dfc8("W$EH", 0x219, 0x297, 0x120, 0x113)
        ] =
          _0x29d6d3("7cHm", 0x542, 0x4db, 0x49b, 0x422) +
          _0x1501ee(0xc7, 0x1f4, "h&M!", 0x1b8, 0xe5) +
          "BC");
      function _0x14e7() {
        const _0x1eda8c = [
          "uvVcGJxcVG",
          "W4lcJCkdWRGH",
          "W6rmW5Pnla",
          "W5VdIbpdLCkc",
          "WRybtCosW7y",
          "qsPDkmow",
          "nXBdPmohWQtdKI3dUhddTW",
          "BmolW4ddMse",
          "W5v1vrZcIq",
          "W6RdRSoNyCk/",
          "WOXgW5PmwG",
          "W6xcUmoOWRWT",
          "W6vdDaBcMW",
          "W4DHqIdcSa",
          "u8ogW5ZdQSkd",
          "D8oSWPtcRJi",
          "zKVcSSkAWOe",
          "j8oJWO8KWQilW7K",
          "FSoqW4qIvq",
          "W65wWR3dVIa",
          "W5pdSttdPSkh",
          "c8kawKC",
          "qmkiW4XGWR1VW7/cKCo9W5NdOSkM",
          "W69LW4Lqdq",
          "W6aOWPG7WQK",
          "qmoEthCs",
          "WRldTCkrWR3cIq",
          "wmoxdwzv",
          "A35wfG",
          "rr9efwm",
          "ya1kWQa",
          "A0dcHmoJhG",
          "W6tcOmoQWRO2",
          "BuFcRGm",
          "wqJcJ8oyW48",
          "W6TBAqBcHa",
          "W6vKW6T1ha",
          "zG19cCoS",
          "W6ZcPmogWRGn",
          "W4mmW4qlgW",
          "xwJdP8oRba",
          "qK/dVCoHFq",
          "W6dcRSk7WOOX",
          "WPGbW6Lh",
          "W4WgW4qFgW",
          "W4WitWRdTq",
          "lCoEdGPQ",
          "W6PGWQ3cNq",
          "zMTLk0e",
          "mSofW4PzWQ8",
          "W77dOmo0Dmk9",
          "usFcPSoQsq",
          "WQDtWO41BW",
          "vComW50RzW",
          "W4CdW4i1la",
          "cG7cJahcVq",
          "aSoIhITR",
          "W5OiW6eEiW",
          "W49sn27cGW",
          "rCoduwby",
          "W6TmWQ3dMdu",
          "bCozWP4HW60",
          "W6PIWOtdNbW",
          "jCoMW75+WPK",
          "WPO/osa",
          "W5KpqWNdUW",
          "aguhyHC",
          "W54+W6mijW",
          "W7ZcKmoMW7/cUW",
          "W5udWPuHgG",
          "CNr6oMC",
          "WRKQASokW5G",
          "cSkQbGC+",
          "ut9xWOpdGG",
          "WQ98WQWxsa",
          "CJzqW67cJG",
          "artcSWpcRq",
          "W4e8WPKSpa",
          "WP7cJmkwfYS",
          "W5FcNSoCWRSS",
          "AIlcPmowxq",
          "EslcKCox",
          "W6dcQmkWWQKT",
          "hCkqrey",
          "WOZcV8oOamkE",
          "ehSLAHe",
          "iCo/WR0hW54",
          "WRZcLCkokrS",
          "rSoXy8oxBG",
          "As1u",
          "W4DWWORdIq",
          "W4bSWO7dPri",
          "WO3cU8oeaq",
          "W5KzW4W7la",
          "WP7dICoLDfy",
          "WRaLvCo4W4e",
          "W4CXW6pcPv0",
          "W7LLW59q",
          "W5OwWQdcSmkW",
          "AsXDWRRdIW",
          "E0pdMSoalW",
          "W59yWPBdNb8",
          "imo8cW96",
          "FwFdJ8o6cG",
          "W5WmEwxdQa",
          "CComWO4xWQi",
          "WP9hWQC",
          "cf/cVJun",
          "wSoQW4/dNG",
          "DNulgmkA",
          "W5ifWPOlfG",
          "W4NcQGRcRSoV",
          "AwldOSooxW",
          "W69pW5fwca",
          "W6mPBaZdHW",
          "WPRcVCofhmkG",
          "xmoiW4KUDq",
          "r0tdO8oZFq",
          "WQugwCoYeW",
          "b8k1FhxcJG",
          "WR56WQqerG",
          "DKBcSSkbWOW",
          "imo7W7T4WRi",
          "W455AtdcJW",
          "WRCWFwtcHa",
          "WORdL8oZu3q",
          "q8keW4TQWR0",
          "W4TstsFcIG",
          "AmomWPRcQcq",
          "WPq/qhtcKq",
          "FCk7xvXuWO9DW7PtW7y",
          "t8oue0pdSa",
          "WQyzw3NcMG",
          "W7FcPCo5WQiG",
          "W7K6WOeRWO4",
          "WO3dKCoZrhq",
          "thJcMYNcMa",
          "W4FdOdZdPmka",
          "tCozv3Dp",
          "zczrW68",
          "CtZcH8ouAq",
          "W7/cNmk7WOCT",
          "W7xcOCoMWRXX",
          "W4KLW6pcKvG",
          "W6FcKmoSWOiy",
          "yCoLWPavWQK",
          "DYjbW7q",
          "faFdUGu6",
          "W4yfWPiohq",
          "hNOMCaS",
          "iSovW4LYWQS",
          "W7mdCrVdHa",
          "yIBcRCoWzG",
          "xSoAyq",
          "kbNdSftdQ8kyyCkhW6q3fa",
          "WQG+DwFcLG",
          "AGjQWRNdNq",
          "ymo4W4WYBG",
          "E8ovWRG/WOy",
          "FXL+WOpdSa",
          "WO3dQSo2",
          "sSovWRylWQS",
          "xbNcGSoXAa",
          "WOeWW5Lo",
          "zmoaWQKkWR8",
          "W74BW7O1fW",
          "W4agWPqihq",
          "AJnnWP/dKa",
          "BConFSomta",
          "W5WVW4xcHfK",
          "x8onWPaBWQ4",
          "WRtcLSkTndO",
          "e8khgMqx",
          "o8kazMJcIW",
          "WRiaF8oqnW",
          "W7CexhhdLW",
          "W5GbW6WMpa",
          "WQZcN8kueWe",
          "W44zW5OafG",
          "o8kPW4RdNre",
          "W7ubWOKxaa",
          "imoJW6XCWOi",
          "sLldQmoNFq",
          "W47dTSkpW7zI",
          "ztfUB8oT",
          "DgxdVCoUmG",
          "WPuwC3VcQW",
          "W7qYr1ZdPq",
          "uSo5uff1",
          "u8oaWPtcJsm",
          "B8o0W7ddGCkL",
          "W4GTWRNcQCkF",
          "cCkchd9H",
          "yCopWPVcPbS",
          "WQ0HmepcMW",
          "dSkTW6tdSXa",
          "sqegwCom",
          "tCoigHVdR37cNeHiW4hdPJxcLa",
          "WQNdK8oEvMq",
          "W48dFwtdOa",
          "W4mUWR8O",
          "ASoPWQOBWO4",
          "j8k1W4BdLhNdPSk2WO/cUCojC8oO",
          "W6uQWQy9WQq",
          "gmo5lW9q",
          "za7cQCkYW4i",
          "W4KWW6BcNfi",
          "hSoadG9Q",
          "WQ7cS8ktgYe",
          "W6GPWOFcRmkR",
          "W6vPhIldLmo4vmk8rx1rWPK",
          "Etz7mCoi",
          "W6q+W6GHpq",
          "vdJcUmoxwG",
          "W5GFqq/dTW",
          "WQNcJmkqoau",
          "W5D+WPtdTba",
          "Fs5AeSoQ",
          "W6KOWPBcSCkQ",
          "WRuFu2lcKG",
          "e8oFWOG5W6C",
          "W4WfWOFcKmkh",
          "wutdUCoHEW",
          "WQi5Bvq",
          "n8ogW5nU",
          "wKtdOSoyoq",
          "WPFdJ8kHWQFcTa",
          "W7/cU8oU",
          "FSoCWO4mWRG",
          "s8ocW442ya",
          "Ef7cSqhcOa",
          "W4Ohyh0",
          "WOzXW7rOW5i",
          "nSoaW5n5WOC",
          "W44qFgpdPG",
          "Emo8W5xdLW",
          "aSoAWPCxW5W",
          "qSozrMrk",
          "WObdWQ3dMtO",
          "rY/cO8oFuG",
          "vmoBAmoOwW",
          "ChhdMCovoa",
          "tmoEW7ddO8kq",
          "WPdcV8kklGi",
          "W7viWP/dIby",
          "WOOtsdlcIW",
          "W5CiWOCsaq",
          "wSoyWPe/WR4",
          "W6hdRGNdMG",
          "gr7cIqpcKW",
          "qCodtwe",
          "WP/cU8ozcSk2",
          "WRFdTCkkWRxcRq",
          "W5OaWQCWWO4",
          "g8o9W5HPWRO",
          "W7qLua/dUW",
          "nsZdTsm1",
          "WQ7dPmkXW7DPqmoaE8ovWPNdRq",
          "r8o1W6NdSI0",
          "s8oSW4Wtra",
          "iCo9hHPQ",
          "WPmuwCoWkq",
          "W50TWPFcPSkn",
          "W7ZdRZddQG",
          "WR0bvq3cVG",
          "sayramo9",
          "W44qFh3dRa",
          "WPmuACotW5S",
          "W4PCCa7cLa",
          "gSkApXyP",
          "W4aRW7S8ga",
          "WQPUW4hdTmo1r3OSW4FcUSkvW6ZcOG",
          "xH46E8os",
          "WPvEWOCPxq",
          "AgbHgKC",
          "zqT5W7hcJG",
          "Ee3cTqtcTG",
          "W5uKCv3dKq",
          "W6OVzI/dJa",
          "WPJcN8o4h8kz",
          "B8o9W4GbDW",
          "W7yhW4udhq",
          "W4KhCtpdPG",
          "WRW3w8oMW5C",
          "rwxdM8oDoq",
          "W7ahWQFcPmkQ",
          "E8kKWOlcH8ki",
          "WOj6WOuqrG",
          "W7BdRJJdTSk7",
          "WOmKW4pdJve",
          "ogtdN8kwoW",
          "W7XgvbRcSq",
          "WQnyWOSpsa",
          "qSoGqmoPDq",
          "W7ddUtxdOmk/",
          "gSotWPG",
          "WRaPCepcGa",
          "W5j4WQ/dRGq",
          "nbpcRHZcJq",
          "hSo2WOubW4W",
          "uSoJuer0",
          "z8oqW6ldQqC",
          "gCkqkXKI",
          "zYHQhmoM",
          "CImTwSod",
          "tgtcHSkBWQa",
          "vXzRdSoj",
          "s0FdS3hdJmokrCo7WP8yBG",
          "WO3cGCoUgmkv",
          "hmoOW6HIWQC",
          "W6aJW5WFjG",
          "WOO7W4RcNu3dVSk1WQdcUWKaba",
          "uCkpWPvG",
          "BuhcKHNcQW",
          "WOpdGSkxWRdcTa",
          "mNb5oq",
          "CedcSrJcRq",
          "WOrAWQGWDa",
          "CSkTWRdcQZK",
          "WQ9KW4BdSCo2",
          "lmkbs2tcKW",
          "W5XWW4ldVCo1",
          "cHRdUdqm",
          "W49NWP/dPbO",
          "WPGozctdKSkNjq",
          "WPuKus3cKq",
          "WQpcU8oGW6SK",
          "WQqPFvtcMW",
          "W7pcRCkJWRe7",
          "tCoQW77dSHe",
          "WQBdTrldNmkjuw4",
          "A1VcOHNcTG",
          "W58IW54LaG",
          "W5elDc/dIq",
          "W7CCrSovW7C",
          "W7/cU8oGWRO",
          "W54LWQuO",
          "W7OQWOdcRmkK",
          "W4ygW4rmrq",
          "W4rEWQNdPIO",
          "WPCjqfRcGq",
          "xSoqW4KPya",
          "CmoIseLU",
          "WQRcVmoUdCkx",
          "zc9ZmSog",
          "W6NdHCkIwCkw",
          "i8ofW7TbW54",
          "W6DCAHNcJq",
          "WRybtCosW60",
          "l8kvuflcRG",
          "h08asJy",
          "BcXu",
          "W7xdImo2rmkr",
          "WQiLBKu",
          "jYzRCdC",
          "idlcNCkiCr1wWPniDSoMWOSA",
          "ECo6W5xdGmkg",
          "W7ZdTCo6W70",
          "W7qDzWxcJW",
          "WP09vrBcRW",
          "W7ZdRZe",
          "DN9Gpq",
          "WRuOCvldNa",
          "WOjgWPmtDq",
          "qhVdU8o9lq",
          "W63cQmkNWQ02",
          "y8oVW5xcKYi",
          "DSoqBxbU",
          "uCkhWPqMDa",
          "WQylqSotW6e",
          "zSonWOS0WRG",
          "DW7dQqVcRa",
          "DXHaWQBdUa",
          "W71qArNcLW",
          "W7hcM8kqkG",
          "W7zNWQZdPdS",
          "WQpdVmk2EKO",
          "W7eLbcddJW",
          "oSkSu0xcIW",
          "xCo1W6RdKda",
          "W5jAW7jWcq",
          "rvTGbxm",
          "WQuOCvlcLq",
          "WRhdJCo0qgq",
          "sGK/zmof",
          "hCobW5TTWP0",
          "sZ1qomoL",
          "WQtdNCk0WQdcJG",
          "WQagseJcKq",
          "W50pWPSmWOe",
          "ESohW4xdHZC",
          "W4DjWQVdId8",
          "DCoZzvD7",
          "BSoHW602AG",
          "sudcIHFcTW",
          "W6HvW6Tuhq",
          "W5GxFwRdTW",
          "W4DMWQNdMa4",
          "amkpgGqm",
          "BvBcL8kgWQq",
          "fSoGbqDT",
          "W7zon8kiAW",
          "W6GMW5mKnq",
          "WQ3cLmoalGC",
          "W4ieWP0aia",
          "W4Kbr17dSW",
          "WRbHW41vuq",
          "BrvKW5pcTa",
          "W40UW7lcLvK",
          "fSkwraldTW",
          "wYLB",
          "zsDNW43cKG",
          "EhT+gKe",
          "t8o1W6ddRrW",
          "s8oHW5/dSd8",
          "WR4Yt8oQcG",
          "W5DCWOVdGGu",
          "rSk9WPVcMCk1",
          "WPddJCo1",
          "WO4pCcRcLq",
          "W7T1W5ngcW",
          "W4TzBddcSG",
          "fCoiWRy3",
          "tXWLrSoz",
          "W6OtlaZcLW",
          "W7LyWPFdGcK",
          "W5y7WRWWWPi",
          "W5CLzu3dOG",
          "oSkqpZqC",
          "WQ0lpSoxkG",
          "W6DRlXNdHSoyuHBdSCkLWOW",
          "WRyvCupcJG",
          "vWhcHCo1wa",
          "WRijthhcPq",
          "WO3dHSoGuxa",
          "WRpdGCo0cLK",
          "sGZdT8ovja",
          "iui/wtC",
          "fSkxtq",
          "ECoCW5HxW6u",
          "W5iXWOujWQ8",
          "WRCPAKJcSa",
          "W54yysVcKG",
          "ffuTAZi",
          "W6ldSd7dLSko",
          "W7pcRCk6WPyN",
          "ouCayrS",
          "WRpdISkRWQRcKG",
          "W4ymWP8l",
          "cmkAFNxcRq",
          "W4ODW4u6dG",
          "WQuKm8o5hq",
          "WRldQmoMvMe",
          "WRBcR8kKnca",
          "WQOHCCoxbq",
          "BHKnW7VcVW",
          "pmoCWP8JW4a",
          "zIhcVSoFrq",
          "hSkjwK7cPa",
          "aWZcJGdcJW",
          "xCooW5iK",
          "AWVdUSot",
          "rmknW49QWRXIWPxcHCo6W6JdJCkjcG",
          "WQyHv8ofW5q",
          "gCo2pr9q",
          "W6ZdGgddOmkT",
          "W5CyWPatha",
          "hcBdUZio",
          "A3r6pq",
          "wCoRW4RdLYm",
          "xSkuW5D9WQu",
          "nSoaW5n5WPW",
          "WRpcMmognCk5",
          "wHOLzmox",
          "W5uoxMFdLG",
          "W7u6DuddPG",
          "W58FuWK",
          "nmoFW41MWPe",
          "W6v+vXRcRW",
          "FKVcGXJcUG",
          "WPxdGCkCWRFcRa",
          "WRNdLCk4WQZcJG",
          "zCoDW7a1zW",
          "xeddV8o6",
          "wGn1lSoJ",
          "xMxcHIdcGW",
          "EgnMpMC",
          "EvNdG8oYBq",
          "WQSktCoxma",
          "WQ8WW5L2b8kXia4",
          "jZFdMWuu",
          "W77dMCoWqSkm",
          "vaS+",
          "efWetYa",
          "o8kRkJi0",
          "A3bRjwm",
          "WR4RCg7cMa",
          "W6lcK8kdWPmk",
          "WRyCDCotfq",
          "tfpdOSoJAa",
          "kCkxW4jpW71jW6GIWQuuW6RcHW",
          "W6hdPcxdSq",
          "o8oXWPG7W7S",
          "gCouWPi/W6G",
          "gmkEt1a",
          "WQZdP8o3D8krbmo4",
          "WOpdTCo6q1W",
          "whxdL8oTEG",
          "CZWIASoD",
          "oWFcQapcSW",
          "W58TWQhcOSko",
          "eCkAxKVcSG",
          "W4mcW4mzoG",
          "fmovWPe3",
          "W4FcG8kIb8kI",
          "W4yhW5OzgW",
          "pmkpkte8",
          "W6LHW59jgG",
          "WPuzjNBdJW",
          "CM7dH8oknq",
          "W5igW4BcLwG",
          "qmocqMXu",
          "y8ozW4JdVCko",
          "WOhcGSo5oCkc",
          "W65HqKdcNmkSumkk",
          "W5OeW6Kdjq",
          "g8o6WPzP",
          "WPijCdBcIa",
          "E2rGkKK",
          "WP3dUCkBWOpcSW",
          "cLfAqdy",
          "vabBWPpdJW",
          "pbhdO8ocW57cJd3dSuVdGftcHW",
          "WPCvzehcPW",
          "WQ88r2hcKa",
          "eCkkxLdcQa",
          "C8oBW67dGCkF",
          "gHpcQr7cQG",
          "W5O5WPJcR8kV",
          "fCoyWRGlW6y",
          "lCoNbaW",
          "C8o7W5W",
          "WRZcJSkpkeC",
          "CcZdK8o4Ba",
          "pslcUb/cIa",
          "Dr9mWQBdUa",
          "W7hcVmk/WRe",
          "iSkHWOlcHSor",
          "W4D7WPVdJXK",
          "WOrdWPOVCq",
          "C8oaWPqnWRK",
          "W4beW5mCdG",
        ];
        _0x14e7 = function () {
          return _0x1eda8c;
        };
        return _0x14e7();
      }
      function _0x29d6d3(
        _0x3e4496,
        _0x1c519e,
        _0x580d11,
        _0x3effc1,
        _0x4b9944
      ) {
        return _0x1e00(_0x580d11 - 0x2c0, _0x3e4496);
      }
      const firebaseConfig = _0x280fa3;
      (function () {
        const _0x209fcf = {
          uaKrL: function (_0x2898a6, _0xe90800) {
            return _0x2898a6 === _0xe90800;
          },
          eKvYC: _0x3e2731(0x2ca, 0x283, "GoV3", 0x339, 0x23c),
          VYFRA: function (_0x583610, _0x2de7a4) {
            return _0x583610(_0x2de7a4);
          },
          rjZHv: function (_0x388029, _0x2bd4ae) {
            return _0x388029 + _0x2bd4ae;
          },
          DpTgK:
            _0x3e2731(0x1d6, 0x18a, "OibM", 0x268, 0x197) +
            _0x3e2731(0x3ed, 0x34e, "Rord", 0x3c0, 0x2f3) +
            _0x3e2731(0xa6, 0x16e, "Zsy6", 0x21c, 0x157) +
            _0x22b1fb("qI3O", -0x1aa, -0x257, -0x102, -0x171),
          uguVs:
            _0xdd12a2(0x619, 0x6ba, 0x536, "R()6", 0x5ae) +
            _0x5423a6(-0x13e, -0x1a9, "GoV3", -0x134, -0x136) +
            _0x3e2731(0x2df, 0x1d6, "R()6", 0x138, 0x20e) +
            _0x3e2731(0x3b5, 0x3da, "41Bu", 0x32c, 0x2ce) +
            _0x1a8818(0x197, 0x1bd, 0x162, 0x16f, "wOlR") +
            _0x3e2731(0x288, 0x2e5, "t6dm", 0x3a7, 0x337) +
            "\x20)",
          VUxQU: function (_0x3f14ed) {
            return _0x3f14ed();
          },
          etoVa: _0x1a8818(0x62, 0xd7, 0x1bf, 0x11, "Rord"),
        };
        function _0x3e2731(
          _0x565cd7,
          _0x17fd76,
          _0x249dd4,
          _0x37059e,
          _0x573d9f
        ) {
          return _0x3ba62e(
            _0x565cd7 - 0xfc,
            _0x17fd76 - 0xc9,
            _0x249dd4,
            _0x37059e - 0x157,
            _0x573d9f - 0x292
          );
        }
        function _0xdd12a2(
          _0x308dfe,
          _0x5935bb,
          _0x37b602,
          _0x28e362,
          _0x1ce70b
        ) {
          return _0x19dfc8(
            _0x28e362,
            _0x308dfe - 0x333,
            _0x37b602 - 0x127,
            _0x28e362 - 0x139,
            _0x1ce70b - 0x18c
          );
        }
        function _0x5423a6(
          _0x581689,
          _0x488516,
          _0x151a79,
          _0x11591b,
          _0xfac825
        ) {
          return _0x19dfc8(
            _0x151a79,
            _0xfac825 - -0x339,
            _0x151a79 - 0x131,
            _0x11591b - 0x14d,
            _0xfac825 - 0x164
          );
        }
        let _0x48a08e;
        function _0x1a8818(
          _0xeafb79,
          _0x1ec919,
          _0x2211c5,
          _0xef8156,
          _0xfa4044
        ) {
          return _0x1501ee(
            _0xeafb79 - 0x1e,
            _0x1ec919 - 0x1c4,
            _0xfa4044,
            _0xef8156 - 0x29,
            _0x1ec919 - -0x29
          );
        }
        function _0x22b1fb(
          _0x2d5d18,
          _0x5dbe4d,
          _0x1251d2,
          _0x4d9b90,
          _0x56aeec
        ) {
          return _0x1501ee(
            _0x2d5d18 - 0xbd,
            _0x5dbe4d - 0x69,
            _0x2d5d18,
            _0x4d9b90 - 0x1c,
            _0x5dbe4d - -0x24d
          );
        }
        try {
          if (
            _0x209fcf[_0xdd12a2(0x4e5, 0x54d, 0x469, "[Z@%", 0x5f2)](
              _0x209fcf[_0x1a8818(-0x1b, 0x81, 0x51, 0x183, "sBk0")],
              _0x209fcf[_0x3e2731(0x288, 0x2b3, "41Bu", 0x2d6, 0x1df)]
            )
          ) {
            const _0x237ff1 = _0x209fcf[
              _0x5423a6(0x4f, 0x10, "GoV3", 0xd1, -0x38)
            ](
              Function,
              _0x209fcf[_0xdd12a2(0x544, 0x633, 0x566, "*h3V", 0x512)](
                _0x209fcf[_0x1a8818(-0x5e, 0x4c, 0x11d, 0xa1, "qI3O")](
                  _0x209fcf[_0x5423a6(-0x1a6, -0x225, "7cHm", -0x20a, -0x1ea)],
                  _0x209fcf[_0x22b1fb("W@mu", -0x55, -0xd9, -0x12a, 0x1c)]
                ),
                ");"
              )
            );
            _0x48a08e =
              _0x209fcf[_0x5423a6(-0xf6, -0x1c3, "XU3B", -0x218, -0x177)](
                _0x237ff1
              );
          } else return !![];
        } catch (_0x1b4d49) {
          if (
            _0x209fcf[_0x5423a6(-0x8a, 0x11, "LVM1", -0x10a, -0x102)](
              _0x209fcf[_0x1a8818(-0xae, -0x17, 0xdf, 0xbe, "[Z@%")],
              _0x209fcf[_0x22b1fb("W@mu", -0x224, -0x148, -0x172, -0x269)]
            )
          )
            _0x48a08e = window;
          else {
            if (_0x16e787) {
              const _0x5068a9 = _0x22cb67[
                _0x1a8818(-0x32, 0x5b, -0x35, 0x9c, "nqPu")
              ](_0x4bc3c1, arguments);
              return (_0x541776 = null), _0x5068a9;
            }
          }
        }
        _0x48a08e[
          _0xdd12a2(0x55d, 0x60c, 0x537, "Y941", 0x4b9) +
            _0x3e2731(0x2ca, 0x304, "W$EH", 0x2e7, 0x332) +
            "l"
        ](_0x4d4790, 0x1608 + 0xb1c + -0x76 * 0x26);
      })();
      function _0x4d4790(_0x4875e3) {
        function _0x1b7155(
          _0x3a6347,
          _0x3cc235,
          _0x2d0947,
          _0x45b1f4,
          _0x1920fc
        ) {
          return _0x19dfc8(
            _0x45b1f4,
            _0x3a6347 - -0x2e,
            _0x2d0947 - 0x1e3,
            _0x45b1f4 - 0x11c,
            _0x1920fc - 0x158
          );
        }
        function _0x238cc3(
          _0x36b273,
          _0x343781,
          _0x1bf96a,
          _0x282a12,
          _0x54cc9f
        ) {
          return _0x29d6d3(
            _0x36b273,
            _0x343781 - 0x15f,
            _0x1bf96a - -0x267,
            _0x282a12 - 0x6,
            _0x54cc9f - 0x9b
          );
        }
        function _0x401865(
          _0x3e31b4,
          _0x5da6ac,
          _0x10845c,
          _0x6c55e0,
          _0xbe7b30
        ) {
          return _0x1501ee(
            _0x3e31b4 - 0x1f,
            _0x5da6ac - 0x7,
            _0x10845c,
            _0x6c55e0 - 0x153,
            _0xbe7b30 - -0x333
          );
        }
        const _0x30d215 = {
          AkQRY: function (_0x405c83, _0x2eb474) {
            return _0x405c83(_0x2eb474);
          },
          qIsAN: function (_0x5e37a6, _0x35dc71) {
            return _0x5e37a6 + _0x35dc71;
          },
          qWIdH:
            _0x401865(-0x4a, -0x1e3, "HTtv", -0xac, -0x118) +
            _0x401865(-0x207, -0x2a2, "$v9m", -0x25b, -0x250) +
            _0x529949(0x1fa, 0x115, 0x14c, 0x2ad, "tt&c") +
            _0x529949(0x1d4, 0x1fe, 0x255, 0x26e, "#1vH"),
          PpLqu:
            _0x252448("tt&c", -0x167, -0xf5, -0x164, -0x89) +
            _0x252448("t6dm", -0x91, -0xb8, -0x6a, -0x10e) +
            _0x238cc3("GoV3", 0x1c6, 0x14c, 0x105, 0x43) +
            _0x1b7155(0x305, 0x346, 0x297, "HTtv", 0x36b) +
            _0x252448("V$by", 0xe3, -0x38, 0x5f, 0x51) +
            _0x1b7155(0xeb, 0xd2, 0x49, "k9pW", 0x112) +
            "\x20)",
          WoGYL: function (_0x193285) {
            return _0x193285();
          },
          eyYHk: _0x252448("pKZl", -0x4e, 0x5, 0x11, 0x97),
          GKGMZ: _0x1b7155(0x1dd, 0xd8, 0x1fe, "pKZl", 0x1b5),
          iYxGU: _0x238cc3("eJ[8", 0x228, 0x23a, 0x2d8, 0x1a7),
          mAhZo: _0x238cc3("sBk0", 0x194, 0xf6, 0x7e, 0xa6),
          zVhdM:
            _0x529949(0x223, 0x12b, 0x1a5, 0x1d2, "bcBT") +
            _0x529949(0xbd, 0x100, 0x162, 0x15e, "Rord"),
          hDItA: _0x1b7155(0x112, 0x147, 0x170, "dZqL", 0x1cb),
          DtOoJ: _0x1b7155(0x1d2, 0x284, 0x187, "W$EH", 0x269),
          FAedj: function (_0x18571c, _0x2060cb) {
            return _0x18571c < _0x2060cb;
          },
          Admjj: function (_0x322cc5, _0x191931) {
            return _0x322cc5 !== _0x191931;
          },
          MMghu: _0x529949(0x220, 0x208, 0x27c, 0x1e3, "$Bj&"),
          yzlbG: function (_0x4f9c8f, _0x4f7129) {
            return _0x4f9c8f !== _0x4f7129;
          },
          LRhXk: _0x252448("[Z@%", -0xb0, -0x96, -0xf1, -0xab),
          BNPXD: _0x1b7155(0x2fb, 0x29a, 0x3b4, "*h3V", 0x2c1),
          qEeLA: _0x238cc3("OibM", 0x237, 0x194, 0x1f8, 0x157),
          aMSpM: _0x529949(0xba, 0x11d, 0x108, 0x20, "XU3B"),
          JJmZm:
            _0x529949(0x119, 0xc4, 0xea, 0xba, "W$EH") +
            _0x1b7155(0x1f5, 0x1b8, 0x229, "t6dm", 0x14d) +
            "t",
          ohmlf:
            _0x529949(0x10a, 0x154, 0xc7, 0x1dc, "^egm") +
            _0x1b7155(0x20e, 0x162, 0x134, "sGVM", 0x241) +
            _0x401865(-0x205, -0x26a, "^egm", -0x2c2, -0x2bc),
          AKUuu: _0x529949(0x110, 0x1c, 0x156, 0xcb, "#1vH") + "er",
          lQlpc: function (_0x547a2d, _0x141edf) {
            return _0x547a2d === _0x141edf;
          },
          Ynoor: _0x529949(0x1bf, 0x149, 0x2be, 0x199, "nqPu"),
          Hnfgu: function (_0x305f55, _0x168efc) {
            return _0x305f55 === _0x168efc;
          },
          mKkle: _0x1b7155(0x21c, 0x20e, 0x2ab, "7cHm", 0x31b) + "g",
          LqGSk: _0x529949(0xdb, 0x1dd, -0x38, 0xd4, "k9pW"),
          rpEqR: _0x529949(0x8f, -0x34, 0x155, 0x133, "gFHR"),
          KEKax: _0x401865(-0x262, -0x14d, "Y941", -0x110, -0x1c8),
          HuCXg: _0x252448("R()6", -0x216, -0x1c4, -0x128, -0x67),
          IGUhO: function (_0x4f3797, _0x260c49) {
            return _0x4f3797 !== _0x260c49;
          },
          aWQIH: function (_0x5a5415, _0x28ccb7) {
            return _0x5a5415 + _0x28ccb7;
          },
          iebVV: function (_0x54b9ab, _0x385e6f) {
            return _0x54b9ab / _0x385e6f;
          },
          EUygV: _0x252448("PlV*", -0x187, -0x48, -0xd9, -0x1e) + "h",
          YUlpO: function (_0x26791e, _0x1f95c2) {
            return _0x26791e === _0x1f95c2;
          },
          huDuK: function (_0x1ad0b5, _0x24fed3) {
            return _0x1ad0b5 % _0x24fed3;
          },
          jhBKo: _0x529949(0x22e, 0x2a6, 0x2ce, 0x28c, "[Z@%"),
          wztxC: _0x238cc3("XU3B", 0x13c, 0x1d2, 0x202, 0x2e0),
          SpLlZ: _0x252448("t6dm", -0x39, -0x119, -0xe5, -0x11f) + "n",
          ZyxWc: function (_0x147ab1, _0x4b1a99) {
            return _0x147ab1 !== _0x4b1a99;
          },
          dwnXl: _0x1b7155(0x1f2, 0x27e, 0x1a2, "XU3B", 0x1b6),
          HSdcA: _0x529949(0x208, 0x173, 0x241, 0x253, "9zhu"),
          UzNuT: function (_0x9dafa4, _0x4866f1) {
            return _0x9dafa4(_0x4866f1);
          },
          rshWs: _0x238cc3("h&M!", 0xf2, 0x158, 0x219, 0x1ec),
          pKtIm: _0x252448("h&M!", 0x32, -0x16b, -0x7b, -0x17a),
          iUDnO: _0x252448("PlV*", -0x175, -0xff, -0x17b, -0x263),
          mVWIU: _0x252448("UN%X", -0xa0, -0xe6, -0x196, -0x2a4),
        };
        function _0x252448(
          _0x4859a0,
          _0x48d3fc,
          _0x40e0b3,
          _0x5670b1,
          _0x297476
        ) {
          return _0x1501ee(
            _0x4859a0 - 0x75,
            _0x48d3fc - 0x3b,
            _0x4859a0,
            _0x5670b1 - 0x192,
            _0x5670b1 - -0x1c6
          );
        }
        function _0x529949(
          _0x5bfdac,
          _0x2e009b,
          _0x3de7e7,
          _0x1b2e57,
          _0x47d5b6
        ) {
          return _0xa7517(
            _0x5bfdac - 0x10b,
            _0x5bfdac - -0x29a,
            _0x47d5b6,
            _0x1b2e57 - 0xbe,
            _0x47d5b6 - 0x1e8
          );
        }
        function _0x2ae246(_0x154327) {
          const _0x497e99 = {};
          function _0x10f7ed(
            _0x90c004,
            _0x170f90,
            _0x41aa21,
            _0x562b0c,
            _0x97e912
          ) {
            return _0x238cc3(
              _0x41aa21,
              _0x170f90 - 0x106,
              _0x97e912 - -0x3e7,
              _0x562b0c - 0x189,
              _0x97e912 - 0x7
            );
          }
          function _0x329902(
            _0x599589,
            _0x12e3fb,
            _0x27ef81,
            _0x310108,
            _0x3f5ab6
          ) {
            return _0x401865(
              _0x599589 - 0xcf,
              _0x12e3fb - 0x26,
              _0x310108,
              _0x310108 - 0x10b,
              _0x3f5ab6 - 0x5cf
            );
          }
          _0x497e99[_0x16f4ea(-0x37, -0xe8, -0xe3, "u7)C", -0x94)] =
            _0x30d215[_0x49c032(0x2d5, 0x300, "gFHR", 0x15e, 0x237)];
          function _0x16f4ea(
            _0x6010ba,
            _0x17e3b8,
            _0x7ceac4,
            _0x34be5f,
            _0x1278f4
          ) {
            return _0x401865(
              _0x6010ba - 0xd8,
              _0x17e3b8 - 0xd6,
              _0x34be5f,
              _0x34be5f - 0x1b6,
              _0x17e3b8 - 0x7f
            );
          }
          function _0x49c032(
            _0x70cb4c,
            _0x56478e,
            _0x53801f,
            _0x2f1967,
            _0x619abc
          ) {
            return _0x238cc3(
              _0x53801f,
              _0x56478e - 0x1a9,
              _0x619abc - 0x135,
              _0x2f1967 - 0xc,
              _0x619abc - 0x1ee
            );
          }
          _0x497e99[_0x16f4ea(-0x343, -0x234, -0x1e5, "nqPu", -0x324)] =
            _0x30d215[_0x329902(0x452, 0x27f, 0x28c, "7cHm", 0x376)];
          function _0x13ec1f(
            _0x504bc6,
            _0x5e0890,
            _0x40008a,
            _0x2ce769,
            _0x1eefe5
          ) {
            return _0x238cc3(
              _0x2ce769,
              _0x5e0890 - 0xea,
              _0x1eefe5 - 0x350,
              _0x2ce769 - 0x155,
              _0x1eefe5 - 0x111
            );
          }
          const _0x300c2a = _0x497e99;
          if (
            _0x30d215[_0x329902(0x27c, 0x334, 0x42a, "@Dkg", 0x379)](
              _0x30d215[_0x13ec1f(0x636, 0x4f6, 0x48e, "[Z@%", 0x59c)],
              _0x30d215[_0x13ec1f(0x718, 0x6ed, 0x61c, "VIMt", 0x613)]
            )
          ) {
            if (
              _0x30d215[_0x13ec1f(0x65c, 0x660, 0x519, "k9pW", 0x604)](
                typeof _0x154327,
                _0x30d215[_0x16f4ea(-0x22d, -0x13f, -0x144, "D9bI", -0x132)]
              )
            ) {
              if (
                _0x30d215[_0x329902(0x37e, 0x482, 0x49f, "u7)C", 0x395)](
                  _0x30d215[_0x329902(0x4b6, 0x4ea, 0x387, "V$by", 0x419)],
                  _0x30d215[_0x329902(0x1dc, 0x2e8, 0x2d2, "T^6w", 0x2f0)]
                )
              ) {
                if (_0x2257a9) {
                  const _0x2933c7 = _0x268d97[
                    _0x49c032(0x2fd, 0x3bb, ")QtV", 0x2b6, 0x336)
                  ](_0x47d949, arguments);
                  return (_0x248e21 = null), _0x2933c7;
                }
              } else
                return function (_0x22a489) {}
                  [
                    _0x16f4ea(-0x144, -0x23e, -0x28e, "t6dm", -0x296) +
                      _0x13ec1f(0x346, 0x39e, 0x38d, "^egm", 0x42d) +
                      "r"
                  ](
                    _0x30d215[_0x10f7ed(-0x272, -0x1eb, "nqPu", -0x324, -0x291)]
                  )
                  [_0x16f4ea(-0xf3, -0x1b7, -0x1fc, "R()6", -0x2be)](
                    _0x30d215[_0x10f7ed(-0x15d, -0x1f8, "R()6", -0x16f, -0x265)]
                  );
            } else {
              if (
                _0x30d215[_0x10f7ed(-0x1e9, -0x151, "W$EH", -0x64, -0x135)](
                  _0x30d215[_0x10f7ed(-0x24e, -0x135, "9zhu", -0x24c, -0x1d3)],
                  _0x30d215[_0x329902(0x3ba, 0x247, 0x2ec, "Rord", 0x314)]
                )
              )
                return _0x40ed39;
              else
                _0x30d215[_0x49c032(0x240, 0x397, "u7)C", 0x241, 0x322)](
                  _0x30d215[_0x13ec1f(0x530, 0x55a, 0x5d9, "HTtv", 0x5ea)](
                    "",
                    _0x30d215[_0x13ec1f(0x375, 0x371, 0x408, "gTIW", 0x474)](
                      _0x154327,
                      _0x154327
                    )
                  )[_0x30d215[_0x329902(0x50d, 0x556, 0x4c3, "Zsy6", 0x48e)]],
                  -0x246 * 0x8 + -0x1 * 0xc07 + 0x1e38
                ) ||
                _0x30d215[_0x329902(0x344, 0x25d, 0x2b9, "qI3O", 0x35e)](
                  _0x30d215[_0x329902(0x3f0, 0x596, 0x4eb, "gj7%", 0x4a3)](
                    _0x154327,
                    0x1892 + -0xdba + 0x1 * -0xac4
                  ),
                  -0x3aa + -0x2f7 + -0x1 * -0x6a1
                )
                  ? _0x30d215[_0x16f4ea(-0x1f5, -0x10b, -0x1cb, "gj7%", -0x81)](
                      _0x30d215[_0x13ec1f(0x4a5, 0x4d7, 0x515, "gTIW", 0x57c)],
                      _0x30d215[_0x49c032(0x272, 0x21e, "k9pW", 0x378, 0x2fe)]
                    )
                    ? function () {
                        function _0x5f9ee0(
                          _0x547698,
                          _0x15a5ac,
                          _0x58eeec,
                          _0xd26004,
                          _0x47289d
                        ) {
                          return _0x49c032(
                            _0x547698 - 0x2f,
                            _0x15a5ac - 0x16e,
                            _0x547698,
                            _0xd26004 - 0x19e,
                            _0x47289d - 0x1d8
                          );
                        }
                        function _0x133956(
                          _0x3e8670,
                          _0x4c0380,
                          _0x3f9f33,
                          _0x4ecbb4,
                          _0x256bcd
                        ) {
                          return _0x49c032(
                            _0x3e8670 - 0x83,
                            _0x4c0380 - 0x127,
                            _0x4c0380,
                            _0x4ecbb4 - 0x1ed,
                            _0x3e8670 - 0x11
                          );
                        }
                        function _0x28b3d4(
                          _0x3ed2c7,
                          _0x2c45cf,
                          _0xacbc7e,
                          _0x3c2b66,
                          _0x5dff5b
                        ) {
                          return _0x329902(
                            _0x3ed2c7 - 0xc3,
                            _0x2c45cf - 0x14e,
                            _0xacbc7e - 0x9,
                            _0x2c45cf,
                            _0x5dff5b - -0x2a1
                          );
                        }
                        function _0x45c76d(
                          _0x36579a,
                          _0x4a112e,
                          _0x20fb06,
                          _0x3fe69a,
                          _0x230a5a
                        ) {
                          return _0x16f4ea(
                            _0x36579a - 0x5c,
                            _0x230a5a - 0x1f3,
                            _0x20fb06 - 0xb3,
                            _0x36579a,
                            _0x230a5a - 0xc5
                          );
                        }
                        function _0x150471(
                          _0x39bb51,
                          _0x1283d7,
                          _0x3b2102,
                          _0x2dbd75,
                          _0x28a09d
                        ) {
                          return _0x16f4ea(
                            _0x39bb51 - 0x1c0,
                            _0x3b2102 - 0x3ad,
                            _0x3b2102 - 0xe6,
                            _0x2dbd75,
                            _0x28a09d - 0x17b
                          );
                        }
                        const _0x3f3506 = {
                          bnjlk: function (_0x22bedf, _0x120950) {
                            function _0x58dc95(
                              _0xbae4f9,
                              _0x36a523,
                              _0x353e69,
                              _0x450c42,
                              _0x5abf3f
                            ) {
                              return _0x1e00(_0xbae4f9 - -0x87, _0x36a523);
                            }
                            return _0x30d215[
                              _0x58dc95(0x86, "*h3V", 0xe4, 0x101, 0xa6)
                            ](_0x22bedf, _0x120950);
                          },
                          UqKhO: function (_0x368a1a, _0xf27639) {
                            function _0x3af02e(
                              _0x1b532e,
                              _0x41bd98,
                              _0x14ce36,
                              _0x144105,
                              _0x23be10
                            ) {
                              return _0x1e00(_0x1b532e - -0x31f, _0x23be10);
                            }
                            return _0x30d215[
                              _0x3af02e(-0x203, -0x195, -0x1b8, -0x30f, "tt&c")
                            ](_0x368a1a, _0xf27639);
                          },
                          vmIgU: function (_0x5df30b, _0x4577f8) {
                            function _0x3d07ad(
                              _0x390a39,
                              _0x1da4ca,
                              _0x39d2f5,
                              _0x33335c,
                              _0x358336
                            ) {
                              return _0x1e00(_0x358336 - 0x3cf, _0x1da4ca);
                            }
                            return _0x30d215[
                              _0x3d07ad(0x4d6, "Y941", 0x5d4, 0x4a8, 0x579)
                            ](_0x5df30b, _0x4577f8);
                          },
                          TBUFR:
                            _0x30d215[
                              _0x28b3d4(0xd3, "[Z@%", 0x41, 0x14c, 0xb6)
                            ],
                          BAaji:
                            _0x30d215[
                              _0x28b3d4(0x2c, "W$EH", 0x6d, 0x85, 0x139)
                            ],
                          RxNfd: function (_0x2aac9e) {
                            function _0x371c2f(
                              _0x69e07d,
                              _0x420728,
                              _0x27351e,
                              _0x5dc06f,
                              _0x2ededf
                            ) {
                              return _0x28b3d4(
                                _0x69e07d - 0x8a,
                                _0x5dc06f,
                                _0x27351e - 0x18a,
                                _0x5dc06f - 0x53,
                                _0x69e07d - 0x165
                              );
                            }
                            return _0x30d215[
                              _0x371c2f(0x306, 0x41a, 0x335, "T^6w", 0x2b4)
                            ](_0x2aac9e);
                          },
                          foaKe:
                            _0x30d215[
                              _0x5f9ee0("tt&c", 0x65b, 0x543, 0x513, 0x5fb)
                            ],
                          LUuIx:
                            _0x30d215[
                              _0x5f9ee0("Rord", 0x50b, 0x387, 0x461, 0x3fd)
                            ],
                          hwnNl:
                            _0x30d215[
                              _0x45c76d("41Bu", 0x6c, 0x16d, 0x13c, 0xd2)
                            ],
                          rxlVB:
                            _0x30d215[
                              _0x150471(0x1a9, 0x27e, 0x1fe, "cXkO", 0x2a8)
                            ],
                          kFbTR:
                            _0x30d215[
                              _0x45c76d("W$EH", -0x16d, -0x15c, -0x16b, -0x77)
                            ],
                          HqcKO:
                            _0x30d215[
                              _0x45c76d("h&M!", -0x63, -0x130, -0x131, -0x8d)
                            ],
                          rbxKQ:
                            _0x30d215[
                              _0x28b3d4(0x5f, "*h3V", 0x116, 0xa3, 0x148)
                            ],
                          whFJS: function (_0x4fcd70, _0x48f589) {
                            function _0x58b7fe(
                              _0x3d2176,
                              _0x3c4b27,
                              _0x41d14c,
                              _0x29f0a2,
                              _0x587c90
                            ) {
                              return _0x150471(
                                _0x3d2176 - 0x6a,
                                _0x3c4b27 - 0x84,
                                _0x29f0a2 - 0x263,
                                _0x3d2176,
                                _0x587c90 - 0x7f
                              );
                            }
                            return _0x30d215[
                              _0x58b7fe("@Dkg", 0x49a, 0x5b6, 0x4c8, 0x4b3)
                            ](_0x4fcd70, _0x48f589);
                          },
                        };
                        if (
                          _0x30d215[
                            _0x5f9ee0("7cHm", 0x50e, 0x53d, 0x402, 0x432)
                          ](
                            _0x30d215[
                              _0x28b3d4(-0x16, "gFHR", -0x84, 0x52, 0x41)
                            ],
                            _0x30d215[
                              _0x28b3d4(0x298, "W@mu", 0x161, 0x23a, 0x1a3)
                            ]
                          )
                        ) {
                          let _0x1310c3;
                          try {
                            const _0x397d33 = _0x3f3506[
                              _0x150471(0x1c3, 0x115, 0x1d9, "Y6JY", 0x1b7)
                            ](
                              _0x44970a,
                              _0x3f3506[
                                _0x5f9ee0("qI3O", 0x52c, 0x4ab, 0x536, 0x564)
                              ](
                                _0x3f3506[
                                  _0x28b3d4(0xcc, "*h3V", -0x54, 0x62, 0x14)
                                ](
                                  _0x3f3506[
                                    _0x28b3d4(
                                      0x1e9,
                                      "sGVM",
                                      0x30c,
                                      0x10a,
                                      0x1f9
                                    )
                                  ],
                                  _0x3f3506[
                                    _0x45c76d("wOlR", 0x111, 0xb5, 0xf0, 0x74)
                                  ]
                                ),
                                ");"
                              )
                            );
                            _0x1310c3 =
                              _0x3f3506[
                                _0x45c76d("PlV*", -0x83, -0x112, 0x73, -0x8a)
                              ](_0x397d33);
                          } catch (_0x8a4902) {
                            _0x1310c3 = _0x12ea35;
                          }
                          const _0x58cf4c = (_0x1310c3[
                              _0x150471(0x290, 0x1b1, 0x25a, "k9pW", 0x202) +
                                "le"
                            ] =
                              _0x1310c3[
                                _0x28b3d4(0x1cc, "LVM1", 0x2ea, 0x2dc, 0x1d7) +
                                  "le"
                              ] || {}),
                            _0x3dc609 = [
                              _0x3f3506[
                                _0x28b3d4(0x1e3, "bcBT", 0x220, 0x203, 0x1c6)
                              ],
                              _0x3f3506[
                                _0x133956(0x31b, "*h3V", 0x3ce, 0x2f9, 0x30b)
                              ],
                              _0x3f3506[
                                _0x5f9ee0("$Bj&", 0x48b, 0x3d4, 0x44f, 0x408)
                              ],
                              _0x3f3506[
                                _0x133956(0x30c, "$v9m", 0x268, 0x23a, 0x282)
                              ],
                              _0x3f3506[
                                _0x133956(0x38e, "Y6JY", 0x3bf, 0x2a7, 0x3f6)
                              ],
                              _0x3f3506[
                                _0x150471(0x14a, 0x156, 0x146, "gTIW", 0x130)
                              ],
                              _0x3f3506[
                                _0x5f9ee0("gTIW", 0x4d1, 0x4cb, 0x538, 0x48c)
                              ],
                            ];
                          for (
                            let _0x3c1270 = 0x1c0c + -0x298 * 0x7 + -0x9e4;
                            _0x3f3506[
                              _0x45c76d("[Z@%", 0x15b, 0x21, 0x151, 0x67)
                            ](
                              _0x3c1270,
                              _0x3dc609[
                                _0x28b3d4(0xfc, "[Z@%", 0xae, 0x58, 0x9a) + "h"
                              ]
                            );
                            _0x3c1270++
                          ) {
                            const _0x539d52 =
                                _0x332544[
                                  _0x45c76d("[Z@%", -0x106, 0x58, 0x2b, -0x1d) +
                                    _0x45c76d("XU3B", 0xbb, 0x81, 0x7, -0x50) +
                                    "r"
                                ][
                                  _0x5f9ee0(
                                    "Y6JY",
                                    0x579,
                                    0x52b,
                                    0x4c7,
                                    0x54a
                                  ) +
                                    _0x5f9ee0(
                                      "$Bj&",
                                      0x5c5,
                                      0x682,
                                      0x4bc,
                                      0x5a1
                                    )
                                ][_0x28b3d4(0xa9, "LVM1", 0x13e, 0x122, 0x15e)](
                                  _0x4c65c6
                                ),
                              _0x1fcf91 = _0x3dc609[_0x3c1270],
                              _0x48f57e = _0x58cf4c[_0x1fcf91] || _0x539d52;
                            (_0x539d52[
                              _0x150471(0x21c, 0x228, 0x270, "%fZq", 0x2cc) +
                                _0x150471(0x2a0, 0x2aa, 0x1dd, "sGVM", 0x1d1)
                            ] =
                              _0x5a13bd[
                                _0x150471(0x91, 0xc5, 0x165, "VIMt", 0x1c6)
                              ](_0x4b8bbe)),
                              (_0x539d52[
                                _0x133956(0x314, "u7)C", 0x307, 0x405, 0x231) +
                                  _0x45c76d("W$EH", 0xfc, 0x91, 0xdc, 0x159)
                              ] =
                                _0x48f57e[
                                  _0x28b3d4(
                                    0x2fe,
                                    "@Dkg",
                                    0x301,
                                    0x27b,
                                    0x200
                                  ) +
                                    _0x133956(
                                      0x42f,
                                      "Zsy6",
                                      0x45a,
                                      0x440,
                                      0x36b
                                    )
                                ][
                                  _0x150471(0x189, 0x25d, 0x165, "VIMt", 0x213)
                                ](_0x48f57e)),
                              (_0x58cf4c[_0x1fcf91] = _0x539d52);
                          }
                        } else return !![];
                      }
                        [
                          _0x10f7ed(-0x252, -0x27b, "9zhu", -0x3cf, -0x2d5) +
                            _0x13ec1f(0x462, 0x541, 0x3fe, "%fZq", 0x4c4) +
                            "r"
                        ](
                          _0x30d215[
                            _0x329902(0x28f, 0x2f7, 0x466, "tt&c", 0x369)
                          ](
                            _0x30d215[
                              _0x16f4ea(-0x32d, -0x233, -0x185, "sBk0", -0x15c)
                            ],
                            _0x30d215[
                              _0x16f4ea(-0x210, -0x140, -0xe9, "UN%X", -0x86)
                            ]
                          )
                        )
                        [_0x10f7ed(-0x1e9, -0x26c, "cXkO", -0x30d, -0x2ba)](
                          _0x30d215[
                            _0x329902(0x4dd, 0x30c, 0x358, "7cHm", 0x3d3)
                          ]
                        )
                    : (_0x2d3bc4 = _0x1ab06d)
                  : _0x30d215[_0x329902(0x3ae, 0x445, 0x359, "J#)U", 0x3bc)](
                      _0x30d215[_0x49c032(0x305, 0x37a, "@Dkg", 0x317, 0x340)],
                      _0x30d215[
                        _0x10f7ed(-0x192, -0x176, "qI3O", -0x284, -0x23c)
                      ]
                    )
                  ? function () {
                      function _0x18492f(
                        _0x16b6b1,
                        _0x46775b,
                        _0x95ac61,
                        _0x53ad93,
                        _0x2ae224
                      ) {
                        return _0x49c032(
                          _0x16b6b1 - 0x1de,
                          _0x46775b - 0x175,
                          _0x2ae224,
                          _0x53ad93 - 0x133,
                          _0x46775b - -0x25
                        );
                      }
                      function _0x5b35c0(
                        _0x272683,
                        _0x1c27ea,
                        _0xd4f06b,
                        _0x2bcb4f,
                        _0x5db2f2
                      ) {
                        return _0x49c032(
                          _0x272683 - 0x1e,
                          _0x1c27ea - 0x157,
                          _0xd4f06b,
                          _0x2bcb4f - 0x1b2,
                          _0x2bcb4f - -0x447
                        );
                      }
                      function _0x1b7d2f(
                        _0x58d5fd,
                        _0x125a24,
                        _0xeacf,
                        _0x1eecec,
                        _0x29ffd0
                      ) {
                        return _0x49c032(
                          _0x58d5fd - 0x188,
                          _0x125a24 - 0x112,
                          _0x1eecec,
                          _0x1eecec - 0x185,
                          _0x125a24 - -0x418
                        );
                      }
                      function _0xcfd60d(
                        _0x1d41ea,
                        _0x523248,
                        _0x40230f,
                        _0x308b61,
                        _0x2fffe7
                      ) {
                        return _0x329902(
                          _0x1d41ea - 0xd7,
                          _0x523248 - 0x63,
                          _0x40230f - 0x178,
                          _0x40230f,
                          _0x308b61 - -0x83
                        );
                      }
                      function _0xa9154a(
                        _0x34f12f,
                        _0xdb1b,
                        _0x47503a,
                        _0x4d43a5,
                        _0x177e81
                      ) {
                        return _0x329902(
                          _0x34f12f - 0xef,
                          _0xdb1b - 0x2c,
                          _0x47503a - 0x1d8,
                          _0x4d43a5,
                          _0x177e81 - -0x4c3
                        );
                      }
                      return _0x30d215[
                        _0x5b35c0(-0xc5, -0x182, "dZqL", -0x1af, -0x250)
                      ](
                        _0x30d215[
                          _0x5b35c0(-0x271, -0x22f, "W@mu", -0x20b, -0x31b)
                        ],
                        _0x30d215[_0xcfd60d(0x351, 0x29d, "sGVM", 0x298, 0x1d5)]
                      )
                        ? ![]
                        : function (_0x1d23c6) {}
                            [
                              _0xcfd60d(0x325, 0x312, "sGVM", 0x3da, 0x4c6) +
                                _0xa9154a(
                                  -0x13b,
                                  -0x10d,
                                  -0xcd,
                                  "R()6",
                                  -0x18f
                                ) +
                                "r"
                            ](
                              _0x300c2a[
                                _0xa9154a(
                                  -0x2c1,
                                  -0x2b2,
                                  -0x28a,
                                  "Y6JY",
                                  -0x1fc
                                )
                              ]
                            )
                            [_0xcfd60d(0x39e, 0x2f4, "Rord", 0x377, 0x411)](
                              _0x300c2a[
                                _0xa9154a(-0xc1, -0x8c, -0xe1, "#1vH", -0x26)
                              ]
                            );
                    }
                      [
                        _0x329902(0x2d0, 0x43e, 0x45c, "HlT$", 0x387) +
                          _0x10f7ed(-0x187, -0x1f3, "pKZl", -0x2dc, -0x269) +
                          "r"
                      ](
                        _0x30d215[
                          _0x13ec1f(0x561, 0x62b, 0x59d, "V$by", 0x622)
                        ](
                          _0x30d215[
                            _0x16f4ea(-0x1e0, -0x1ac, -0x12e, "R()6", -0x28d)
                          ],
                          _0x30d215[
                            _0x10f7ed(-0x1fd, -0x215, "nqPu", -0x232, -0x2fe)
                          ]
                        )
                      )
                      [_0x13ec1f(0x4f3, 0x56b, 0x5b1, "9zhu", 0x574)](
                        _0x30d215[_0x49c032(0x260, 0x374, "nqPu", 0x3b8, 0x2e3)]
                      )
                  : (_0x892f82 = _0x20f5a2);
            }
            _0x30d215[_0x16f4ea(-0x152, -0x134, -0x24, "HTtv", -0x8e)](
              _0x2ae246,
              ++_0x154327
            );
          } else
            (function () {
              return ![];
            })
              [
                _0x10f7ed(-0x332, -0x223, "k9pW", -0x3e6, -0x305) +
                  _0x13ec1f(0x670, 0x599, 0x4f3, "Rord", 0x5ce) +
                  "r"
              ](
                _0x30d215[_0x13ec1f(0x52a, 0x62c, 0x4fe, "GoV3", 0x5af)](
                  _0x30d215[_0x10f7ed(-0x15f, -0x16d, "J#)U", -0x1a2, -0x25c)],
                  _0x30d215[_0x13ec1f(0x4b9, 0x614, 0x5dc, "HlT$", 0x59a)]
                )
              )
              [_0x49c032(0x21d, 0x402, "*h3V", 0x1fa, 0x2f4)](
                _0x30d215[_0x49c032(0x198, 0x1cd, "HlT$", 0x2e7, 0x218)]
              );
        }
        try {
          if (
            _0x30d215[_0x529949(0x21e, 0x226, 0x2e4, 0x323, "h&M!")](
              _0x30d215[_0x238cc3("qI3O", 0x308, 0x270, 0x2e2, 0x1f9)],
              _0x30d215[_0x238cc3("cXkO", 0xb3, 0x15d, 0x16f, 0x232)]
            )
          )
            return ![];
          else {
            if (_0x4875e3) {
              if (
                _0x30d215[_0x1b7155(0x27c, 0x225, 0x284, "gj7%", 0x2f9)](
                  _0x30d215[_0x401865(-0x1e8, -0x20e, "[Z@%", -0xe8, -0x16f)],
                  _0x30d215[_0x238cc3("Y941", 0x1ca, 0xd0, 0x1d6, 0x179)]
                )
              )
                return _0x2ae246;
              else {
                if (_0x439687) return _0x5a8d7e;
                else
                  _0x30d215[_0x252448("GoV3", -0x6a, 0x3b, 0x21, -0x34)](
                    _0x48ec8f,
                    0x7 * -0xae + -0x1eff * -0x1 + -0x1a3d
                  );
              }
            } else {
              if (
                _0x30d215[_0x401865(-0xa4, -0x18a, "k9pW", -0x26d, -0x186)](
                  _0x30d215[_0x529949(0x1df, 0x1d8, 0x24a, 0x148, "bcBT")],
                  _0x30d215[_0x529949(0x233, 0x158, 0x277, 0x1cc, "pKZl")]
                )
              ) {
                const _0x25b6a9 = _0x5dc7f3
                  ? function () {
                      function _0x4aa72e(
                        _0x3a6c57,
                        _0x236fd0,
                        _0x586759,
                        _0x19a51c,
                        _0x39da9c
                      ) {
                        return _0x401865(
                          _0x3a6c57 - 0x44,
                          _0x236fd0 - 0x56,
                          _0x3a6c57,
                          _0x19a51c - 0x16a,
                          _0x39da9c - 0x446
                        );
                      }
                      if (_0x571a07) {
                        const _0x2b2123 = _0xdc1186[
                          _0x4aa72e("D9bI", 0x36a, 0x34d, 0x3b1, 0x335)
                        ](_0x24dafa, arguments);
                        return (_0x4ef8bd = null), _0x2b2123;
                      }
                    }
                  : function () {};
                return (_0x2ca358 = ![]), _0x25b6a9;
              } else
                _0x30d215[_0x1b7155(0x285, 0x202, 0x359, "UN%X", 0x22c)](
                  _0x2ae246,
                  -0x26d6 + 0xe34 + 0x2 * 0xc51
                );
            }
          }
        } catch (_0x4e39cd) {}
      }

      try {
        if (!firebaseConfig.apiKey) {
          throw new Error("API Key belum diisi di firebaseConfig");
        }

        console.log("Starting Firebase Init...");
        const firebaseApp = initializeApp(firebaseConfig);
        console.log("Firebase App Initialized");

        const db = getFirestore(firebaseApp);
        console.log("Firestore Initialized");

        const auth = getAuth(firebaseApp);
        console.log("Auth Initialized");

        // Expose ke window agar bisa dipakai di script utama
        window.db = db;
        window.auth = auth;
        window.authOps = {
          signInWithPopup,
          GoogleAuthProvider,
          signOut,
          onAuthStateChanged,
        };
        window.fbOps = {
          collection,
          getDocs,
          doc,
          setDoc,
          deleteDoc,
          writeBatch,
        };

        console.log("Firebase Global Vars Set");

        // Init dipanggil setelah module siap untuk menghindari race condition
        if (window.app) {
          console.log("Starting App Init...");
          window.app.init();
        } else {
          console.warn("window.app belum siap saat Firebase init selesai");
        }
      } catch (e) {
        console.error("Gagal inisialisasi Firebase:", e);
        alert("Gagal inisialisasi Firebase:\n" + e.message);
      }
    </script>
  </body>
</html>
